(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[412],{47849:function(e,c,a){"use strict";a.d(c,{w_:function(){return j}});var b=a(60822),d={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},f=b.createContext&&b.createContext(d),g=function(){return(g=Object.assign||function(d){for(var a,b=1,e=arguments.length;b<e;b++)for(var c in a=arguments[b])Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);return d}).apply(this,arguments)},h=function(b,e){var d={};for(var a in b)Object.prototype.hasOwnProperty.call(b,a)&&0>e.indexOf(a)&&(d[a]=b[a]);if(null!=b&&"function"==typeof Object.getOwnPropertySymbols)for(var c=0,a=Object.getOwnPropertySymbols(b);c<a.length;c++)0>e.indexOf(a[c])&&(d[a[c]]=b[a[c]]);return d};function i(a){return a&&a.map(function(a,c){return b.createElement(a.tag,g({key:c},a.attr),i(a.child))})}function j(a){return function(c){return b.createElement(k,g({attr:g({},a.attr)},c),i(a.child))}}function k(c){var a=function(a){var d,e=c.size||a.size||"1em";a.className&&(d=a.className),c.className&&(d=(d?d+" ":"")+c.className);var i=c.attr,f=c.title,j=h(c,["attr","title"]);return b.createElement("svg",g({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},a.attr,i,j,{className:d,style:g({color:c.color||a.color},a.style,c.style),height:e,width:e,xmlns:"http://www.w3.org/2000/svg"}),f&&b.createElement("title",null,f),c.children)};return void 0!==f?b.createElement(f.Consumer,null,function(b){return a(b)}):a(d)}},38668:function(d,c){"use strict";var e={value:function(){}};function a(){for(var a,c=0,e=arguments.length,d={};c<e;++c){if(!(a=arguments[c]+"")||a in d||/[\s.]/.test(a))throw new Error("illegal type: "+a);d[a]=[]}return new b(d)}function b(a){this._=a}function f(b,d){for(var c,a=0,e=b.length;a<e;++a)if((c=b[a]).name===d)return c.value}function g(a,c,d){for(var b=0,f=a.length;b<f;++b)if(a[b].name===c){a[b]=e,a=a.slice(0,b).concat(a.slice(b+1));break}return null!=d&&a.push({name:c,value:d}),a}b.prototype=a.prototype={constructor:b,on:function(c,d){var i,k,a,b=this._,h=(i=c+"",k=b,i.trim().split(/^|\s+/).map(function(a){var c="",b=a.indexOf(".");if(b>=0&&(c=a.slice(b+1),a=a.slice(0,b)),a&&!k.hasOwnProperty(a))throw new Error("unknown type: "+a);return{type:a,name:c}})),e=-1,j=h.length;if(arguments.length<2){for(;++e<j;)if((a=(c=h[e]).type)&&(a=f(b[a],c.name)))return a;return}if(null!=d&&"function"!=typeof d)throw new Error("invalid callback: "+d);for(;++e<j;)if(a=(c=h[e]).type)b[a]=g(b[a],c.name,d);else if(null==d)for(a in b)b[a]=g(b[a],c.name,null);return this},copy:function(){var a={},c=this._;for(var d in c)a[d]=c[d].slice();return new b(a)},call:function(c,f){if((b=arguments.length-2)>0)for(var b,d,e=new Array(b),a=0;a<b;++a)e[a]=arguments[a+2];if(!this._.hasOwnProperty(c))throw new Error("unknown type: "+c);for(d=this._[c],a=0,b=d.length;a<b;++a)d[a].value.apply(f,e)},apply:function(a,d,e){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var c=this._[a],b=0,f=c.length;b<f;++b)c[b].value.apply(d,e)}},c.Z=a},96837:function(c,a,b){"use strict";function d(a){return function(){return this.matches(a)}}b.d(a,{Z:function(){return d}})},23576:function(c,b,a){"use strict";a.d(b,{Z:function(){return e}});var d=a(63949);function e(a){var b=a+="",c=b.indexOf(":");return c>=0&&"xmlns"!==(b=a.slice(0,c))&&(a=a.slice(c+1)),d.Z.hasOwnProperty(b)?{space:d.Z[b],local:a}:a}},63949:function(d,a,b){"use strict";b.d(a,{P:function(){return c}});var c="http://www.w3.org/1999/xhtml";a.Z={svg:"http://www.w3.org/2000/svg",xhtml:c,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"}},82250:function(c,b,a){"use strict";a.d(b,{Z:function(){return e}});var d=a(1059);function e(a){return"string"==typeof a?new d.Y1([[document.querySelector(a)]],[document.documentElement]):new d.Y1([[a]],d.Jz)}},1059:function(i,e,a){"use strict";a.d(e,{Y1:function(){return c},ZP:function(){return aa},Jz:function(){return _}});var j=a(99110),k=a(27265),l=a(96837);function m(a){return new Array(a.length)}function b(a,b){this.ownerDocument=a.ownerDocument,this.namespaceURI=a.namespaceURI,this._next=null,this._parent=a,this.__data__=b}function n(f,d,g,h,i,e){for(var c,a=0,j=d.length,k=e.length;a<k;++a)(c=d[a])?(c.__data__=e[a],h[a]=c):g[a]=new b(f,e[a]);for(;a<j;++a)(c=d[a])&&(i[a]=c)}function o(i,g,m,n,j,d,k){var a,c,e,f={},h=g.length,o=d.length,l=new Array(h);for(a=0;a<h;++a)(c=g[a])&&(l[a]=e="$"+k.call(c,c.__data__,a,g),e in f?j[a]=c:f[e]=c);for(a=0;a<o;++a)(c=f[e="$"+k.call(i,d[a],a,d)])?(n[a]=c,c.__data__=d[a],f[e]=null):m[a]=new b(i,d[a]);for(a=0;a<h;++a)(c=g[a])&&f[l[a]]===c&&(j[a]=c)}function p(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}b.prototype={constructor:b,appendChild:function(a){return this._parent.insertBefore(a,this._next)},insertBefore:function(a,b){return this._parent.insertBefore(a,b)},querySelector:function(a){return this._parent.querySelector(a)},querySelectorAll:function(a){return this._parent.querySelectorAll(a)}};var q=a(23576);function r(a){return function(){this.removeAttribute(a)}}function s(a){return function(){this.removeAttributeNS(a.space,a.local)}}function t(a,b){return function(){this.setAttribute(a,b)}}function u(a,b){return function(){this.setAttributeNS(a.space,a.local,b)}}function v(a,b){return function(){var c=b.apply(this,arguments);null==c?this.removeAttribute(a):this.setAttribute(a,c)}}function w(a,b){return function(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}}var f=a(73831);function x(a){return function(){delete this[a]}}function y(a,b){return function(){this[a]=b}}function z(a,b){return function(){var c=b.apply(this,arguments);null==c?delete this[a]:this[a]=c}}function A(a){return a.trim().split(/^|\s+/)}function B(a){return a.classList||new g(a)}function g(a){this._node=a,this._names=A(a.getAttribute("class")||"")}function C(c,a){for(var d=B(c),b=-1,e=a.length;++b<e;)d.add(a[b])}function D(c,a){for(var d=B(c),b=-1,e=a.length;++b<e;)d.remove(a[b])}function E(a){return function(){C(this,a)}}function F(a){return function(){D(this,a)}}function G(a,b){return function(){(b.apply(this,arguments)?C:D)(this,a)}}function H(){this.textContent=""}function I(a){return function(){this.textContent=a}}function J(a){return function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}}function K(){this.innerHTML=""}function L(a){return function(){this.innerHTML=a}}function M(a){return function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}}function N(){this.nextSibling&&this.parentNode.appendChild(this)}function O(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}g.prototype={add:function(a){0>this._names.indexOf(a)&&(this._names.push(a),this._node.setAttribute("class",this._names.join(" ")))},remove:function(b){var a=this._names.indexOf(b);a>=0&&(this._names.splice(a,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(a){return this._names.indexOf(a)>=0}};var P=a(63949);function Q(a){return function(){var b=this.ownerDocument,c=this.namespaceURI;return c===P.P&&b.documentElement.namespaceURI===P.P?b.createElement(a):b.createElementNS(c,a)}}function R(a){return function(){return this.ownerDocument.createElementNS(a.space,a.local)}}function S(b){var a=(0,q.Z)(b);return(a.local?R:Q)(a)}function T(){return null}function U(){var a=this.parentNode;a&&a.removeChild(this)}function V(){var a=this.cloneNode(!1),b=this.parentNode;return b?b.insertBefore(a,this.nextSibling):a}function W(){var a=this.cloneNode(!0),b=this.parentNode;return b?b.insertBefore(a,this.nextSibling):a}var h=a(82633),X=a(27666);function Y(d,c,b){var e=(0,X.Z)(d),a=e.CustomEvent;"function"==typeof a?a=new a(c,b):(a=e.document.createEvent("Event"),b?(a.initEvent(c,b.bubbles,b.cancelable),a.detail=b.detail):a.initEvent(c,!1,!1)),d.dispatchEvent(a)}function Z(a,b){return function(){return Y(this,a,b)}}function $(a,b){return function(){return Y(this,a,b.apply(this,arguments))}}var _=[null];function c(a,b){this._groups=a,this._parents=b}function d(){return new c([[document.documentElement]],_)}c.prototype=d.prototype={constructor:c,select:function(d){"function"!=typeof d&&(d=(0,j.Z)(d));for(var h=this._groups,i=h.length,k=new Array(i),e=0;e<i;++e)for(var a,f,g=h[e],l=g.length,m=k[e]=new Array(l),b=0;b<l;++b)(a=g[b])&&(f=d.call(a,a.__data__,b,g))&&("__data__"in a&&(f.__data__=a.__data__),m[b]=f);return new c(k,this._parents)},selectAll:function(a){"function"!=typeof a&&(a=(0,k.Z)(a));for(var g=this._groups,j=g.length,h=[],i=[],e=0;e<j;++e)for(var b,f=g[e],l=f.length,d=0;d<l;++d)(b=f[d])&&(h.push(a.call(b,b.__data__,d,f)),i.push(b));return new c(h,i)},filter:function(a){"function"!=typeof a&&(a=(0,l.Z)(a));for(var g=this._groups,h=g.length,i=new Array(h),b=0;b<h;++b)for(var d,f=g[b],j=f.length,k=i[b]=[],e=0;e<j;++e)(d=f[e])&&a.call(d,d.__data__,e,f)&&k.push(d);return new c(i,this._parents)},data:function(b,k){if(!b)return r=new Array(this.size()),a=-1,this.each(function(b){r[++a]=b}),r;var w=k?o:n,j=this._parents,l=this._groups;"function"!=typeof b&&(b=(y=b,function(){return y}));for(var f=l.length,d=new Array(f),m=new Array(f),p=new Array(f),a=0;a<f;++a){var y,g=j[a],q=l[a],x=q.length,r=b.call(g,g&&g.__data__,a,j),h=r.length,s=m[a]=new Array(h),t=d[a]=new Array(h);w(g,q,s,t,p[a]=new Array(x),r,k);for(var u,v,e=0,i=0;e<h;++e)if(u=s[e]){for(e>=i&&(i=e+1);!(v=t[i])&& ++i<h;);u._next=v||null}}return(d=new c(d,j))._enter=m,d._exit=p,d},enter:function(){return new c(this._enter||this._groups.map(m),this._parents)},exit:function(){return new c(this._exit||this._groups.map(m),this._parents)},join:function(c,d,e){var a=this.enter(),b=this,f=this.exit();return a="function"==typeof c?c(a):a.append(c+""),null!=d&&(b=d(b)),null==e?f.remove():e(f),a&&b?a.merge(b).order():b},merge:function(k){for(var d=this._groups,g=k._groups,e=d.length,l=g.length,m=Math.min(e,l),f=new Array(e),a=0;a<m;++a)for(var h,i=d[a],n=g[a],j=i.length,o=f[a]=new Array(j),b=0;b<j;++b)(h=i[b]||n[b])&&(o[b]=h);for(;a<e;++a)f[a]=d[a];return new c(f,this._parents)},order:function(){for(var e=this._groups,f=-1,g=e.length;++f<g;)for(var b,c=e[f],d=c.length-1,a=c[d];--d>=0;)(b=c[d])&&(a&&4^b.compareDocumentPosition(a)&&a.parentNode.insertBefore(b,a),a=b);return this},sort:function(d){function l(a,b){return a&&b?d(a.__data__,b.__data__):!a- !b}d||(d=p);for(var e=this._groups,f=e.length,g=new Array(f),a=0;a<f;++a){for(var h,i=e[a],j=i.length,k=g[a]=new Array(j),b=0;b<j;++b)(h=i[b])&&(k[b]=h);k.sort(l)}return new c(g,this._parents).order()},call:function(){var a=arguments[0];return arguments[0]=this,a.apply(null,arguments),this},nodes:function(){var a=new Array(this.size()),b=-1;return this.each(function(){a[++b]=this}),a},node:function(){for(var c=this._groups,a=0,f=c.length;a<f;++a)for(var d=c[a],b=0,g=d.length;b<g;++b){var e=d[b];if(e)return e}return null},size:function(){var a=0;return this.each(function(){++a}),a},empty:function(){return!this.node()},each:function(f){for(var e=this._groups,b=0,g=e.length;b<g;++b)for(var c,d=e[b],a=0,h=d.length;a<h;++a)(c=d[a])&&f.call(c,c.__data__,a,d);return this},attr:function(d,b){var a=(0,q.Z)(d);if(arguments.length<2){var c=this.node();return a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}return this.each((null==b?a.local?s:r:"function"==typeof b?a.local?w:v:a.local?u:t)(a,b))},style:f.Z,property:function(b,a){return arguments.length>1?this.each((null==a?x:"function"==typeof a?z:y)(b,a)):this.node()[b]},classed:function(d,a){var b=A(d+"");if(arguments.length<2){for(var e=B(this.node()),c=-1,f=b.length;++c<f;)if(!e.contains(b[c]))return!1;return!0}return this.each(("function"==typeof a?G:a?E:F)(b,a))},text:function(a){return arguments.length?this.each(null==a?H:("function"==typeof a?J:I)(a)):this.node().textContent},html:function(a){return arguments.length?this.each(null==a?K:("function"==typeof a?M:L)(a)):this.node().innerHTML},raise:function(){return this.each(N)},lower:function(){return this.each(O)},append:function(a){var b="function"==typeof a?a:S(a);return this.select(function(){return this.appendChild(b.apply(this,arguments))})},insert:function(b,a){var c="function"==typeof b?b:S(b),d=null==a?T:"function"==typeof a?a:(0,j.Z)(a);return this.select(function(){return this.insertBefore(c.apply(this,arguments),d.apply(this,arguments)||null)})},remove:function(){return this.each(U)},clone:function(a){return this.select(a?W:V)},datum:function(a){return arguments.length?this.property("__data__",a):this.node().__data__},on:h.ZP,dispatch:function(b,a){return this.each(("function"==typeof a?$:Z)(b,a))}};var aa=d},82633:function(d,a,b){"use strict";b.d(a,{B:function(){return e},ZP:function(){return j},"_H":function(){return k}});var c={},e=null;function f(a,b,c){return a=g(a,b,c),function(c){var b=c.relatedTarget;b&&(b===this||8&b.compareDocumentPosition(this))||a.call(this,c)}}function g(a,b,c){return function(d){var f=e;e=d;try{a.call(this,this.__data__,b,c)}finally{e=f}}}function h(a){return function(){var c=this.__on;if(c){for(var b,d=0,e=-1,f=c.length;d<f;++d)(b=c[d],a.type&&b.type!==a.type||b.name!==a.name)?c[++e]=b:this.removeEventListener(b.type,b.listener,b.capture);++e?c.length=e:delete this.__on}}}function i(a,b,d){var e=c.hasOwnProperty(a.type)?f:g;return function(l,i,j){var c,f=this.__on,g=e(b,i,j);if(f){for(var h=0,k=f.length;h<k;++h)if((c=f[h]).type===a.type&&c.name===a.name){this.removeEventListener(c.type,c.listener,c.capture),this.addEventListener(c.type,c.listener=g,c.capture=d),c.value=b;return}}this.addEventListener(a.type,g,d),c={type:a.type,name:a.name,value:b,listener:g,capture:d},f?f.push(c):this.__on=[c]}}function j(l,g,d){var n,a,j,e=(l+"").trim().split(/^|\s+/).map(function(a){var c="",b=a.indexOf(".");return b>=0&&(c=a.slice(b+1),a=a.slice(0,b)),{type:a,name:c}}),k=e.length;if(arguments.length<2){var b=this.node().__on;if(b){for(var c,f=0,m=b.length;f<m;++f)for(a=0,c=b[f];a<k;++a)if((j=e[a]).type===c.type&&j.name===c.name)return c.value}return}for(b=g?i:h,null==d&&(d=!1),a=0;a<k;++a)this.each(b(e[a],g,d));return this}function k(a,b,c,d){var f=e;a.sourceEvent=e,e=a;try{return b.apply(c,d)}finally{e=f}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(c={mouseenter:"mouseover",mouseleave:"mouseout"}))},73831:function(c,b,a){"use strict";a.d(b,{S:function(){return i},Z:function(){return h}});var d=a(27666);function e(a){return function(){this.style.removeProperty(a)}}function f(a,b,c){return function(){this.style.setProperty(a,b,c)}}function g(a,b,c){return function(){var d=b.apply(this,arguments);null==d?this.style.removeProperty(a):this.style.setProperty(a,d,c)}}function h(b,a,c){return arguments.length>1?this.each((null==a?e:"function"==typeof a?g:f)(b,a,null==c?"":c)):i(this.node(),b)}function i(a,b){return a.style.getPropertyValue(b)||(0,d.Z)(a).getComputedStyle(a,null).getPropertyValue(b)}},99110:function(c,a,b){"use strict";function d(){}function e(a){return null==a?d:function(){return this.querySelector(a)}}b.d(a,{Z:function(){return e}})},27265:function(c,a,b){"use strict";function d(){return[]}function e(a){return null==a?d:function(){return this.querySelectorAll(a)}}b.d(a,{Z:function(){return e}})},27666:function(c,a,b){"use strict";function d(a){return a.ownerDocument&&a.ownerDocument.defaultView||a.document&&a||a.defaultView}b.d(a,{Z:function(){return d}})},38658:function(e,b,c){"use strict";c.d(b,{B7:function(){return a},HT:function(){return d},R8:function(){return r},zO:function(){return p}});var f,g,h=0,i=0,j=0,k=0,l=0,m=0,n="object"==typeof performance&&performance.now?performance:Date,o="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(a){setTimeout(a,17)};function p(){return l||(o(q),l=n.now()+m)}function q(){l=0}function a(){this._call=this._time=this._next=null}function d(c,d,e){var b=new a;return b.restart(c,d,e),b}function r(){p(),++h;for(var b,a=f;a;)(b=l-a._time)>=0&&a._call.call(null,b),a=a._next;--h}function s(){l=(k=n.now())+m,h=i=0;try{r()}finally{h=0,u(),l=0}}function t(){var a=n.now(),b=a-k;b>1e3&&(m-=b,k=a)}function u(){for(var b,c,a=f,d=1/0;a;)a._call?(d>a._time&&(d=a._time),b=a,a=a._next):(c=a._next,a._next=null,a=b?b._next=c:f=c);g=b,v(d)}function v(a){!h&&(i&&(i=clearTimeout(i)),a-l>24?(a<1/0&&(i=setTimeout(s,a-n.now()-m)),j&&(j=clearInterval(j))):(j||(k=n.now(),j=setInterval(t,1e3)),h=1,o(s)))}a.prototype=d.prototype={constructor:a,restart:function(b,c,a){if("function"!=typeof b)throw new TypeError("callback is not a function");a=(null==a?p():+a)+(null==c?0:+c),this._next||g===this||(g?g._next=this:f=this,g=this),this._call=b,this._time=a,v()},stop:function(){this._call&&(this._call=null,this._time=1/0,v())}}},8594:function(i,f,a){"use strict";a.d(f,{e1:function(){return w},eR:function(){return h}});var j,k,l,m,c=a(1059),g=a(38668),n=a(38658);function o(d,a,c){var b=new n.B7;return a=null==a?0:+a,b.restart(function(c){b.stop(),d(c+a)},a,c),b}var p=(0,g.Z)("start","end","cancel","interrupt"),q=[];function r(b,e,c,f,g,a){var d=b.__transition;if(d){if(c in d)return}else b.__transition={};v(b,c,{name:e,index:f,group:g,on:p,tween:q,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function s(b,c){var a=u(b,c);if(a.state>0)throw new Error("too late; already scheduled");return a}function t(b,c){var a=u(b,c);if(a.state>3)throw new Error("too late; already running");return a}function u(b,c){var a=b.__transition;if(!a||!(a=a[c]))throw new Error("transition not found");return a}function v(b,c,a){var e,d=b.__transition;function f(m){var j,k,l,i;if(1!==a.state)return h();for(j in d)if((i=d[j]).name===a.name){if(3===i.state)return o(f);4===i.state?(i.state=6,i.timer.stop(),i.on.call("interrupt",b,b.__data__,i.index,i.group),delete d[j]):+j<c&&(i.state=6,i.timer.stop(),i.on.call("cancel",b,b.__data__,i.index,i.group),delete d[j])}if(o(function(){3===a.state&&(a.state=4,a.timer.restart(g,a.delay,a.time),g(m))}),a.state=2,a.on.call("start",b,b.__data__,a.index,a.group),2===a.state){for(j=0,a.state=3,e=new Array(l=a.tween.length),k=-1;j<l;++j)(i=a.tween[j].value.call(b,b.__data__,a.index,a.group))&&(e[++k]=i);e.length=k+1}}function g(c){for(var f=c<a.duration?a.ease.call(null,c/a.duration):(a.timer.restart(h),a.state=5,1),d=-1,g=e.length;++d<g;)e[d].call(b,f);5===a.state&&(a.on.call("end",b,b.__data__,a.index,a.group),h())}function h(){for(var e in a.state=6,a.timer.stop(),delete d[c],d)return;delete b.__transition}d[c]=a,a.timer=(0,n.HT)(function(b){a.state=1,a.timer.restart(f,a.delay,a.time),a.delay<=b&&f(b-a.delay)},0,a.time)}function w(b,c){var a,f,e,d=b.__transition,g=!0;if(d){for(e in c=null==c?null:c+"",d){if((a=d[e]).name!==c){g=!1;continue}f=a.state>2&&a.state<5,a.state=6,a.timer.stop(),a.on.call(f?"interrupt":"cancel",b,b.__data__,a.index,a.group),delete d[e]}g&&delete b.__transition}}var x=a(36263),y=180/Math.PI,z={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function A(a,b,d,e,h,i){var f,g,c;return(f=Math.sqrt(a*a+b*b))&&(a/=f,b/=f),(c=a*d+b*e)&&(d-=a*c,e-=b*c),(g=Math.sqrt(d*d+e*e))&&(d/=g,e/=g,c/=g),a*e<b*d&&(a=-a,b=-b,c=-c,f=-f),{translateX:h,translateY:i,rotate:Math.atan2(b,a)*y,skewX:Math.atan(c)*y,scaleX:f,scaleY:g}}function d(a,b,c,d){function e(a){return a.length?a.pop()+" ":""}return function(f,g){var i,h,j,p,o,k,l,q,m=[],n=[];return f=a(f),g=a(g),!function(e,f,a,d,g,i){if(e!==a||f!==d){var h=g.push("translate(",null,b,null,c);i.push({i:h-4,x:(0,x.Z)(e,a)},{i:h-2,x:(0,x.Z)(f,d)})}else(a||d)&&g.push("translate("+a+b+d+c)}(f.translateX,f.translateY,g.translateX,g.translateY,m,n),i=f.rotate,h=g.rotate,j=m,p=n,i!==h?(i-h>180?h+=360:h-i>180&&(i+=360),p.push({i:j.push(e(j)+"rotate(",null,d)-2,x:(0,x.Z)(i,h)})):h&&j.push(e(j)+"rotate("+h+d),o=f.skewX,k=g.skewX,l=m,q=n,o!==k?q.push({i:l.push(e(l)+"skewX(",null,d)-2,x:(0,x.Z)(o,k)}):k&&l.push(e(l)+"skewX("+k+d),!function(d,f,a,b,c,h){if(d!==a||f!==b){var g=c.push(e(c)+"scale(",null,",",null,")");h.push({i:g-4,x:(0,x.Z)(d,a)},{i:g-2,x:(0,x.Z)(f,b)})}else(1!==a||1!==b)&&c.push(e(c)+"scale("+a+","+b+")")}(f.scaleX,f.scaleY,g.scaleX,g.scaleY,m,n),f=g=null,function(c){for(var a,b=-1,d=n.length;++b<d;)m[(a=n[b]).i]=a.x(c);return m.join("")}}}var B=d(function(a){return"none"===a?z:(j||(j=document.createElement("DIV"),k=document.documentElement,l=document.defaultView),j.style.transform=a,a=l.getComputedStyle(k.appendChild(j),null).getPropertyValue("transform"),k.removeChild(j),a=a.slice(7,-1).split(","),A(+a[0],+a[1],+a[2],+a[3],+a[4],+a[5]))},"px, ","px)","deg)"),C=d(function(a){return null==a?z:(m||(m=document.createElementNS("http://www.w3.org/2000/svg","g")),m.setAttribute("transform",a),a=m.transform.baseVal.consolidate())?A((a=a.matrix).a,a.b,a.c,a.d,a.e,a.f):z},", ",")",")"),D=a(23576);function E(a,b){var c,d;return function(){var f=t(this,a),g=f.tween;if(g!==c){d=c=g;for(var e=0,h=d.length;e<h;++e)if(d[e].name===b){(d=d.slice()).splice(e,1);break}}f.tween=d}}function F(b,c,a){var d,e;if("function"!=typeof a)throw new Error;return function(){var g=t(this,b),h=g.tween;if(h!==d){e=(d=h).slice();for(var i={name:c,value:a},f=0,j=e.length;f<j;++f)if(e[f].name===c){e[f]=i;break}f===j&&e.push(i)}g.tween=e}}function G(a,b,c){var d=a._id;return a.each(function(){var a=t(this,d);(a.value||(a.value={}))[b]=c.apply(this,arguments)}),function(a){return u(a,d).value[b]}}var H=a(56535),I=a(3251),J=a(26969);function K(c,a){var b;return("number"==typeof a?x.Z:a instanceof H.ZP?I.ZP:(b=(0,H.ZP)(a))?(a=b,I.ZP):J.Z)(c,a)}function L(a){return function(){this.removeAttribute(a)}}function M(a){return function(){this.removeAttributeNS(a.space,a.local)}}function N(b,c,a){var d,e,f=a+"";return function(){var g=this.getAttribute(b);return g===f?null:g===d?e:e=c(d=g,a)}}function O(b,c,a){var d,e,f=a+"";return function(){var g=this.getAttributeNS(b.space,b.local);return g===f?null:g===d?e:e=c(d=g,a)}}function P(a,b,c){var d,e,f;return function(){var g,h,i=c(this);return null==i?void this.removeAttribute(a):(g=this.getAttribute(a))===(h=i+"")?null:g===d&&h===e?f:(e=h,f=b(d=g,i))}}function Q(a,b,c){var d,e,f;return function(){var g,h,i=c(this);return null==i?void this.removeAttributeNS(a.space,a.local):(g=this.getAttributeNS(a.space,a.local))===(h=i+"")?null:g===d&&h===e?f:(e=h,f=b(d=g,i))}}function R(c,b){var d,e;function a(){var f,g,a=b.apply(this,arguments);return a!==e&&(d=(e=a)&&(f=c,g=a,function(a){this.setAttributeNS(f.space,f.local,g.call(this,a))})),d}return a._value=b,a}function S(c,b){var d,e;function a(){var f,g,a=b.apply(this,arguments);return a!==e&&(d=(e=a)&&(f=c,g=a,function(a){this.setAttribute(f,g.call(this,a))})),d}return a._value=b,a}function T(a,b){return function(){s(this,a).delay=+b.apply(this,arguments)}}function U(b,a){return a=+a,function(){s(this,b).delay=a}}function V(a,b){return function(){t(this,a).duration=+b.apply(this,arguments)}}function W(b,a){return a=+a,function(){t(this,b).duration=a}}var X=a(96837),Y=a(99110),Z=a(27265),$=c.ZP.prototype.constructor,_=a(73831);function aa(a){return function(){this.style.removeProperty(a)}}var ab=0;function e(a,b,c,d){this._groups=a,this._parents=b,this._name=c,this._id=d}function h(a){return(0,c.ZP)().transition(a)}var b=c.ZP.prototype;e.prototype=h.prototype={constructor:e,select:function(c){var j=this._name,f=this._id;"function"!=typeof c&&(c=(0,Y.Z)(c));for(var k=this._groups,l=k.length,m=new Array(l),d=0;d<l;++d)for(var b,g,h=k[d],n=h.length,i=m[d]=new Array(n),a=0;a<n;++a)(b=h[a])&&(g=c.call(b,b.__data__,a,h))&&("__data__"in b&&(g.__data__=b.__data__),i[a]=g,r(i[a],j,f,a,i,u(b,f)));return new e(m,this._parents,j,f)},selectAll:function(b){var j=this._name,g=this._id;"function"!=typeof b&&(b=(0,Z.Z)(b));for(var k=this._groups,o=k.length,l=[],m=[],h=0;h<o;++h)for(var a,i=k[h],p=i.length,c=0;c<p;++c)if(a=i[c]){for(var n,d=b.call(a,a.__data__,c,i),q=u(a,g),f=0,s=d.length;f<s;++f)(n=d[f])&&r(n,j,g,f,d,q);l.push(d),m.push(a)}return new e(l,m,j,g)},filter:function(a){"function"!=typeof a&&(a=(0,X.Z)(a));for(var g=this._groups,h=g.length,i=new Array(h),b=0;b<h;++b)for(var c,f=g[b],j=f.length,k=i[b]=[],d=0;d<j;++d)(c=f[d])&&a.call(c,c.__data__,d,f)&&k.push(c);return new e(i,this._parents,this._name,this._id)},merge:function(g){if(g._id!==this._id)throw new Error;for(var c=this._groups,h=g._groups,d=c.length,l=h.length,m=Math.min(d,l),f=new Array(d),a=0;a<m;++a)for(var i,j=c[a],n=h[a],k=j.length,o=f[a]=new Array(k),b=0;b<k;++b)(i=j[b]||n[b])&&(o[b]=i);for(;a<d;++a)f[a]=c[a];return new e(f,this._parents,this._name,this._id)},selection:function(){return new $(this._groups,this._parents)},transition:function(){for(var h=this._name,j=this._id,i=++ab,c=this._groups,k=c.length,d=0;d<k;++d)for(var f,g=c[d],l=g.length,b=0;b<l;++b)if(f=g[b]){var a=u(f,j);r(f,h,i,b,g,{time:a.time+a.delay+a.duration,delay:0,duration:a.duration,ease:a.ease})}return new e(c,this._parents,h,i)},call:b.call,nodes:b.nodes,node:b.node,size:b.size,empty:b.empty,each:b.each,on:function(a,d){var e,b,f,h,i,j,g,c=this._id;return arguments.length<2?u(this.node(),c).on.on(a):this.each((e=c,b=a,f=d,g=(b+"").trim().split(/^|\s+/).every(function(a){var b=a.indexOf(".");return b>=0&&(a=a.slice(0,b)),!a||"start"===a})?s:t,function(){var a=g(this,e),c=a.on;c!==i&&(j=(i=c).copy()).on(b,f),a.on=j}))},attr:function(c,b){var a=(0,D.Z)(c),d="transform"===a?C:K;return this.attrTween(c,"function"==typeof b?(a.local?Q:P)(a,d,G(this,"attr."+c,b)):null==b?(a.local?M:L)(a):(a.local?O:N)(a,d,b))},attrTween:function(c,b){var a="attr."+c;if(arguments.length<2)return(a=this.tween(a))&&a._value;if(null==b)return this.tween(a,null);if("function"!=typeof b)throw new Error;var d=(0,D.Z)(c);return this.tween(a,(d.local?R:S)(d,b))},style:function(a,b,d){var e,f,r,s,u,g,h,i,v,w,x,j,k,y,z,A,C,l,m,n,o,p,D,E,q,c="transform"==(a+="")?B:K;return null==b?this.styleTween(a,(e=a,f=c,function(){var a=(0,_.S)(this,e),b=(this.style.removeProperty(e),(0,_.S)(this,e));return a===b?null:a===r&&b===s?u:u=f(r=a,s=b)})).on("end.style."+a,aa(a)):"function"==typeof b?this.styleTween(a,(g=a,h=c,i=G(this,"style."+a,b),function(){var c=(0,_.S)(this,g),a=i(this),b=a+"";return null==a&&(b=a=(this.style.removeProperty(g),(0,_.S)(this,g))),c===b?null:c===v&&b===w?x:(w=b,x=h(v=c,a))})).each((j=this._id,m="end."+(l="style."+(k=a)),function(){var a=t(this,j),b=a.on,c=null==a.value[l]?C||(C=aa(k)):void 0;(b!==y||A!==c)&&(z=(y=b).copy()).on(m,A=c),a.on=z})):this.styleTween(a,(n=a,o=c,q=(p=b)+"",function(){var a=(0,_.S)(this,n);return a===q?null:a===D?E:E=o(D=a,p)}),d).on("end.style."+a,null)},styleTween:function(c,b,d){var a="style."+(c+="");if(arguments.length<2)return(a=this.tween(a))&&a._value;if(null==b)return this.tween(a,null);if("function"!=typeof b)throw new Error;return this.tween(a,function(c,b,d){var e,f;function a(){var g,h,i,a=b.apply(this,arguments);return a!==f&&(e=(f=a)&&(g=c,h=a,i=d,function(a){this.style.setProperty(g,h.call(this,a),i)})),e}return a._value=b,a}(c,b,null==d?"":d))},text:function(a){var b,c;return this.tween("text","function"==typeof a?(b=G(this,"text",a),function(){var a=b(this);this.textContent=null==a?"":a}):(c=null==a?"":a+"",function(){this.textContent=c}))},textTween:function(b){var a="text";if(arguments.length<1)return(a=this.tween(a))&&a._value;if(null==b)return this.tween(a,null);if("function"!=typeof b)throw new Error;return this.tween(a,function(b){var c,d;function a(){var e,a=b.apply(this,arguments);return a!==d&&(c=(d=a)&&(e=a,function(a){this.textContent=e.call(this,a)})),c}return a._value=b,a}(b))},remove:function(){var a;return this.on("end.remove",(a=this._id,function(){var b=this.parentNode;for(var c in this.__transition)if(+c!==a)return;b&&b.removeChild(this)}))},tween:function(a,c){var d=this._id;if(a+="",arguments.length<2){for(var e,f=u(this.node(),d).tween,b=0,g=f.length;b<g;++b)if((e=f[b]).name===a)return e.value;return null}return this.each((null==c?E:F)(d,a,c))},delay:function(a){var b=this._id;return arguments.length?this.each(("function"==typeof a?T:U)(b,a)):u(this.node(),b).delay},duration:function(a){var b=this._id;return arguments.length?this.each(("function"==typeof a?V:W)(b,a)):u(this.node(),b).duration},ease:function(b){var a=this._id;return arguments.length?this.each(function(b,a){if("function"!=typeof a)throw new Error;return function(){t(this,b).ease=a}}(a,b)):u(this.node(),a).ease},end:function(){var b,c,a=this,d=a._id,e=a.size();return new Promise(function(g,f){var h={value:f},i={value:function(){0== --e&&g()}};a.each(function(){var a=t(this,d),e=a.on;e!==b&&((c=(b=e).copy())._.cancel.push(h),c._.interrupt.push(h),c._.end.push(i)),a.on=c})})}};var ac={time:null,delay:0,duration:250,ease:function(a){return((a*=2)<=1?a*a*a:(a-=2)*a*a+2)/2}};function ad(b,c){for(var a;!(a=b.__transition)||!(a=a[c]);)if(!(b=b.parentNode))return ac.time=(0,n.zO)(),ac;return a}c.ZP.prototype.interrupt=function(a){return this.each(function(){w(this,a)})},c.ZP.prototype.transition=function(a){var b,i;a instanceof e?(b=a._id,a=a._name):(b=++ab,(i=ac).time=(0,n.zO)(),a=null==a?null:a+"");for(var d=this._groups,j=d.length,f=0;f<j;++f)for(var g,h=d[f],k=h.length,c=0;c<k;++c)(g=h[c])&&r(g,a,b,c,h,i||ad(g,b));return new e(d,this._parents,a,b)}},1650:function(a,b,c){var d;!function(f,h,i){if(f){for(var j,g={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},k={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},l={"~":"`","!":"1","@":"2","#":"3","$":"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0","_":"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},m={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},e=1;e<20;++e)g[111+e]="f"+e;for(e=0;e<=9;++e)g[e+96]=e.toString();s.prototype.bind=function(a,b,c){return a=a instanceof Array?a:[a],this._bindMultiple.call(this,a,b,c),this},s.prototype.unbind=function(a,b){return this.bind.call(this,a,function(){},b)},s.prototype.trigger=function(a,b){return this._directMap[a+":"+b]&&this._directMap[a+":"+b]({},a),this},s.prototype.reset=function(){var a=this;return a._callbacks={},a._directMap={},a},s.prototype.stopCallback=function(b,a){if((" "+a.className+" ").indexOf(" mousetrap ")> -1)return!1;if(r(a,this.target))return!1;if("composedPath"in b&&"function"==typeof b.composedPath){var c=b.composedPath()[0];c!==b.target&&(a=c)}return"INPUT"==a.tagName||"SELECT"==a.tagName||"TEXTAREA"==a.tagName||a.isContentEditable},s.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},s.addKeycodes=function(a){for(var b in a)a.hasOwnProperty(b)&&(g[b]=a[b]);j=null},s.init=function(){var b=s(h);for(var a in b)"_"!==a.charAt(0)&&(s[a]=function(a){return function(){return b[a].apply(b,arguments)}}(a))},s.init(),f.Mousetrap=s,a.exports&&(a.exports=s),void 0!==(d=(function(){return s}).call(b,c,b,a))&&(a.exports=d)}function n(a,b,c){if(a.addEventListener){a.addEventListener(b,c,!1);return}a.attachEvent("on"+b,c)}function o(a){if("keypress"==a.type){var b=String.fromCharCode(a.which);return a.shiftKey||(b=b.toLowerCase()),b}return g[a.which]?g[a.which]:k[a.which]?k[a.which]:String.fromCharCode(a.which).toLowerCase()}function p(a,b){return a.sort().join(",")===b.sort().join(",")}function q(o,b){var d,k,n,c,h,a,e,i,f=[];for(e=0,h="+"===(i=o)?["+"]:(i=i.replace(/\+{2}/g,"+plus")).split("+");e<h.length;++e)m[a=h[e]]&&(a=m[a]),b&&"keypress"!=b&&l[a]&&(a=l[a],f.push("shift")),("shift"==(d=a)||"ctrl"==d||"alt"==d||"meta"==d)&&f.push(a);return b=(k=a,n=f,(c=b)||(c=function(){if(!j)for(var a in j={},g)a>95&&a<112||g.hasOwnProperty(a)&&(j[g[a]]=a);return j}()[k]?"keydown":"keypress"),"keypress"==c&&n.length&&(c="keydown"),c),{key:a,modifiers:f,action:b}}function r(a,b){return null!==a&&a!==h&&(a===b||r(a.parentNode,b))}function s(a){var d,b=this;if(a=a||h,!(b instanceof s))return new s(a);b.target=a,b._callbacks={},b._directMap={};var e={},f=!1,g=!1,i=!1;function j(a){a=a||{};var b,c=!1;for(b in e){if(a[b]){c=!0;continue}e[b]=0}c||(i=!1)}function k(c,j,h,f,l,m){var g,d,a,k=[],i=h.type;if(!b._callbacks[c])return[];for("keyup"==i&&("shift"==(g=c)||"ctrl"==g||"alt"==g||"meta"==g)&&(j=[c]),d=0;d<b._callbacks[c].length;++d)if(a=b._callbacks[c][d],(f||!a.seq||e[a.seq]==a.level)&&i==a.action&&("keypress"==i&&!h.metaKey&&!h.ctrlKey||p(j,a.modifiers))){var n=!f&&a.combo==l,o=f&&a.seq==f&&a.level==m;(n||o)&&b._callbacks[c].splice(d,1),k.push(a)}return k}function l(d,a,c,e){b.stopCallback(a,a.target||a.srcElement,c,e)|| !1===d(a,c)&&(!function(a){if(a.preventDefault){a.preventDefault();return}a.returnValue=!1}(a),function(a){if(a.stopPropagation){a.stopPropagation();return}a.cancelBubble=!0}(a))}function c(a){"number"!=typeof a.which&&(a.which=a.keyCode);var d,c,e=o(a);if(e){if("keyup"==a.type&&f===e){f=!1;return}b.handleKey(e,(c=[],(d=a).shiftKey&&c.push("shift"),d.altKey&&c.push("alt"),d.ctrlKey&&c.push("ctrl"),d.metaKey&&c.push("meta"),c),a)}}function m(c,g,h,n,p){b._directMap[c+":"+h]=g;var a,r=(c=c.replace(/\s+/g," ")).split(" ");if(r.length>1){!function(c,b,p,g){function h(a){return function(){i=a,++e[c],clearTimeout(d),d=setTimeout(j,1e3)}}function k(a){l(p,a,c),"keyup"!==g&&(f=o(a)),setTimeout(j,10)}e[c]=0;for(var a=0;a<b.length;++a){var n=a+1===b.length?k:h(g||q(b[a+1]).action);m(b[a],n,g,c,a)}}(c,r,g,h);return}a=q(c,h),b._callbacks[a.key]=b._callbacks[a.key]||[],k(a.key,a.modifiers,{type:a.action},n,c,p),b._callbacks[a.key][n?"unshift":"push"]({callback:g,modifiers:a.modifiers,action:a.action,seq:n,level:p,combo:c})}b._handleKey=function(h,n,c){var a,b=k(h,n,c),m={},e=0,f=!1;for(a=0;a<b.length;++a)b[a].seq&&(e=Math.max(e,b[a].level));for(a=0;a<b.length;++a){if(b[a].seq){if(b[a].level!=e)continue;f=!0,m[b[a].seq]=1,l(b[a].callback,c,b[a].combo,b[a].seq);continue}f||l(b[a].callback,c,b[a].combo)}var d,o="keypress"==c.type&&g;c.type!=i||"shift"==(d=h)||"ctrl"==d||"alt"==d||"meta"==d||o||j(m),g=f&&"keydown"==c.type},b._bindMultiple=function(b,c,d){for(var a=0;a<b.length;++a)m(b[a],c,d)},n(a,"keypress",c),n(a,"keydown",c),n(a,"keyup",c)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},68554:function(c,b,a){"use strict";a.d(b,{Y:function(){return h}});var d=a(28354);a(60822);var e=a(46641),f=a(54735),g=a(6290),h=function(b){var a=b.title,c=b.tooltip,h=void 0===c?void 0:c,i=(0,e.v9)(function(a){return a.general.mobileDisplay});return(0,d.jsxs)(g.TO,{children:[(0,d.jsx)(g.Gh,{children:a}),h&&!i&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.Zw,{"data-tip":!0,"data-for":a,onClick:function(a){return a.stopPropagation()},children:(0,d.jsx)(f.DAO,{})}),(0,d.jsx)(g.mi,{place:"bottom",type:"dark",effect:"solid",id:a,children:h})]})]})}},79462:function(l,c,a){"use strict";var b,m,n=a(28354),d=a(60822),e=a(46641),f=a(31884),o=a(5859),p=a(6290),q=a(69856),r=a(73221),s=a(65898);function t(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function u(a){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function v(a,b){return(v=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}var g="undefined"!=typeof Reflect&&"function"==typeof Reflect.metadata&&Reflect.metadata("design:paramtypes",[void 0]),h="undefined"!=typeof Reflect&&"function"==typeof Reflect.metadata&&Reflect.metadata("design:type",Function),i=(0,e.$j)(function(a){var b;return{selected:a.controls.selectedBranchLabel,showAll:a.controls.showAllBranchLabels,available:Array.from(new Set(a.tree.availableBranchLabels).union(new Set(null!==(m=null===(b=a.treeToo)|| void 0===b?void 0:b.availableBranchLabels)&& void 0!==m?m:[]))),canRenderBranchLabels:a.controls.canRenderBranchLabels}}),j=b=i(b=h(b=g((b=function(e){"use strict";!function(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&v(b,a)}(d,e);var f,g,a,b,c,h=(f=d,g=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var b,d,a,c,e=u(f);if(g){var h=u(this).constructor;c=Reflect.construct(e,arguments,h)}else c=e.apply(this,arguments);return d=this,(a=c)&&("object"==((b=a)&&"undefined"!=typeof Symbol&&b.constructor===Symbol?"symbol":typeof b)||"function"==typeof a)?a:function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(d)});function d(b){var a;return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,d),(a=h.call(this,b)).change=function(b){a.props.dispatch({type:o.Ct,value:b.value})},a}return a=d,b=[{key:"render",value:function(){var c=this;if(!this.props.canRenderBranchLabels)return null;var a=this.props.t,b=this.props.available.map(function(a){return{value:a,label:a}});return(0,n.jsxs)("div",{style:{paddingTop:5},children:[(0,n.jsx)(p.om,{children:a("sidebar:Branch Labels")}),(0,n.jsx)("div",{style:{width:q.HB,fontSize:14},children:(0,n.jsx)(r.Z,{value:b.filter(function(a){return a.value===c.props.selected}),options:b,isClearable:!1,isSearchable:!1,isMulti:!1,onChange:this.change})}),"none"!==this.props.selected&&(0,n.jsx)(s.Z,{display:!0,on:this.props.showAll,callback:function(){return c.props.dispatch({type:o.sJ,value:!c.props.showAll})},label:a("sidebar:Show all labels"),style:{paddingBottom:"5px",paddingTop:"10px"}})]})}}],t(a.prototype,b),c&&t(a,c),d}(d.Component))||b)||b)||b)||b,k=(0,f.Zh)()(j);c.Z=k},93227:function(r,f,a){"use strict";a.d(f,{Z:function(){return P}});var d,c,s=a(28354),g=a(60822),h=a(69515),e=a.n(h),i=a(46641),b=a(37536),j=a(31884),k=a(69856),t=a(15080),u=a(6290),v=a(5859);function w(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function x(d){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{},b=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(b=b.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),b.forEach(function(a){w(d,a,c[a])})}return d}var y=function(a){var b=a.layout,c=a.showBranches,d=a.showRegression,e=a.x,f=a.xLabel,g=a.y,h=a.yLabel;return function(m,n){if(!window.NEXTSTRAIN||!window.NEXTSTRAIN.animationTickReference){var j=n(),i=j.controls,k=j.tree,l=j.metadata;if("rect"===b||"unrooted"===b||"radial"===b){m({type:v.v8,layout:b,scatterVariables:i.scatterVariables,canRenderBranchLabels:!0});return}var a="clock"===b||"scatter"===b?(0,t.HO)(i,l,k,"clock"===b):i.scatterVariables;e&&f&&(a=x({},a,(0,t.Sg)({x:e,xLabel:f},"x",i,k,l))),g&&h&&(a=x({},a,(0,t.Sg)({y:g,yLabel:h},"y",i,k,l))),void 0!==c&&(a.showBranches=c),void 0!==d&&(a.showRegression=d),"scatter"!==b||a.xContinuous&&a.yContinuous||(a.showRegression=!1),m({type:v.v8,layout:b||i.layout,scatterVariables:x({},a),canRenderBranchLabels:a.showBranches})}}},z=a(65898),A=a(73221);function B(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function l(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function C(a){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function D(d){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{},b=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(b=b.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),b.forEach(function(a){l(d,a,c[a])})}return d}function E(a,b){return(E=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}function F(b,a){return a||(a=b.slice(0)),Object.freeze(Object.defineProperties(b,{raw:{value:Object.freeze(a)}}))}function m(){var a=F(["\n  padding: 0px 5px 1px 5px;\n"]);return m=function(){return a},a}function n(){var a=F(["\n  display: flex;\n  flex-direction: row;\n  align-content: stretch;\n  flex-wrap: nowrap;\n  height: 100%;\n  order: 0;\n  flex-grow: 0;\n  flex-shrink: 1;\n  flex-basis: auto;\n  align-self: auto;\n  padding: ","px 0px 2px 15px;\n"]);return n=function(){return a},a}function o(){var a=F(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  min-width: 18px;\n  font-size: 14px;\n  font-weight: 400;\n  font-family: ",";\n  color: ",";\n"]);return o=function(){return a},a}function p(){var a=F(["\n  width: ","px;\n  font-size: 12px;\n"]);return p=function(){return a},a}var G=(0,b.Zz)(function(c){var d=c.theme,e=c.selected,b=c.width,a=e?d.selectedColor:d.unselectedColor;return(0,s.jsx)("svg",{width:b,height:b+5,children:(0,s.jsx)("g",{transform:"translate(0,2)",children:(0,s.jsx)("svg",{width:b,height:b,viewBox:"16 19 27 22",children:(0,s.jsxs)("g",{id:"Group",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",transform:"translate(17.000000, 20.000000)",children:[(0,s.jsx)("polyline",{id:"Path-3",stroke:a,points:"2.94117647 12.8571429 2.94117647 18.6083984 17.8459616 18.6083984 17.8459616 16.0260882 24.870031 16.0260882"}),(0,s.jsx)("polyline",{id:"Path-4",stroke:a,points:"17.8500004 18.5714286 17.8500004 20 25.0119374 20"}),(0,s.jsx)("polyline",{id:"Path-5",stroke:a,points:"2.94117647 12.8571429 3.00303284 7.21191058 10.2360102 7.11220045 10.4159559 2.99881623 17.1561911 2.93803403 17.1561911 0 24.313534 0"}),(0,s.jsx)("polyline",{id:"Path-6",stroke:a,points:"17.1599998 2.85714286 17.1599998 4.28571429 24.512941 4.28571429"}),(0,s.jsx)("path",{d:"M0,12.8571429 L2.94117647,12.8571429",id:"Path-6",stroke:a}),(0,s.jsx)("polyline",{id:"Path-7",stroke:a,points:"10.2941176 7.14285714 10.2941176 11.4285714 24.5454676 11.4285714"})]})})})})}),H=(0,b.Zz)(function(c){var d=c.theme,e=c.selected,b=c.width,a=e?d.selectedColor:d.unselectedColor;return(0,s.jsx)("svg",{width:b,height:b+5,children:(0,s.jsx)("g",{transform:"translate(0,0)",children:(0,s.jsx)("svg",{width:b,height:b,viewBox:"14 14 25 26",children:(0,s.jsxs)("g",{id:"Group",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",transform:"translate(15.000000, 15.000000)",children:[(0,s.jsx)("path",{d:"M15,15 L17.6450195,15",id:"Path-12",stroke:a}),(0,s.jsx)("path",{d:"M15.229248,22.5795898 L15.229248,18.2854004 C15.229248,18.2854004 17.8465223,17.6291504 17.8508301,15.0574951 C17.8551378,12.4858398 15.2944336,11.9138184 15.2944336,11.9138184 L15.229248,7.53540039",id:"Path-13",stroke:a}),(0,s.jsx)("path",{d:"M7.63037109,6.10498047 L10.230957,9.08325195 C10.230957,9.08325195 12.25,7.08233714 15.126709,7.04162598 C18.003418,7.00091481 20.5390625,8.91748047 20.5390625,8.91748047 L22.9765625,5.60839844",id:"Path-14",stroke:a}),(0,s.jsx)("path",{d:"M0.15942005,4.99135298 L2.76065146,7.96962446 C2.76065146,7.96962446 4.78019556,5.96870965 7.65761856,5.92799848 C10.5350415,5.88728732 13.0713154,7.80385298 13.0713154,7.80385298 L15.5094204,4.49477094",id:"Path-14",stroke:a,transform:"translate(7.834420, 6.232198) rotate(-34.000000) translate(-7.834420, -6.232198) "}),(0,s.jsx)("path",{d:"M7.5,21.496582 L10.1005859,24.4748535 C10.1005859,24.4748535 12.1196289,22.4739387 14.9963379,22.4332275 C17.8730469,22.3925164 20.4086914,24.309082 20.4086914,24.309082 L22.8461914,21",id:"Path-14",stroke:a,transform:"translate(15.173096, 22.737427) scale(1, -1) translate(-15.173096, -22.737427) "})]})})})})}),I=(0,b.Zz)(function(c){var d=c.theme,e=c.selected,b=c.width,a=e?d.selectedColor:d.unselectedColor;return(0,s.jsx)("svg",{width:b,height:b+5,children:(0,s.jsx)("g",{transform:"translate(0,2)",children:(0,s.jsxs)("svg",{width:b,height:b,viewBox:"106 49 150 118",children:[(0,s.jsx)("polyline",{id:"Path-2",stroke:a,strokeWidth:"4",fill:"none",points:"108 77 125.182237 87.8599894 133.381156 119.402591 111.867082 144.368016"}),(0,s.jsx)("path",{d:"M125.2,87.5 L137.624777,70",id:"Path-3",stroke:a,strokeWidth:"4",fill:"none"}),(0,s.jsx)("polyline",{id:"Path-4",stroke:a,strokeWidth:"4",fill:"none",points:"133 119.331781 192.127357 119.400002 215.445998 80.3916603 203.946476 51.4000015"}),(0,s.jsx)("path",{d:"M215.5,80.5 L253.378522,73",id:"Path-5",stroke:a,strokeWidth:"4",fill:"none"}),(0,s.jsx)("path",{d:"M192,119.2 L229.854937,164.55391",id:"Path-6",stroke:a,strokeWidth:"4",fill:"none"})]})})})}),J=(0,b.Zz)(function(c){var d=c.theme,e=c.selected,b=c.width,a=e?d.selectedColor:d.unselectedColor;return(0,s.jsx)("svg",{width:b,height:b+5,children:(0,s.jsx)("g",{transform:"translate(0,4)",children:(0,s.jsx)("svg",{width:b,height:b,viewBox:"0 0 30 30 ",children:(0,s.jsxs)("g",{id:"Group",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",transform:"translate(17.000000, 20.000000)",children:[(0,s.jsx)("polyline",{id:"Path-3",stroke:a,points:"-15 5 -15 -25 "}),(0,s.jsx)("polyline",{id:"Path-4",stroke:a,points:"-15 5 25 5"}),(0,s.jsx)("polyline",{id:"Path-5",stroke:a,points:"-12 3 20 -25 "}),(0,s.jsx)("circle",{id:"c-1",stroke:a,cx:"-8",cy:"0",r:"2"}),(0,s.jsx)("circle",{id:"c-2",stroke:a,cx:"4",cy:"-10",r:"2"}),(0,s.jsx)("circle",{id:"c-3",stroke:a,cx:"4",cy:"-15",r:"2"}),(0,s.jsx)("circle",{id:"c-4",stroke:a,cx:"-4",cy:"-5",r:"2"}),(0,s.jsx)("circle",{id:"c-5",stroke:a,cx:"-2",cy:"-11",r:"2"})]})})})})}),K=(0,b.Zz)(function(c){var d=c.theme,e=c.selected,b=c.width,a=e?d.selectedColor:d.unselectedColor;return(0,s.jsx)("svg",{width:b,height:b+5,children:(0,s.jsx)("g",{transform:"translate(0,4)",children:(0,s.jsx)("svg",{width:b,height:b,viewBox:"0 0 30 30 ",children:(0,s.jsxs)("g",{id:"Group",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",transform:"translate(17.000000, 20.000000)",children:[(0,s.jsx)("polyline",{id:"Path-3",stroke:a,points:"-15 5 -15 -25 "}),(0,s.jsx)("polyline",{id:"Path-4",stroke:a,points:"-15 5 25 5"}),(0,s.jsx)("circle",{id:"c-1",stroke:a,cx:"-8",cy:"0",r:"2"}),(0,s.jsx)("circle",{id:"c-2",stroke:a,cx:"3",cy:"0",r:"2"}),(0,s.jsx)("circle",{id:"c-3",stroke:a,cx:"8",cy:"-5",r:"2"}),(0,s.jsx)("circle",{id:"c-4",stroke:a,cx:"-4",cy:"-15",r:"2"}),(0,s.jsx)("circle",{id:"c-5",stroke:a,cx:"1",cy:"-11",r:"2"})]})})})})}),L=b.ZP.div.withConfig({componentId:"sc-aecd96ca-0"})(m()),M=b.ZP.div.withConfig({componentId:"sc-aecd96ca-1"})(n(),function(a){return a.padAbove?"2":"0"}),N=b.ZP.div.withConfig({componentId:"sc-aecd96ca-2"})(o(),function(a){return a.theme["font-family"]},function(a){return a.theme.color}),O=b.ZP.div.withConfig({componentId:"sc-aecd96ca-3"})(p(),k.HB-18),q=c=(0,i.$j)(function(a){return{layout:a.controls.layout,scatterVariables:a.controls.scatterVariables,colorings:a.metadata.colorings,colorBy:a.controls.colorBy,showTreeToo:a.controls.showTreeToo,branchLengthsToDisplay:a.controls.branchLengthsToDisplay}})((c=(l(d=function(e){"use strict";(function(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&E(b,a)})(d,e);var f,g,a,b,c,h=(f=d,g=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var b,d,a,c,e=C(f);if(g){var h=C(this).constructor;c=Reflect.construct(e,arguments,h)}else c=e.apply(this,arguments);return d=this,(a=c)&&("object"==((b=a)&&"undefined"!=typeof Symbol&&b.constructor===Symbol?"symbol":typeof b)||"function"==typeof a)?a:function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(d)});function d(){return function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,d),h.apply(this,arguments)}return a=d,b=[{key:"renderScatterplotAxesSelector",value:function(){var c=this,a=(0,t.dQ)(this.props.colorings,this.props.colorBy),d=a.filter(function(a){return a.value===c.props.scatterVariables.x})[0],e=a.filter(function(a){return a.value===c.props.scatterVariables.y})[0],b={options:a,isClearable:!1,isSearchable:!1,isMulti:!1};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(M,{children:[(0,s.jsx)(N,{children:"x"}),(0,s.jsx)(O,{children:(0,s.jsx)(A.Z,D({},b,{value:a.filter(function(a){return a.value===d.value}),onChange:function(a){return c.props.dispatch(y({x:a.value,xLabel:a.label}))}}))})]}),(0,s.jsxs)(M,{children:[(0,s.jsx)(N,{children:"y"}),(0,s.jsx)(O,{children:(0,s.jsx)(A.Z,D({},b,{value:a.filter(function(a){return a.value===e.value}),onChange:function(a){return c.props.dispatch(y({y:a.value,yLabel:a.label}))}}))})]})]})}},{key:"renderBranchToggle",value:function(){var a=this;return(0,s.jsx)(M,{padAbove:!0,children:(0,s.jsx)(z.Z,{display:!0,on:this.props.scatterVariables.showBranches,callback:function(){return a.props.dispatch(y({showBranches:!a.props.scatterVariables.showBranches}))},label:"Show branches"})})}},{key:"renderRegressionToggle",value:function(){var a=this;return"scatter"!==this.props.layout||this.props.scatterVariables.xContinuous&&this.props.scatterVariables.yContinuous?(0,s.jsx)(M,{padAbove:!0,children:(0,s.jsx)(z.Z,{display:!0,on:this.props.scatterVariables.showRegression,callback:function(){return a.props.dispatch(y({showRegression:!a.props.scatterVariables.showRegression}))},label:"Show regression"})}):null}},{key:"render",value:function(){var c=this,b=this.props.t;if(this.props.showTreeToo)return null;var a=this.props.layout;return(0,s.jsxs)("div",{style:{marginBottom:15},children:[(0,s.jsx)(u.om,{children:b("sidebar:Layout")}),(0,s.jsxs)(L,{children:[(0,s.jsx)(G,{width:25,selected:"rect"===a}),(0,s.jsx)(u.fP,{selected:"rect"===a,onClick:function(){return c.props.dispatch(y({layout:"rect"}))},children:b("sidebar:rectangular")})]}),(0,s.jsxs)(L,{children:[(0,s.jsx)(H,{width:25,selected:"radial"===a}),(0,s.jsx)(u.fP,{selected:"radial"===a,onClick:function(){return c.props.dispatch(y({layout:"radial"}))},children:b("sidebar:radial")})]}),(0,s.jsxs)(L,{children:[(0,s.jsx)(I,{width:25,selected:"unrooted"===a}),(0,s.jsx)(u.fP,{selected:"unrooted"===a,onClick:function(){return c.props.dispatch(y({layout:"unrooted"}))},children:b("sidebar:unrooted")})]}),"divAndDate"===this.props.branchLengthsToDisplay?(0,s.jsxs)(L,{children:[(0,s.jsx)(J,{width:25,selected:"clock"===a}),(0,s.jsx)(u.fP,{selected:"clock"===a,onClick:function(){return c.props.dispatch(y({layout:"clock"}))},children:b("sidebar:clock")}),"clock"===a&&this.renderBranchToggle(),"clock"===a&&this.renderRegressionToggle()]}):null,(0,s.jsxs)(L,{children:[(0,s.jsx)(K,{width:25,selected:"scatter"===a}),(0,s.jsx)(u.fP,{selected:"scatter"===a,onClick:function(){return c.props.dispatch(y({layout:"scatter"}))},children:b("sidebar:scatter")}),"scatter"===a&&this.renderScatterplotAxesSelector(),"scatter"===a&&this.renderBranchToggle(),"scatter"===a&&this.renderRegressionToggle()]})]})}}],B(a.prototype,b),c&&B(a,c),d}(g.Component),"propTypes",{layout:e().string.isRequired,dispatch:e().func.isRequired}),d))||c)||c,P=(0,j.Zh)()(q)},51203:function(i,c,a){"use strict";var b,j=a(28354),d=a(60822),e=a(46641),f=a(31884),k=a(5859),l=a(15361),m=a(59894),n=a(6290),o=a(65898);function p(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function q(a){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function r(a,b){return(r=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}var g=b=(0,e.$j)(function(a){return{distanceMeasure:a.controls.distanceMeasure,layout:a.controls.layout,showTreeToo:a.controls.showTreeToo,branchLengthsToDisplay:a.controls.branchLengthsToDisplay,temporalConfidence:a.controls.temporalConfidence}})((b=function(e){"use strict";!function(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&r(b,a)}(d,e);var f,g,a,b,c,h=(f=d,g=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var b,d,a,c,e=q(f);if(g){var h=q(this).constructor;c=Reflect.construct(e,arguments,h)}else c=e.apply(this,arguments);return d=this,(a=c)&&("object"==((b=a)&&"undefined"!=typeof Symbol&&b.constructor===Symbol?"symbol":typeof b)||"function"==typeof a)?a:function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(d)});function d(){return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,d),h.apply(this,arguments)}return a=d,b=[{key:"render",value:function(){var b=this,a=this.props.t;return"divAndDate"!==this.props.branchLengthsToDisplay?null:"scatter"===this.props.layout||"clock"===this.props.layout?null:(0,j.jsxs)("div",{style:{marginBottom:0},children:[(0,j.jsx)(n.om,{children:a("sidebar:Branch Length")}),(0,j.jsx)(n.fP,{selected:"num_date"===this.props.distanceMeasure,onClick:function(){(0,l.fs)("tree-metric-temporal"),b.props.dispatch({type:k.T3,data:"num_date"})},children:a("sidebar:time")}),(0,j.jsx)("span",{style:{paddingRight:"12px"}}),(0,j.jsx)(n.fP,{selected:"div"===this.props.distanceMeasure,onClick:function(){(0,l.fs)("tree-metric-temporal"),b.props.dispatch({type:k.T3,data:"div"})},children:a("sidebar:divergence")}),this.props.showTreeToo?null:(0,j.jsx)("div",{style:{marginBottom:5},children:(0,j.jsx)(o.Z,{display:this.props.temporalConfidence.display,on:this.props.temporalConfidence.on,callback:function(){return b.props.dispatch((0,m.DP)())},label:a("sidebar:Show confidence intervals")})})]})}}],p(a.prototype,b),c&&p(a,c),d}(d.Component))||b)||b,h=(0,f.Zh)()(g);c.Z=h},43734:function(o,e,a){"use strict";a.d(e,{X:function(){return A}});var f,b,d=a(28354),g=a(60822),h=a(69515),c=a.n(h),i=a(46641),p=a(31382),q=a(17587),r=a(69856),s=a(69480),t=a(15361),u=a(57605),v=a(73221);function w(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function x(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function j(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function y(a){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function z(a,b){return(z=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}var k="undefined"!=typeof Reflect&&"function"==typeof Reflect.metadata&&Reflect.metadata("design:paramtypes",[void 0]),l="undefined"!=typeof Reflect&&"function"==typeof Reflect.metadata&&Reflect.metadata("design:type",Function),m=(0,i.$j)(function(a){return{colorBy:a.controls.colorBy,colorings:a.metadata.colorings,genomeMap:a.entropy.genomeMap}}),n=b=m(b=l(b=k((b=(j(f=function(f){"use strict";(function(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&z(b,a)})(e,f);var g,h,a,b,c,i=(g=e,h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var b,d,a,c,e=y(g);if(h){var f=y(this).constructor;c=Reflect.construct(e,arguments,f)}else c=e.apply(this,arguments);return d=this,(a=c)&&("object"==((b=a)&&"undefined"!=typeof Symbol&&b.constructor===Symbol?"symbol":typeof b)||"function"==typeof a)?a:w(d)});function e(b){if(function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,e),j(w(a=i.call(this,b)),"dispatchColorByGenotype",(0,p.debounce)(function(b){a.dispatchColorBy(b,"genotype")},400)),a.BLANK_STATE={colorBySelected:"",geneSelected:"",positionSelected:""},(0,u.O$)(b.colorBy)){var a,c=(0,u.kW)(b.colorBy);c&&(a.state=a.newState({colorBySelected:"gt",geneSelected:c.gene,positionSelected:c.positions.join(",")}))}else a.state=a.newState({colorBySelected:b.colorBy});return a}return a=e,b=[{key:"replaceState",value:function(a){var b=this;this.setState(function(c,d){return b.newState(a)})}},{key:"newState",value:function(a){return function(d){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{},b=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(b=b.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),b.forEach(function(a){j(d,a,c[a])})}return d}({},this.BLANK_STATE,a)}},{key:"UNSAFE_componentWillReceiveProps",value:function(a){if(this.props.colorBy!==a.colorBy){if((0,u.O$)(a.colorBy)){var b=(0,u.kW)(a.colorBy);b&&this.replaceState({colorBySelected:"gt",geneSelected:b.gene,positionSelected:b.positions.join(",")})}else this.replaceState({colorBySelected:a.colorBy})}}},{key:"componentDidUpdate",value:function(){var c=this.state.colorBySelected;if("gt"===c){var d=this.state,a=d.geneSelected,e=d.positionSelected;if(a&&e){var b=(0,u.bP)({gene:a,positions:(0,u.bQ)(e,(0,u.Q$)(this.props.genomeMap,a))});b&&b!==this.props.colorBy&&this.dispatchColorByGenotype(b)}}else this.dispatchColorBy(c)}},{key:"shouldComponentUpdate",value:function(b,a){return this.state.colorBySelected!==a.colorBySelected||this.state.geneSelected!==a.geneSelected||this.state.positionSelected!==a.positionSelected||this.props.colorings!==b.colorings}},{key:"dispatchColorBy",value:function(a){var b=arguments.length>1&& void 0!==arguments[1]?arguments[1]:a;(0,t.fs)("color-by-".concat(b)),this.props.dispatch((0,s.j)(a))}},{key:"getGtGeneOptions",value:function(){if(!(null===(b=this.props.genomeMap)|| void 0===b?void 0:b.length))return[];var b,a=[{value:r.BJ,label:"nucleotide"}];return this.props.genomeMap[0].genes.forEach(function(b){b.cds.forEach(function(b){a.push({value:b.name,label:b.name})})}),a}},{key:"gtGeneSelect",value:function(){var b=this,a=this.getGtGeneOptions();return(0,d.jsx)(v.Z,{name:"selectGenotype",id:"selectGenotype",placeholder:"gene\u2026",value:a.filter(function(a){return a.value===b.state.geneSelected}),options:a,isClearable:!1,isSearchable:!0,isMulti:!1,onChange:function(a){b.setState({geneSelected:a.value})}})}},{key:"gtPositionInput",value:function(){var c=this,a=this.state.geneSelected,b=a?"".concat(a," position (1\u2013").concat((0,u.Q$)(this.props.genomeMap,a),")\u2026"):"position\u2026";return(0,d.jsx)("input",{type:"text",style:q.H2,placeholder:b,value:this.state.positionSelected,onChange:function(a){c.setState({positionSelected:a.target.value})}})}},{key:"isNormalInteger",value:function(a){var b=Math.floor(Number(a));return String(b)===a&&b>=0}},{key:"getStyles",value:function(){return{base:{width:r.HB,marginBottom:0,fontSize:14}}}},{key:"render",value:function(){var c=this,b=this.getStyles(),a=Object.keys(this.props.colorings).map(function(a){return{value:a,label:c.props.colorings[a].title}});return(0,d.jsxs)("div",{style:b.base,id:"selectColorBy",children:[(0,d.jsx)(v.Z,{name:"selectColorBy",value:a.filter(function(a){return a.value===c.state.colorBySelected}),options:a,isClearable:!1,isSearchable:!0,isMulti:!1,onChange:function(a){c.replaceState({colorBySelected:a.value})}}),"gt"===this.state.colorBySelected?(0,d.jsxs)("div",{children:[this.gtGeneSelect(),this.gtPositionInput()]}):null]})}}],x(a.prototype,b),c&&x(a,c),e}(g.Component),"propTypes",{colorBy:c().string.isRequired,colorings:c().object.isRequired,dispatch:c().func.isRequired,genomeMap:c().array}),f))||b)||b)||b)||b,A=(0,d.jsxs)(d.Fragment,{children:["Change the metadata field which the visualisation is coloured by.",(0,d.jsx)("br",{}),"The phylogeny, map and frequencies panel (if available) will all be coloured in a consistent fashion."]});e.Z=n},29668:function(c,b,a){"use strict";a.d(b,{N:function(){return g}});var d=a(28354);a(60822);var e=a(6290),f=a(68554),g=function(a){var c=a.title,b=a.tooltip;return(0,d.jsx)(e.gM,{children:(0,d.jsx)(f.Y,{title:c,tooltip:void 0===b?void 0:b})})}},70451:function(y,n,a){"use strict";a.d(n,{Z:function(){return ay},C:function(){return az}});var z,b,h,i,j,k,l,m,c,e=a(28354),f=a(60822),o=a(46641),A=a(9652),B=a(56608),C=a(3798),d=a(2753),D=a(29865),E=a(24114),F=a(45184),G=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"],H=a(52425),I=(0,f.forwardRef)(function(_,aa){var a,u,b,e,c,v,g,w,h,i,j,ab,ac,x,k,y,z,H,l,I,ad,J,m,K,ae,L,n,o,af,M,p,N,ag,O,q,P,ah,Q,r,R,S,T,s,U,V,W,t,X,Y,Z,$,ai=(b=void 0!==(u=(a=_).defaultOptions)&&u,e=a.cacheOptions,c=void 0!==e&&e,v=a.loadOptions,a.options,g=a.isLoading,w=a.onInputChange,h=a.filterOption,i=(0,F.Z)(a,G),j=i.inputValue,ab=(0,f.useRef)(void 0),ac=(0,f.useRef)(!1),x=(0,f.useState)(Array.isArray(b)?b:void 0),k=(0,E.Z)(x,2),y=k[0],z=k[1],H=(0,f.useState)(void 0!==j?j:""),l=(0,E.Z)(H,2),I=l[0],ad=l[1],J=(0,f.useState)(!0===b),m=(0,E.Z)(J,2),K=m[0],ae=m[1],L=(0,f.useState)(void 0),n=(0,E.Z)(L,2),o=n[0],af=n[1],M=(0,f.useState)([]),p=(0,E.Z)(M,2),N=p[0],ag=p[1],O=(0,f.useState)(!1),q=(0,E.Z)(O,2),P=q[0],ah=q[1],Q=(0,f.useState)({}),r=(0,E.Z)(Q,2),R=r[0],S=r[1],T=(0,f.useState)(void 0),s=(0,E.Z)(T,2),U=s[0],V=s[1],W=(0,f.useState)(void 0),t=(0,E.Z)(W,2),X=t[0],Y=t[1],c!==X&&(S({}),Y(c)),b!==U&&(z(Array.isArray(b)?b:void 0),V(b)),(0,f.useEffect)(function(){return ac.current=!0,function(){ac.current=!1}},[]),Z=(0,f.useCallback)(function(c,a){if(!v)return a();var b=v(c,a);b&&"function"==typeof b.then&&b.then(a,function(){return a()})},[v]),(0,f.useEffect)(function(){!0===b&&Z(I,function(a){ac.current&&(z(a||[]),ae(!!ab.current))})},[]),$=(0,f.useCallback)(function(b,e){var a=(0,D.N)(b,e,w);if(!a){ab.current=void 0,ad(""),af(""),ag([]),ae(!1),ah(!1);return}if(c&&R[a])ad(a),af(a),ag(R[a]),ae(!1),ah(!1);else{var f=ab.current={};ad(a),ae(!0),ah(!o),Z(a,function(b){ac&&f===ab.current&&(ab.current=void 0,ae(!1),af(a),ag(b||[]),ah(!1),S(b?(0,D.a)((0,D.a)({},R),{},(0,d.Z)({},a,b)):R))})}},[c,Z,o,R,w]),(0,D.a)((0,D.a)({},i),{},{options:P?[]:I&&o?N:y||[],isLoading:K|| void 0!==g&&g,onInputChange:$,filterOption:void 0===h?null:h})),aj=(0,C.u)(ai);return f.createElement(B.S,(0,A.Z)({ref:aa},aj))}),J=a(31382),K=a(69856),L=a(26061),M=a(59894),N=a(82379),O=a(26250),P=a(73221),Q=a(6290),R=a(59518),S=a(74619),T=a(18679),U=a(81348);function V(b,a){if(a&&("object"===(0,T.Z)(a)||"function"==typeof a))return a;if(void 0!==a)throw new TypeError("Derived constructors may only return object or undefined");return(0,U.Z)(b)}var W=a(37418),X=a(90958);function Y(a){var b,d,c="";if("string"==typeof a||"number"==typeof a)c+=a;else if("object"==typeof a){if(Array.isArray(a))for(b=0;b<a.length;b++)a[b]&&(d=Y(a[b]))&&(c&&(c+=" "),c+=d);else for(b in a)a[b]&&(c&&(c+=" "),c+=b)}return c}function Z(){for(var b,c,d=0,a="";d<arguments.length;)(b=arguments[d++])&&(c=Y(b))&&(a&&(a+=" "),a+=c);return a}function $(a){var e=a.cellCount,b=a.cellSize,f=a.computeMetadataCallback,g=a.computeMetadataCallbackProps,h=a.nextCellsCount,c=a.nextCellSize,i=a.nextScrollToIndex,d=a.scrollToIndex,j=a.updateScrollOffsetForScrollToIndex;(e!==h||("number"==typeof b||"number"==typeof c)&&b!==c)&&(f(g),d>=0&&d===i&&j())}var _=function(){function a(b){var c=b.cellCount,e=b.cellSizeGetter,f=b.estimatedCellSize;(0,R.Z)(this,a),(0,d.Z)(this,"_cellSizeAndPositionData",{}),(0,d.Z)(this,"_lastMeasuredIndex",-1),(0,d.Z)(this,"_lastBatchedIndex",-1),(0,d.Z)(this,"_cellCount",void 0),(0,d.Z)(this,"_cellSizeGetter",void 0),(0,d.Z)(this,"_estimatedCellSize",void 0),this._cellSizeGetter=e,this._cellCount=c,this._estimatedCellSize=f}return(0,S.Z)(a,[{key:"areOffsetsAdjusted",value:function(){return!1}},{key:"configure",value:function(a){var b=a.cellCount,c=a.estimatedCellSize,d=a.cellSizeGetter;this._cellCount=b,this._estimatedCellSize=c,this._cellSizeGetter=d}},{key:"getCellCount",value:function(){return this._cellCount}},{key:"getEstimatedCellSize",value:function(){return this._estimatedCellSize}},{key:"getLastMeasuredIndex",value:function(){return this._lastMeasuredIndex}},{key:"getOffsetAdjustment",value:function(){return 0}},{key:"getSizeAndPositionOfCell",value:function(a){if(a<0||a>=this._cellCount)throw Error("Requested index ".concat(a," is outside of range 0..").concat(this._cellCount));if(a>this._lastMeasuredIndex)for(var e=this.getSizeAndPositionOfLastMeasuredCell(),d=e.offset+e.size,b=this._lastMeasuredIndex+1;b<=a;b++){var c=this._cellSizeGetter({index:b});if(void 0===c||isNaN(c))throw Error("Invalid size returned for cell ".concat(b," of value ").concat(c));null===c?(this._cellSizeAndPositionData[b]={offset:d,size:0},this._lastBatchedIndex=a):(this._cellSizeAndPositionData[b]={offset:d,size:c},d+=c,this._lastMeasuredIndex=a)}return this._cellSizeAndPositionData[a]}},{key:"getSizeAndPositionOfLastMeasuredCell",value:function(){return this._lastMeasuredIndex>=0?this._cellSizeAndPositionData[this._lastMeasuredIndex]:{offset:0,size:0}}},{key:"getTotalSize",value:function(){var a=this.getSizeAndPositionOfLastMeasuredCell();return a.offset+a.size+(this._cellCount-this._lastMeasuredIndex-1)*this._estimatedCellSize}},{key:"getUpdatedOffsetForIndex",value:function(b){var a,f=b.align,c=b.containerSize,h=b.currentOffset,i=b.targetIndex;if(c<=0)return 0;var e=this.getSizeAndPositionOfCell(i),d=e.offset,g=d-c+e.size;switch(void 0===f?"auto":f){case"start":a=d;break;case"end":a=g;break;case"center":a=d-(c-e.size)/2;break;default:a=Math.max(g,Math.min(d,h))}return Math.max(0,Math.min(this.getTotalSize()-c,a))}},{key:"getVisibleCellRange",value:function(d){var f=d.containerSize,a=d.offset,g=this.getTotalSize();if(0===g)return{};var h=a+f,c=this._findNearestCell(a),e=this.getSizeAndPositionOfCell(c);a=e.offset+e.size;for(var b=c;a<h&&b<this._cellCount-1;)b++,a+=this.getSizeAndPositionOfCell(b).size;return{start:c,stop:b}}},{key:"resetCell",value:function(a){this._lastMeasuredIndex=Math.min(this._lastMeasuredIndex,a-1)}},{key:"_binarySearch",value:function(c,a,d){for(;a<=c;){var b=a+Math.floor((c-a)/2),e=this.getSizeAndPositionOfCell(b).offset;if(e===d)return b;e<d?a=b+1:e>d&&(c=b-1)}return a>0?a-1:0}},{key:"_exponentialSearch",value:function(a,b){for(var c=1;a<this._cellCount&&this.getSizeAndPositionOfCell(a).offset<b;)a+=c,c*=2;return this._binarySearch(Math.min(a,this._cellCount-1),Math.floor(a/2),b)}},{key:"_findNearestCell",value:function(a){if(isNaN(a))throw Error("Invalid offset ".concat(a," specified"));a=Math.max(0,a);var c=this.getSizeAndPositionOfLastMeasuredCell(),b=Math.max(0,this._lastMeasuredIndex);return c.offset>=a?this._binarySearch(b,0,a):this._exponentialSearch(b,a)}}]),a}(),aa=function(){function a(b){var c=b.maxScrollSize,e=void 0===c?"undefined"!=typeof window&&window.chrome?16777100:15e5:c,f=(0,F.Z)(b,["maxScrollSize"]);(0,R.Z)(this,a),(0,d.Z)(this,"_cellSizeAndPositionManager",void 0),(0,d.Z)(this,"_maxScrollSize",void 0),this._cellSizeAndPositionManager=new _(f),this._maxScrollSize=e}return(0,S.Z)(a,[{key:"areOffsetsAdjusted",value:function(){return this._cellSizeAndPositionManager.getTotalSize()>this._maxScrollSize}},{key:"configure",value:function(a){this._cellSizeAndPositionManager.configure(a)}},{key:"getCellCount",value:function(){return this._cellSizeAndPositionManager.getCellCount()}},{key:"getEstimatedCellSize",value:function(){return this._cellSizeAndPositionManager.getEstimatedCellSize()}},{key:"getLastMeasuredIndex",value:function(){return this._cellSizeAndPositionManager.getLastMeasuredIndex()}},{key:"getOffsetAdjustment",value:function(a){var c=a.containerSize,d=a.offset,e=this._cellSizeAndPositionManager.getTotalSize(),b=this.getTotalSize(),f=this._getOffsetPercentage({containerSize:c,offset:d,totalSize:b});return Math.round(f*(b-e))}},{key:"getSizeAndPositionOfCell",value:function(a){return this._cellSizeAndPositionManager.getSizeAndPositionOfCell(a)}},{key:"getSizeAndPositionOfLastMeasuredCell",value:function(){return this._cellSizeAndPositionManager.getSizeAndPositionOfLastMeasuredCell()}},{key:"getTotalSize",value:function(){return Math.min(this._maxScrollSize,this._cellSizeAndPositionManager.getTotalSize())}},{key:"getUpdatedOffsetForIndex",value:function(a){var d=a.align,e=void 0===d?"auto":d,b=a.containerSize,c=a.currentOffset,f=a.targetIndex;c=this._safeOffsetToOffset({containerSize:b,offset:c});var g=this._cellSizeAndPositionManager.getUpdatedOffsetForIndex({align:e,containerSize:b,currentOffset:c,targetIndex:f});return this._offsetToSafeOffset({containerSize:b,offset:g})}},{key:"getVisibleCellRange",value:function(b){var c=b.containerSize,a=b.offset;return a=this._safeOffsetToOffset({containerSize:c,offset:a}),this._cellSizeAndPositionManager.getVisibleCellRange({containerSize:c,offset:a})}},{key:"resetCell",value:function(a){this._cellSizeAndPositionManager.resetCell(a)}},{key:"_getOffsetPercentage",value:function(a){var b=a.containerSize,d=a.offset,c=a.totalSize;return c<=b?0:d/(c-b)}},{key:"_offsetToSafeOffset",value:function(a){var b=a.containerSize,c=a.offset,d=this._cellSizeAndPositionManager.getTotalSize(),e=this.getTotalSize();return d===e?c:Math.round(this._getOffsetPercentage({containerSize:b,offset:c,totalSize:d})*(e-b))}},{key:"_safeOffsetToOffset",value:function(a){var b=a.containerSize,c=a.offset,d=this._cellSizeAndPositionManager.getTotalSize(),e=this.getTotalSize();return d===e?c:Math.round(this._getOffsetPercentage({containerSize:b,offset:c,totalSize:e})*(d-b))}}]),a}();function ab(){var a=!(arguments.length>0)|| void 0===arguments[0]||arguments[0],b={};return function(e){var f=e.callback,c=e.indices,d=Object.keys(c),g=!a||d.every(function(b){var a=c[b];return Array.isArray(a)?a.length>0:a>=0}),h=d.length!==Object.keys(b).length||d.some(function(d){var e=b[d],a=c[d];return Array.isArray(a)?e.join(",")!==a.join(","):e!==a});b=c,g&&h&&f(c)}}function ac(a){var e=a.cellSize,f=a.cellSizeAndPositionManager,k=a.previousCellsCount,g=a.previousCellSize,l=a.previousScrollToAlignment,m=a.previousScrollToIndex,h=a.previousSize,n=a.scrollOffset,o=a.scrollToAlignment,b=a.scrollToIndex,d=a.size,p=a.sizeJustIncreasedFromZero,i=a.updateScrollIndexCallback,c=f.getCellCount(),j=b>=0&&b<c;j&&(d!==h||p||!g||"number"==typeof e&&e!==g||o!==l||b!==m)?i(b):!j&&c>0&&(d<h||c<k)&&n>f.getTotalSize()-d&&i(c-1)}var ad=!!("undefined"!=typeof window&&window.document&&window.document.createElement),p=a(2585),q=(b="undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||b.oRequestAnimationFrame||b.msRequestAnimationFrame||function(a){return b.setTimeout(a,1e3/60)},r=b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.mozCancelAnimationFrame||b.oCancelAnimationFrame||b.msCancelAnimationFrame||function(a){b.clearTimeout(a)},ae=q,af=r,ag=function(a){return af(a.id)},ah=function(b,c){Promise.resolve().then(function(){d=Date.now()});var d,a={id:ae(function e(){Date.now()-d>=c?b.call():a.id=ae(e)})};return a};function ai(c,d){var a=Object.keys(c);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(c);d&&(b=b.filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable})),a.push.apply(a,b)}return a}function aj(c){for(var a=1;a<arguments.length;a++){var b=null!=arguments[a]?arguments[a]:{};a%2?ai(b,!0).forEach(function(a){(0,d.Z)(c,a,b[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(b)):ai(b).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(b,a))})}return c}var ak={OBSERVED:"observed",REQUESTED:"requested"},g=(i=h=function(b){function a(b){(0,R.Z)(this,a),c=V(this,(0,W.Z)(a).call(this,b)),(0,d.Z)((0,U.Z)(c),"_onGridRenderedMemoizer",ab()),(0,d.Z)((0,U.Z)(c),"_onScrollMemoizer",ab(!1)),(0,d.Z)((0,U.Z)(c),"_deferredInvalidateColumnIndex",null),(0,d.Z)((0,U.Z)(c),"_deferredInvalidateRowIndex",null),(0,d.Z)((0,U.Z)(c),"_recomputeScrollLeftFlag",!1),(0,d.Z)((0,U.Z)(c),"_recomputeScrollTopFlag",!1),(0,d.Z)((0,U.Z)(c),"_horizontalScrollBarSize",0),(0,d.Z)((0,U.Z)(c),"_verticalScrollBarSize",0),(0,d.Z)((0,U.Z)(c),"_scrollbarPresenceChanged",!1),(0,d.Z)((0,U.Z)(c),"_scrollingContainer",void 0),(0,d.Z)((0,U.Z)(c),"_childrenToDisplay",void 0),(0,d.Z)((0,U.Z)(c),"_columnStartIndex",void 0),(0,d.Z)((0,U.Z)(c),"_columnStopIndex",void 0),(0,d.Z)((0,U.Z)(c),"_rowStartIndex",void 0),(0,d.Z)((0,U.Z)(c),"_rowStopIndex",void 0),(0,d.Z)((0,U.Z)(c),"_renderedColumnStartIndex",0),(0,d.Z)((0,U.Z)(c),"_renderedColumnStopIndex",0),(0,d.Z)((0,U.Z)(c),"_renderedRowStartIndex",0),(0,d.Z)((0,U.Z)(c),"_renderedRowStopIndex",0),(0,d.Z)((0,U.Z)(c),"_initialScrollTop",void 0),(0,d.Z)((0,U.Z)(c),"_initialScrollLeft",void 0),(0,d.Z)((0,U.Z)(c),"_disablePointerEventsTimeoutId",void 0),(0,d.Z)((0,U.Z)(c),"_styleCache",{}),(0,d.Z)((0,U.Z)(c),"_cellCache",{}),(0,d.Z)((0,U.Z)(c),"_debounceScrollEndedCallback",function(){c._disablePointerEventsTimeoutId=null,c.setState({isScrolling:!1,needToResetStyleCache:!1})}),(0,d.Z)((0,U.Z)(c),"_invokeOnGridRenderedHelper",function(){var a=c.props.onSectionRendered;c._onGridRenderedMemoizer({callback:a,indices:{columnOverscanStartIndex:c._columnStartIndex,columnOverscanStopIndex:c._columnStopIndex,columnStartIndex:c._renderedColumnStartIndex,columnStopIndex:c._renderedColumnStopIndex,rowOverscanStartIndex:c._rowStartIndex,rowOverscanStopIndex:c._rowStopIndex,rowStartIndex:c._renderedRowStartIndex,rowStopIndex:c._renderedRowStopIndex}})}),(0,d.Z)((0,U.Z)(c),"_setScrollingContainerRef",function(a){c._scrollingContainer=a}),(0,d.Z)((0,U.Z)(c),"_onScroll",function(a){a.target===c._scrollingContainer&&c.handleScrollEvent(a.target)});var c,e=new aa({cellCount:b.columnCount,cellSizeGetter:function(c){return a._wrapSizeGetter(b.columnWidth)(c)},estimatedCellSize:a._getEstimatedColumnSize(b)}),f=new aa({cellCount:b.rowCount,cellSizeGetter:function(c){return a._wrapSizeGetter(b.rowHeight)(c)},estimatedCellSize:a._getEstimatedRowSize(b)});return c.state={instanceProps:{columnSizeAndPositionManager:e,rowSizeAndPositionManager:f,prevColumnWidth:b.columnWidth,prevRowHeight:b.rowHeight,prevColumnCount:b.columnCount,prevRowCount:b.rowCount,prevIsScrolling:!0===b.isScrolling,prevScrollToColumn:b.scrollToColumn,prevScrollToRow:b.scrollToRow,scrollbarSize:0,scrollbarSizeMeasured:!1},isScrolling:!1,scrollDirectionHorizontal:1,scrollDirectionVertical:1,scrollLeft:0,scrollTop:0,scrollPositionChangeReason:null,needToResetStyleCache:!1},b.scrollToRow>0&&(c._initialScrollTop=c._getCalculatedScrollTop(b,c.state)),b.scrollToColumn>0&&(c._initialScrollLeft=c._getCalculatedScrollLeft(b,c.state)),c}return(0,X.Z)(a,b),(0,S.Z)(a,[{key:"getOffsetForCell",value:function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{},b=a.alignment,f=void 0===b?this.props.scrollToAlignment:b,c=a.columnIndex,g=void 0===c?this.props.scrollToColumn:c,d=a.rowIndex,h=void 0===d?this.props.scrollToRow:d,e=aj({},this.props,{scrollToAlignment:f,scrollToColumn:g,scrollToRow:h});return{scrollLeft:this._getCalculatedScrollLeft(e),scrollTop:this._getCalculatedScrollTop(e)}}},{key:"getTotalRowsHeight",value:function(){return this.state.instanceProps.rowSizeAndPositionManager.getTotalSize()}},{key:"getTotalColumnsWidth",value:function(){return this.state.instanceProps.columnSizeAndPositionManager.getTotalSize()}},{key:"handleScrollEvent",value:function(f){var g=f.scrollLeft,h=f.scrollTop,i=void 0===h?0:h;if(!(i<0)){this._debounceScrollEnded();var c=this.props,m=c.autoHeight,n=c.autoWidth,o=c.height,p=c.width,e=this.state.instanceProps,j=e.scrollbarSize,k=e.rowSizeAndPositionManager.getTotalSize(),l=e.columnSizeAndPositionManager.getTotalSize(),a=Math.min(Math.max(0,l-p+j),void 0===g?0:g),b=Math.min(Math.max(0,k-o+j),i);if(this.state.scrollLeft!==a||this.state.scrollTop!==b){var d={isScrolling:!0,scrollDirectionHorizontal:a!==this.state.scrollLeft?a>this.state.scrollLeft?1:-1:this.state.scrollDirectionHorizontal,scrollDirectionVertical:b!==this.state.scrollTop?b>this.state.scrollTop?1:-1:this.state.scrollDirectionVertical,scrollPositionChangeReason:ak.OBSERVED};m||(d.scrollTop=b),n||(d.scrollLeft=a),d.needToResetStyleCache=!1,this.setState(d)}this._invokeOnScrollMemoizer({scrollLeft:a,scrollTop:b,totalColumnsWidth:l,totalRowsHeight:k})}}},{key:"invalidateCellSizeAfterRender",value:function(a){var b=a.columnIndex,c=a.rowIndex;this._deferredInvalidateColumnIndex="number"==typeof this._deferredInvalidateColumnIndex?Math.min(this._deferredInvalidateColumnIndex,b):b,this._deferredInvalidateRowIndex="number"==typeof this._deferredInvalidateRowIndex?Math.min(this._deferredInvalidateRowIndex,c):c}},{key:"measureAllCells",value:function(){var a=this.props,c=a.columnCount,d=a.rowCount,b=this.state.instanceProps;b.columnSizeAndPositionManager.getSizeAndPositionOfCell(c-1),b.rowSizeAndPositionManager.getSizeAndPositionOfCell(d-1)}},{key:"recomputeGridSize",value:function(){var e=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{},f=e.columnIndex,a=void 0===f?0:f,g=e.rowIndex,b=void 0===g?0:g,h=this.props,c=h.scrollToColumn,d=h.scrollToRow,i=this.state.instanceProps;i.columnSizeAndPositionManager.resetCell(a),i.rowSizeAndPositionManager.resetCell(b),this._recomputeScrollLeftFlag=c>=0&&(1===this.state.scrollDirectionHorizontal?a<=c:a>=c),this._recomputeScrollTopFlag=d>=0&&(1===this.state.scrollDirectionVertical?b<=d:b>=d),this._styleCache={},this._cellCache={},this.forceUpdate()}},{key:"scrollToCell",value:function(a){var b=a.columnIndex,c=a.rowIndex,e=this.props.columnCount,d=this.props;e>1&& void 0!==b&&this._updateScrollLeftForScrollToColumn(aj({},d,{scrollToColumn:b})),void 0!==c&&this._updateScrollTopForScrollToRow(aj({},d,{scrollToRow:c}))}},{key:"componentDidMount",value:function(){var b=this.props,l=b.getScrollbarSize,h=b.height,c=b.scrollLeft,i=b.scrollToColumn,d=b.scrollTop,j=b.scrollToRow,k=b.width,e=this.state.instanceProps;if(this._initialScrollTop=0,this._initialScrollLeft=0,this._handleInvalidatedGridSize(),e.scrollbarSizeMeasured||this.setState(function(b){var a=aj({},b,{needToResetStyleCache:!1});return a.instanceProps.scrollbarSize=l(),a.instanceProps.scrollbarSizeMeasured=!0,a}),"number"==typeof c&&c>=0||"number"==typeof d&&d>=0){var f=a._getScrollToPositionStateUpdate({prevState:this.state,scrollLeft:c,scrollTop:d});f&&(f.needToResetStyleCache=!1,this.setState(f))}this._scrollingContainer&&(this._scrollingContainer.scrollLeft!==this.state.scrollLeft&&(this._scrollingContainer.scrollLeft=this.state.scrollLeft),this._scrollingContainer.scrollTop!==this.state.scrollTop&&(this._scrollingContainer.scrollTop=this.state.scrollTop));var g=h>0&&k>0;i>=0&&g&&this._updateScrollLeftForScrollToColumn(),j>=0&&g&&this._updateScrollTopForScrollToRow(),this._invokeOnGridRenderedHelper(),this._invokeOnScrollMemoizer({scrollLeft:c||0,scrollTop:d||0,totalColumnsWidth:e.columnSizeAndPositionManager.getTotalSize(),totalRowsHeight:e.rowSizeAndPositionManager.getTotalSize()}),this._maybeCallOnScrollbarPresenceChange()}},{key:"componentDidUpdate",value:function(a,g){var v=this,b=this.props,m=b.autoHeight,n=b.autoWidth,o=b.columnCount,h=b.height,p=b.rowCount,i=b.scrollToAlignment,q=b.scrollToColumn,r=b.scrollToRow,j=b.width,e=this.state,c=e.scrollLeft,s=e.scrollPositionChangeReason,d=e.scrollTop,f=e.instanceProps;this._handleInvalidatedGridSize();var k=o>0&&0===a.columnCount||p>0&&0===a.rowCount;s===ak.REQUESTED&&(!n&&c>=0&&(c!==this._scrollingContainer.scrollLeft||k)&&(this._scrollingContainer.scrollLeft=c),!m&&d>=0&&(d!==this._scrollingContainer.scrollTop||k)&&(this._scrollingContainer.scrollTop=d));var l=(0===a.width||0===a.height)&&h>0&&j>0;if(this._recomputeScrollLeftFlag?(this._recomputeScrollLeftFlag=!1,this._updateScrollLeftForScrollToColumn(this.props)):ac({cellSizeAndPositionManager:f.columnSizeAndPositionManager,previousCellsCount:a.columnCount,previousCellSize:a.columnWidth,previousScrollToAlignment:a.scrollToAlignment,previousScrollToIndex:a.scrollToColumn,previousSize:a.width,scrollOffset:c,scrollToAlignment:i,scrollToIndex:q,size:j,sizeJustIncreasedFromZero:l,updateScrollIndexCallback:function(){return v._updateScrollLeftForScrollToColumn(v.props)}}),this._recomputeScrollTopFlag?(this._recomputeScrollTopFlag=!1,this._updateScrollTopForScrollToRow(this.props)):ac({cellSizeAndPositionManager:f.rowSizeAndPositionManager,previousCellsCount:a.rowCount,previousCellSize:a.rowHeight,previousScrollToAlignment:a.scrollToAlignment,previousScrollToIndex:a.scrollToRow,previousSize:a.height,scrollOffset:d,scrollToAlignment:i,scrollToIndex:r,size:h,sizeJustIncreasedFromZero:l,updateScrollIndexCallback:function(){return v._updateScrollTopForScrollToRow(v.props)}}),this._invokeOnGridRenderedHelper(),c!==g.scrollLeft||d!==g.scrollTop){var t=f.rowSizeAndPositionManager.getTotalSize(),u=f.columnSizeAndPositionManager.getTotalSize();this._invokeOnScrollMemoizer({scrollLeft:c,scrollTop:d,totalColumnsWidth:u,totalRowsHeight:t})}this._maybeCallOnScrollbarPresenceChange()}},{key:"componentWillUnmount",value:function(){this._disablePointerEventsTimeoutId&&ag(this._disablePointerEventsTimeoutId)}},{key:"render",value:function(){var a=this.props,m=a.autoContainerWidth,n=a.autoHeight,o=a.autoWidth,p=a.className,q=a.containerProps,r=a.containerRole,s=a.containerStyle,b=a.height,t=a.id,u=a.noContentRenderer,v=a.role,w=a.style,x=a.tabIndex,c=a.width,l=this.state,d=l.instanceProps,y=l.needToResetStyleCache,z=this._isScrolling(),h={boxSizing:"border-box",direction:"ltr",height:n?"auto":b,position:"relative",width:o?"auto":c,WebkitOverflowScrolling:"touch",willChange:"transform"};y&&(this._styleCache={}),this.state.isScrolling||this._resetStyleCache(),this._calculateChildrenToRender(this.props,this.state);var e=d.columnSizeAndPositionManager.getTotalSize(),g=d.rowSizeAndPositionManager.getTotalSize(),i=g>b?d.scrollbarSize:0,j=e>c?d.scrollbarSize:0;(j!==this._horizontalScrollBarSize||i!==this._verticalScrollBarSize)&&(this._horizontalScrollBarSize=j,this._verticalScrollBarSize=i,this._scrollbarPresenceChanged=!0),h.overflowX=e+i<=c?"hidden":"auto",h.overflowY=g+j<=b?"hidden":"auto";var k=this._childrenToDisplay,B=0===k.length&&b>0&&c>0;return f.createElement("div",(0,A.Z)({ref:this._setScrollingContainerRef},q,{"aria-label":this.props["aria-label"],"aria-readonly":this.props["aria-readonly"],className:Z("ReactVirtualized__Grid",p),id:t,onScroll:this._onScroll,role:v,style:aj({},h,{},w),tabIndex:x}),k.length>0&&f.createElement("div",{className:"ReactVirtualized__Grid__innerScrollContainer",role:r,style:aj({width:m?"auto":e,height:g,maxWidth:e,maxHeight:g,overflow:"hidden",pointerEvents:z?"none":"",position:"relative"},s)},k),B&&u())}},{key:"_calculateChildrenToRender",value:function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:this.props,d=arguments.length>1&& void 0!==arguments[1]?arguments[1]:this.state,v=a.cellRenderer,w=a.cellRangeRenderer,q=a.columnCount,e=a.deferredMeasurementCache,k=a.height,x=a.overscanColumnCount,r=a.overscanIndicesGetter,y=a.overscanRowCount,s=a.rowCount,l=a.width,z=a.isScrollingOptOut,A=d.scrollDirectionHorizontal,B=d.scrollDirectionVertical,f=d.instanceProps,m=this._initialScrollTop>0?this._initialScrollTop:d.scrollTop,n=this._initialScrollLeft>0?this._initialScrollLeft:d.scrollLeft,C=this._isScrolling(a,d);if(this._childrenToDisplay=[],k>0&&l>0){var b=f.columnSizeAndPositionManager.getVisibleCellRange({containerSize:l,offset:n}),c=f.rowSizeAndPositionManager.getVisibleCellRange({containerSize:k,offset:m}),D=f.columnSizeAndPositionManager.getOffsetAdjustment({containerSize:l,offset:n}),E=f.rowSizeAndPositionManager.getOffsetAdjustment({containerSize:k,offset:m});this._renderedColumnStartIndex=b.start,this._renderedColumnStopIndex=b.stop,this._renderedRowStartIndex=c.start,this._renderedRowStopIndex=c.stop;var t=r({direction:"horizontal",cellCount:q,overscanCellsCount:x,scrollDirection:A,startIndex:"number"==typeof b.start?b.start:0,stopIndex:"number"==typeof b.stop?b.stop:-1}),u=r({direction:"vertical",cellCount:s,overscanCellsCount:y,scrollDirection:B,startIndex:"number"==typeof c.start?c.start:0,stopIndex:"number"==typeof c.stop?c.stop:-1}),g=t.overscanStartIndex,h=t.overscanStopIndex,i=u.overscanStartIndex,j=u.overscanStopIndex;if(e){if(!e.hasFixedHeight()){for(var o=i;o<=j;o++)if(!e.has(o,0)){g=0,h=q-1;break}}if(!e.hasFixedWidth()){for(var p=g;p<=h;p++)if(!e.has(0,p)){i=0,j=s-1;break}}}this._childrenToDisplay=w({cellCache:this._cellCache,cellRenderer:v,columnSizeAndPositionManager:f.columnSizeAndPositionManager,columnStartIndex:g,columnStopIndex:h,deferredMeasurementCache:e,horizontalOffsetAdjustment:D,isScrolling:C,isScrollingOptOut:z,parent:this,rowSizeAndPositionManager:f.rowSizeAndPositionManager,rowStartIndex:i,rowStopIndex:j,scrollLeft:n,scrollTop:m,styleCache:this._styleCache,verticalOffsetAdjustment:E,visibleColumnIndices:b,visibleRowIndices:c}),this._columnStartIndex=g,this._columnStopIndex=h,this._rowStartIndex=i,this._rowStopIndex=j}}},{key:"_debounceScrollEnded",value:function(){var a=this.props.scrollingResetTimeInterval;this._disablePointerEventsTimeoutId&&ag(this._disablePointerEventsTimeoutId),this._disablePointerEventsTimeoutId=ah(this._debounceScrollEndedCallback,a)}},{key:"_handleInvalidatedGridSize",value:function(){if("number"==typeof this._deferredInvalidateColumnIndex&&"number"==typeof this._deferredInvalidateRowIndex){var a=this._deferredInvalidateColumnIndex,b=this._deferredInvalidateRowIndex;this._deferredInvalidateColumnIndex=null,this._deferredInvalidateRowIndex=null,this.recomputeGridSize({columnIndex:a,rowIndex:b})}}},{key:"_invokeOnScrollMemoizer",value:function(a){var d=this,b=a.scrollLeft,c=a.scrollTop,e=a.totalColumnsWidth,f=a.totalRowsHeight;this._onScrollMemoizer({callback:function(b){var c=b.scrollLeft,g=b.scrollTop,a=d.props,h=a.height,i=a.onScroll,j=a.width;i({clientHeight:h,clientWidth:j,scrollHeight:f,scrollLeft:c,scrollTop:g,scrollWidth:e})},indices:{scrollLeft:b,scrollTop:c}})}},{key:"_isScrolling",value:function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:this.props,b=arguments.length>1&& void 0!==arguments[1]?arguments[1]:this.state;return Object.hasOwnProperty.call(a,"isScrolling")?Boolean(a.isScrolling):Boolean(b.isScrolling)}},{key:"_maybeCallOnScrollbarPresenceChange",value:function(){if(this._scrollbarPresenceChanged){var a=this.props.onScrollbarPresenceChange;this._scrollbarPresenceChanged=!1,a({horizontal:this._horizontalScrollBarSize>0,size:this.state.instanceProps.scrollbarSize,vertical:this._verticalScrollBarSize>0})}}},{key:"scrollToPosition",value:function(c){var d=c.scrollLeft,e=c.scrollTop,b=a._getScrollToPositionStateUpdate({prevState:this.state,scrollLeft:d,scrollTop:e});b&&(b.needToResetStyleCache=!1,this.setState(b))}},{key:"_getCalculatedScrollLeft",value:function(){var b=arguments.length>0&& void 0!==arguments[0]?arguments[0]:this.props,c=arguments.length>1&& void 0!==arguments[1]?arguments[1]:this.state;return a._getCalculatedScrollLeft(b,c)}},{key:"_updateScrollLeftForScrollToColumn",value:function(){var c=arguments.length>0&& void 0!==arguments[0]?arguments[0]:this.props,d=arguments.length>1&& void 0!==arguments[1]?arguments[1]:this.state,b=a._getScrollLeftForScrollToColumnStateUpdate(c,d);b&&(b.needToResetStyleCache=!1,this.setState(b))}},{key:"_getCalculatedScrollTop",value:function(){var b=arguments.length>0&& void 0!==arguments[0]?arguments[0]:this.props,c=arguments.length>1&& void 0!==arguments[1]?arguments[1]:this.state;return a._getCalculatedScrollTop(b,c)}},{key:"_resetStyleCache",value:function(){var d=this._styleCache,e=this._cellCache,f=this.props.isScrollingOptOut;this._cellCache={},this._styleCache={};for(var b=this._rowStartIndex;b<=this._rowStopIndex;b++)for(var c=this._columnStartIndex;c<=this._columnStopIndex;c++){var a="".concat(b,"-").concat(c);this._styleCache[a]=d[a],f&&(this._cellCache[a]=e[a])}}},{key:"_updateScrollTopForScrollToRow",value:function(){var c=arguments.length>0&& void 0!==arguments[0]?arguments[0]:this.props,d=arguments.length>1&& void 0!==arguments[1]?arguments[1]:this.state,b=a._getScrollTopForScrollToRowStateUpdate(c,d);b&&(b.needToResetStyleCache=!1,this.setState(b))}}],[{key:"getDerivedStateFromProps",value:function(b,e){var f,g,d={};0===b.columnCount&&0!==e.scrollLeft||0===b.rowCount&&0!==e.scrollTop?(d.scrollLeft=0,d.scrollTop=0):(b.scrollLeft!==e.scrollLeft&&b.scrollToColumn<0||b.scrollTop!==e.scrollTop&&b.scrollToRow<0)&&Object.assign(d,a._getScrollToPositionStateUpdate({prevState:e,scrollLeft:b.scrollLeft,scrollTop:b.scrollTop}));var c=e.instanceProps;return d.needToResetStyleCache=!1,(b.columnWidth!==c.prevColumnWidth||b.rowHeight!==c.prevRowHeight)&&(d.needToResetStyleCache=!0),c.columnSizeAndPositionManager.configure({cellCount:b.columnCount,estimatedCellSize:a._getEstimatedColumnSize(b),cellSizeGetter:a._wrapSizeGetter(b.columnWidth)}),c.rowSizeAndPositionManager.configure({cellCount:b.rowCount,estimatedCellSize:a._getEstimatedRowSize(b),cellSizeGetter:a._wrapSizeGetter(b.rowHeight)}),(0===c.prevColumnCount||0===c.prevRowCount)&&(c.prevColumnCount=0,c.prevRowCount=0),b.autoHeight&& !1===b.isScrolling&& !0===c.prevIsScrolling&&Object.assign(d,{isScrolling:!1}),$({cellCount:c.prevColumnCount,cellSize:"number"==typeof c.prevColumnWidth?c.prevColumnWidth:null,computeMetadataCallback:function(){return c.columnSizeAndPositionManager.resetCell(0)},computeMetadataCallbackProps:b,nextCellsCount:b.columnCount,nextCellSize:"number"==typeof b.columnWidth?b.columnWidth:null,nextScrollToIndex:b.scrollToColumn,scrollToIndex:c.prevScrollToColumn,updateScrollOffsetForScrollToIndex:function(){f=a._getScrollLeftForScrollToColumnStateUpdate(b,e)}}),$({cellCount:c.prevRowCount,cellSize:"number"==typeof c.prevRowHeight?c.prevRowHeight:null,computeMetadataCallback:function(){return c.rowSizeAndPositionManager.resetCell(0)},computeMetadataCallbackProps:b,nextCellsCount:b.rowCount,nextCellSize:"number"==typeof b.rowHeight?b.rowHeight:null,nextScrollToIndex:b.scrollToRow,scrollToIndex:c.prevScrollToRow,updateScrollOffsetForScrollToIndex:function(){g=a._getScrollTopForScrollToRowStateUpdate(b,e)}}),c.prevColumnCount=b.columnCount,c.prevColumnWidth=b.columnWidth,c.prevIsScrolling=!0===b.isScrolling,c.prevRowCount=b.rowCount,c.prevRowHeight=b.rowHeight,c.prevScrollToColumn=b.scrollToColumn,c.prevScrollToRow=b.scrollToRow,c.scrollbarSize=b.getScrollbarSize(),void 0===c.scrollbarSize?(c.scrollbarSizeMeasured=!1,c.scrollbarSize=0):c.scrollbarSizeMeasured=!0,d.instanceProps=c,aj({},d,{},f,{},g)}},{key:"_getEstimatedColumnSize",value:function(a){return"number"==typeof a.columnWidth?a.columnWidth:a.estimatedColumnSize}},{key:"_getEstimatedRowSize",value:function(a){return"number"==typeof a.rowHeight?a.rowHeight:a.estimatedRowSize}},{key:"_getScrollToPositionStateUpdate",value:function(e){var d=e.prevState,a=e.scrollLeft,b=e.scrollTop,c={scrollPositionChangeReason:ak.REQUESTED};return("number"==typeof a&&a>=0&&(c.scrollDirectionHorizontal=a>d.scrollLeft?1:-1,c.scrollLeft=a),"number"==typeof b&&b>=0&&(c.scrollDirectionVertical=b>d.scrollTop?1:-1,c.scrollTop=b),"number"==typeof a&&a>=0&&a!==d.scrollLeft||"number"==typeof b&&b>=0&&b!==d.scrollTop)?c:{}}},{key:"_wrapSizeGetter",value:function(a){return"function"==typeof a?a:function(){return a}}},{key:"_getCalculatedScrollLeft",value:function(a,c){var d=a.columnCount,g=a.height,h=a.scrollToAlignment,e=a.scrollToColumn,i=a.width,j=c.scrollLeft,b=c.instanceProps;if(d>0){var f=d-1,k=e<0?f:Math.min(f,e),l=b.rowSizeAndPositionManager.getTotalSize(),m=b.scrollbarSizeMeasured&&l>g?b.scrollbarSize:0;return b.columnSizeAndPositionManager.getUpdatedOffsetForIndex({align:h,containerSize:i-m,currentOffset:j,targetIndex:k})}return 0}},{key:"_getScrollLeftForScrollToColumnStateUpdate",value:function(d,c){var e=c.scrollLeft,b=a._getCalculatedScrollLeft(d,c);return"number"==typeof b&&b>=0&&e!==b?a._getScrollToPositionStateUpdate({prevState:c,scrollLeft:b,scrollTop:-1}):{}}},{key:"_getCalculatedScrollTop",value:function(a,c){var g=a.height,d=a.rowCount,h=a.scrollToAlignment,e=a.scrollToRow,i=a.width,j=c.scrollTop,b=c.instanceProps;if(d>0){var f=d-1,k=e<0?f:Math.min(f,e),l=b.columnSizeAndPositionManager.getTotalSize(),m=b.scrollbarSizeMeasured&&l>i?b.scrollbarSize:0;return b.rowSizeAndPositionManager.getUpdatedOffsetForIndex({align:h,containerSize:g-m,currentOffset:j,targetIndex:k})}return 0}},{key:"_getScrollTopForScrollToRowStateUpdate",value:function(d,c){var e=c.scrollTop,b=a._getCalculatedScrollTop(d,c);return"number"==typeof b&&b>=0&&e!==b?a._getScrollToPositionStateUpdate({prevState:c,scrollLeft:-1,scrollTop:b}):{}}}]),a}(f.PureComponent),(0,d.Z)(h,"propTypes",null),i);(0,d.Z)(g,"defaultProps",{"aria-label":"grid","aria-readonly":!0,autoContainerWidth:!1,autoHeight:!1,autoWidth:!1,cellRangeRenderer:function(a){for(var g=a.cellCache,j=a.cellRenderer,k=a.columnSizeAndPositionManager,v=a.columnStartIndex,w=a.columnStopIndex,l=a.deferredMeasurementCache,m=a.horizontalOffsetAdjustment,h=a.isScrolling,x=a.isScrollingOptOut,y=a.parent,n=a.rowSizeAndPositionManager,z=a.rowStartIndex,A=a.rowStopIndex,i=a.styleCache,o=a.verticalOffsetAdjustment,p=a.visibleColumnIndices,q=a.visibleRowIndices,r=[],B=k.areOffsetsAdjusted()||n.areOffsetsAdjusted(),C=!h&&!B,b=z;b<=A;b++)for(var s=n.getSizeAndPositionOfCell(b),c=v;c<=w;c++){var t=k.getSizeAndPositionOfCell(c),D=c>=p.start&&c<=p.stop&&b>=q.start&&b<=q.stop,d="".concat(b,"-").concat(c),e=void 0;C&&i[d]?e=i[d]:l&&!l.has(b,c)?e={height:"auto",left:0,position:"absolute",top:0,width:"auto"}:(e={height:s.size,left:t.offset+m,position:"absolute",top:s.offset+o,width:t.size},i[d]=e);var u={columnIndex:c,isScrolling:h,isVisible:D,key:d,parent:y,rowIndex:b,style:e},f=void 0;(x||h)&&!m&&!o?(g[d]||(g[d]=j(u)),f=g[d]):f=j(u),null!=f&& !1!==f&&r.push(f)}return r},containerRole:"rowgroup",containerStyle:{},estimatedColumnSize:100,estimatedRowSize:30,getScrollbarSize:function(b){if((!z&&0!==z||b)&&ad){var a=document.createElement("div");a.style.position="absolute",a.style.top="-9999px",a.style.width="50px",a.style.height="50px",a.style.overflow="scroll",document.body.appendChild(a),z=a.offsetWidth-a.clientWidth,document.body.removeChild(a)}return z},noContentRenderer:function(){return null},onScroll:function(){},onScrollbarPresenceChange:function(){},onSectionRendered:function(){},overscanColumnCount:0,overscanIndicesGetter:function(a){var b=a.cellCount,c=a.overscanCellsCount,f=a.scrollDirection,d=a.startIndex,e=a.stopIndex;return 1===f?{overscanStartIndex:Math.max(0,d),overscanStopIndex:Math.min(b-1,e+c)}:{overscanStartIndex:Math.max(0,d-c),overscanStopIndex:Math.min(b-1,e)}},overscanRowCount:10,role:"grid",scrollingResetTimeInterval:150,scrollToAlignment:"auto",scrollToColumn:-1,scrollToRow:-1,style:{},tabIndex:0,isScrollingOptOut:!1}),(0,p.polyfill)(g);var al=g,s=(k=j=function(b){function a(){(0,R.Z)(this,a);for(var e,b,f=arguments.length,g=new Array(f),c=0;c<f;c++)g[c]=arguments[c];return b=V(this,(e=(0,W.Z)(a)).call.apply(e,[this].concat(g))),(0,d.Z)((0,U.Z)(b),"Grid",void 0),(0,d.Z)((0,U.Z)(b),"_cellRenderer",function(a){var e=a.parent,f=a.rowIndex,c=a.style,g=a.isScrolling,h=a.isVisible,i=a.key,j=b.props.rowRenderer,d=Object.getOwnPropertyDescriptor(c,"width");return d&&d.writable&&(c.width="100%"),j({index:f,style:c,isScrolling:g,isVisible:h,key:i,parent:e})}),(0,d.Z)((0,U.Z)(b),"_setRef",function(a){b.Grid=a}),(0,d.Z)((0,U.Z)(b),"_onScroll",function(a){var c=a.clientHeight,d=a.scrollHeight,e=a.scrollTop,f=b.props.onScroll;f({clientHeight:c,scrollHeight:d,scrollTop:e})}),(0,d.Z)((0,U.Z)(b),"_onSectionRendered",function(a){var c=a.rowOverscanStartIndex,d=a.rowOverscanStopIndex,e=a.rowStartIndex,f=a.rowStopIndex,g=b.props.onRowsRendered;g({overscanStartIndex:c,overscanStopIndex:d,startIndex:e,stopIndex:f})}),b}return(0,X.Z)(a,b),(0,S.Z)(a,[{key:"forceUpdateGrid",value:function(){this.Grid&&this.Grid.forceUpdate()}},{key:"getOffsetForRow",value:function(a){var b=a.alignment,c=a.index;return this.Grid?this.Grid.getOffsetForCell({alignment:b,rowIndex:c,columnIndex:0}).scrollTop:0}},{key:"invalidateCellSizeAfterRender",value:function(a){var b=a.columnIndex,c=a.rowIndex;this.Grid&&this.Grid.invalidateCellSizeAfterRender({rowIndex:c,columnIndex:b})}},{key:"measureAllRows",value:function(){this.Grid&&this.Grid.measureAllCells()}},{key:"recomputeGridSize",value:function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{},b=a.columnIndex,c=a.rowIndex;this.Grid&&this.Grid.recomputeGridSize({rowIndex:void 0===c?0:c,columnIndex:void 0===b?0:b})}},{key:"recomputeRowHeights",value:function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.recomputeGridSize({rowIndex:a,columnIndex:0})}},{key:"scrollToPosition",value:function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.scrollToPosition({scrollTop:a})}},{key:"scrollToRow",value:function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.scrollToCell({columnIndex:0,rowIndex:a})}},{key:"render",value:function(){var a=this.props,b=a.className,c=a.noRowsRenderer,d=a.scrollToIndex,e=a.width,g=Z("ReactVirtualized__List",b);return f.createElement(al,(0,A.Z)({},this.props,{autoContainerWidth:!0,cellRenderer:this._cellRenderer,className:g,columnWidth:e,columnCount:1,noContentRenderer:c,onScroll:this._onScroll,onSectionRendered:this._onSectionRendered,ref:this._setRef,scrollToRow:d}))}}]),a}(f.PureComponent),(0,d.Z)(j,"propTypes",null),k);(0,d.Z)(s,"defaultProps",{autoHeight:!1,estimatedRowSize:30,onScroll:function(){},noRowsRenderer:function(){return null},onRowsRendered:function(){},overscanIndicesGetter:function(a){var c=a.cellCount,b=a.overscanCellsCount,f=a.scrollDirection,d=a.startIndex,e=a.stopIndex;return(b=Math.max(1,b),1===f)?{overscanStartIndex:Math.max(0,d-1),overscanStopIndex:Math.min(c-1,e+b)}:{overscanStartIndex:Math.max(0,d-b),overscanStopIndex:Math.min(c-1,e+1)}},overscanRowCount:10,scrollToAlignment:"auto",scrollToIndex:-1,style:{}});var t=(m=l=function(b){function a(){(0,R.Z)(this,a);for(var e,b,f=arguments.length,g=new Array(f),c=0;c<f;c++)g[c]=arguments[c];return b=V(this,(e=(0,W.Z)(a)).call.apply(e,[this].concat(g))),(0,d.Z)((0,U.Z)(b),"_child",void 0),(0,d.Z)((0,U.Z)(b),"_measure",function(){var a=b.props,e=a.cache,g=a.columnIndex,c=void 0===g?0:g,f=a.parent,h=a.rowIndex,d=void 0===h?b.props.index||0:h,i=b._getCellMeasurements(),j=i.height,k=i.width;(j!==e.getHeight(d,c)||k!==e.getWidth(d,c))&&(e.set(d,c,k,j),f&&"function"==typeof f.recomputeGridSize&&f.recomputeGridSize({columnIndex:c,rowIndex:d}))}),(0,d.Z)((0,U.Z)(b),"_registerChild",function(a){!a||a instanceof Element||console.warn("CellMeasurer registerChild expects to be passed Element or null"),b._child=a,a&&b._maybeMeasureCell()}),b}return(0,X.Z)(a,b),(0,S.Z)(a,[{key:"componentDidMount",value:function(){this._maybeMeasureCell()}},{key:"componentDidUpdate",value:function(){this._maybeMeasureCell()}},{key:"render",value:function(){var a=this.props.children;return"function"==typeof a?a({measure:this._measure,registerChild:this._registerChild}):a}},{key:"_getCellMeasurements",value:function(){var b=this.props.cache,a=this._child||(0,H.findDOMNode)(this);if(!a||!a.ownerDocument||!a.ownerDocument.defaultView||!(a instanceof a.ownerDocument.defaultView.HTMLElement))return{height:0,width:0};var c=a.style.width,d=a.style.height;b.hasFixedWidth()||(a.style.width="auto"),b.hasFixedHeight()||(a.style.height="auto");var e=Math.ceil(a.offsetHeight),f=Math.ceil(a.offsetWidth);return c&&(a.style.width=c),d&&(a.style.height=d),{height:e,width:f}}},{key:"_maybeMeasureCell",value:function(){var a=this.props,e=a.cache,f=a.columnIndex,b=void 0===f?0:f,c=a.parent,g=a.rowIndex,d=void 0===g?this.props.index||0:g;if(!e.has(d,b)){var h=this._getCellMeasurements(),i=h.height,j=h.width;e.set(d,b,j,i),c&&"function"==typeof c.invalidateCellSizeAfterRender&&c.invalidateCellSizeAfterRender({columnIndex:b,rowIndex:d})}}}]),a}(f.PureComponent),(0,d.Z)(l,"propTypes",null),m);(0,d.Z)(t,"__internalCellMeasurerFlag",!1);var am=function(){function a(){var k=this,b=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{};(0,R.Z)(this,a),(0,d.Z)(this,"_cellHeightCache",{}),(0,d.Z)(this,"_cellWidthCache",{}),(0,d.Z)(this,"_columnWidthCache",{}),(0,d.Z)(this,"_rowHeightCache",{}),(0,d.Z)(this,"_defaultHeight",void 0),(0,d.Z)(this,"_defaultWidth",void 0),(0,d.Z)(this,"_minHeight",void 0),(0,d.Z)(this,"_minWidth",void 0),(0,d.Z)(this,"_keyMapper",void 0),(0,d.Z)(this,"_hasFixedHeight",void 0),(0,d.Z)(this,"_hasFixedWidth",void 0),(0,d.Z)(this,"_columnCount",0),(0,d.Z)(this,"_rowCount",0),(0,d.Z)(this,"columnWidth",function(b){var c=b.index,a=k._keyMapper(0,c);return void 0!==k._columnWidthCache[a]?k._columnWidthCache[a]:k._defaultWidth}),(0,d.Z)(this,"rowHeight",function(b){var c=b.index,a=k._keyMapper(c,0);return void 0!==k._rowHeightCache[a]?k._rowHeightCache[a]:k._defaultHeight});var c=b.defaultHeight,e=b.defaultWidth,f=b.fixedHeight,g=b.fixedWidth,h=b.keyMapper,i=b.minHeight,j=b.minWidth;this._hasFixedHeight=!0===f,this._hasFixedWidth=!0===g,this._minHeight=i||0,this._minWidth=j||0,this._keyMapper=h||an,this._defaultHeight=Math.max(this._minHeight,"number"==typeof c?c:30),this._defaultWidth=Math.max(this._minWidth,"number"==typeof e?e:100)}return(0,S.Z)(a,[{key:"clear",value:function(a){var b=arguments.length>1&& void 0!==arguments[1]?arguments[1]:0,c=this._keyMapper(a,b);delete this._cellHeightCache[c],delete this._cellWidthCache[c],this._updateCachedColumnAndRowSizes(a,b)}},{key:"clearAll",value:function(){this._cellHeightCache={},this._cellWidthCache={},this._columnWidthCache={},this._rowHeightCache={},this._rowCount=0,this._columnCount=0}},{key:"hasFixedHeight",value:function(){return this._hasFixedHeight}},{key:"hasFixedWidth",value:function(){return this._hasFixedWidth}},{key:"getHeight",value:function(b){var c=arguments.length>1&& void 0!==arguments[1]?arguments[1]:0;if(this._hasFixedHeight)return this._defaultHeight;var a=this._keyMapper(b,c);return void 0!==this._cellHeightCache[a]?Math.max(this._minHeight,this._cellHeightCache[a]):this._defaultHeight}},{key:"getWidth",value:function(b){var c=arguments.length>1&& void 0!==arguments[1]?arguments[1]:0;if(this._hasFixedWidth)return this._defaultWidth;var a=this._keyMapper(b,c);return void 0!==this._cellWidthCache[a]?Math.max(this._minWidth,this._cellWidthCache[a]):this._defaultWidth}},{key:"has",value:function(a){var b=arguments.length>1&& void 0!==arguments[1]?arguments[1]:0,c=this._keyMapper(a,b);return void 0!==this._cellHeightCache[c]}},{key:"set",value:function(a,b,d,e){var c=this._keyMapper(a,b);b>=this._columnCount&&(this._columnCount=b+1),a>=this._rowCount&&(this._rowCount=a+1),this._cellHeightCache[c]=e,this._cellWidthCache[c]=d,this._updateCachedColumnAndRowSizes(a,b)}},{key:"_updateCachedColumnAndRowSizes",value:function(e,f){if(!this._hasFixedWidth){for(var a=0,b=0;b<this._rowCount;b++)a=Math.max(a,this.getWidth(b,f));var g=this._keyMapper(0,f);this._columnWidthCache[g]=a}if(!this._hasFixedHeight){for(var c=0,d=0;d<this._columnCount;d++)c=Math.max(c,this.getHeight(e,d));var h=this._keyMapper(e,0);this._rowHeightCache[h]=c}}},{key:"defaultHeight",get:function(){return this._defaultHeight}},{key:"defaultWidth",get:function(){return this._defaultWidth}}]),a}();function an(a,b){return"".concat(a,"-").concat(b)}function ao(b,a){return null!=a&&"undefined"!=typeof Symbol&&a[Symbol.hasInstance]?!!a[Symbol.hasInstance](b):b instanceof a}var ap=function(b){var d,g,a=b.children,h=b.maxHeight,k=b.focusedOption,j=(0,f.useRef)(null),l=(0,f.useRef)(null),c=(0,f.useRef)(new am({fixedWidth:!0,defaultHeight:40}));if(ao(a,Array)){var i=a.findIndex(function(a){return(0,J.isEqual)(k,a.props.data)});i>=0&&(g=i)}return(0,f.useLayoutEffect)(function(){var d,b=ao(a,Array)?a.map(function(a){return a.key}):a;(0,J.isEqual)(l.current,b)||(c.current.clearAll(),j.current.recomputeRowHeights(),l.current=b)},[a]),(0,e.jsx)(s,{ref:j,height:0===(d=Object.values(c.current._rowHeightCache).reduce(function(a,b){return a+b},0))?h:Math.min(h,d),deferredMeasurementCache:c.current,rowHeight:c.current.rowHeight,rowRenderer:function(b){var d=b.index,f=b.key,g=b.parent,h=b.style;return(0,e.jsx)(t,{cache:c.current,columnIndex:0,parent:g,rowIndex:d,children:(0,e.jsx)("div",{style:h,children:ao(a,Array)?a[d]:a})},f)},rowCount:a.length||1,width:K.HB,scrollToIndex:g})};function aq(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function ar(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function as(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function at(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function au(a){return(au=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function av(a,b){return(av=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}function aw(a){return function(a){if(Array.isArray(a))return aq(a)}(a)||function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||ax(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ax(a,c){if(a){if("string"==typeof a)return aq(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return aq(a,c)}}var u="undefined"!=typeof Reflect&&"function"==typeof Reflect.metadata&&Reflect.metadata("design:paramtypes",[void 0]),v="undefined"!=typeof Reflect&&"function"==typeof Reflect.metadata&&Reflect.metadata("design:type",Function),w=(0,o.$j)(function(a){var b,c;return{activeFilters:a.controls.filters,colorings:a.metadata.colorings,totalStateCounts:a.tree.totalStateCounts,canFilterByGenotype:!!a.entropy.genomeMap,nodes:a.tree.nodes,nodesSecondTree:null===(b=a.treeToo)|| void 0===b?void 0:b.nodes,totalStateCountsSecondTree:null===(c=a.treeToo)|| void 0===c?void 0:c.totalStateCounts,measurementsFieldsMap:a.measurements.collectionToDisplay.fields,measurementsFiltersMap:a.measurements.collectionToDisplay.filters,measurementsFilters:a.controls.measurementsFilters}}),x=c=w(c=v(c=u((c=function(f){"use strict";!function(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&av(b,a)}(d,f);var g,h,a,b,c,i=(g=d,h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var b,d,a,c,e=au(g);if(h){var f=au(this).constructor;c=Reflect.construct(e,arguments,f)}else c=e.apply(this,arguments);return d=this,(a=c)&&("object"==((b=a)&&"undefined"!=typeof Symbol&&b.constructor===Symbol?"symbol":typeof b)||"function"==typeof a)?a:ar(d)});function d(b){var a;return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,d),at(ar(a=i.call(this,b)),"makeOptions",function(){var i=[],j=Object.keys(a.props.colorings||{}),k=aw(Object.keys(a.props.totalStateCounts)).concat(aw(Object.keys(a.props.totalStateCountsSecondTree))),l=aw(j.filter(function(a){return k.includes(a)})).concat(aw(k.filter(function(a){return!j.includes(a)}))),c=!0,d=!1,e=void 0;try{for(var f,m=function(o,j){var b=j.value,k=new Set(aw((null===(p=a.props.totalStateCounts[b])|| void 0===p?void 0:p.keys())||[]).concat(aw((null===(q=a.props.totalStateCountsSecondTree)|| void 0===q?void 0:null===(r=q[b])|| void 0===r?void 0:r.keys())||[])));a.props.totalStateCounts[b];var l=a.getFilterTitle(b),m=new Set((a.props.activeFilters[b]||[]).filter(function(a){return a.active}).map(function(a){return a.value})),c=!0,f=!1,g=void 0;try{for(var p,q,r,h,d=Array.from(k).sort()[Symbol.iterator]();!(c=(h=d.next()).done);c=!0){var e=h.value;m.has(e)||i.push({label:"".concat(l," \u2192 ").concat(e),value:[b,e]})}}catch(n){f=!0,g=n}finally{try{c||null==d.return||d.return()}finally{if(f)throw g}}},b=l[Symbol.iterator]();!(c=(f=b.next()).done);c=!0)m(b,f)}catch(n){d=!0,e=n}finally{try{c||null==b.return||b.return()}finally{if(d)throw e}}if(a.props.canFilterByGenotype){var g=(0,L.nx)(a.props.nodes),o=a.props.nodesSecondTree?(0,L.nx)(a.props.nodesSecondTree).difference(g):new Set;Array.from(g).concat(Array.from(o)).sort().forEach(function(a){i.push({label:"genotype ".concat(a),value:[K.vD,a]})})}var h=a.props.nodes.filter(function(a){return!a.hasChildren}).map(function(a){return a.name});if(h.forEach(function(a){i.push({label:"sample \u2192 ".concat(a),value:[K.Ac,a]})}),a.props.nodesSecondTree){var p=new Set(h);a.props.nodesSecondTree.filter(function(a){return!a.hasChildren&&!p.has(a.name)}).forEach(function(a){i.push({label:"sample \u2192 ".concat(a.name),value:[K.Ac,a.name]})})}return a.props.measurementsOn&&a.props.measurementsFiltersMap&&a.props.measurementsFieldsMap&&a.props.measurementsFiltersMap.forEach(function(b,c){var d=b.values,e=a.props.measurementsFieldsMap.get(c).title;d.forEach(function(a){i.push({_type:"measurements",label:"(M) ".concat(e," \u2192 ").concat(a),value:[c,a]})})}),i}),at(ar(a),"selectionMade",function(b){return"measurements"===b._type?a.props.dispatch((0,N.kq)(b.value[0],b.value[1],!0)):a.props.dispatch((0,M.Rb)("add",b.value[0],[b.value[1]]))}),at(ar(a),"summariseFilters",function(){return Reflect.ownKeys(a.props.activeFilters).filter(function(b){return a.props.activeFilters[b].length>0}).map(function(b){var c=a.props.activeFilters[b].filter(function(a){return a.active}).length;return{filterName:b,displayName:aA(c,a.getFilterTitle(b)),anyFiltersActive:function(){return a.props.activeFilters[b].filter(function(a){return a.active}).length>0},remove:function(){a.props.dispatch((0,M.Rb)("set",b,[]))},activate:function(){a.props.dispatch((0,M.Rb)("add",b,a.props.activeFilters[b].map(function(a){return a.value})))},inactivate:function(){a.props.dispatch((0,M.Rb)("inactivate",b,a.props.activeFilters[b].map(function(a){return a.value})))}}})}),at(ar(a),"summariseMeasurementsFilters",function(){return void 0===a.props.measurementsFieldsMap?[]:Object.entries(a.props.measurementsFilters).map(function(g){var b,c,d=(c=2,function(a){if(Array.isArray(a))return a}(b=g)||function(b,e){var f,g,a=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=a){var c=[],d=!0,h=!1;try{for(a=a.call(b);!(d=(f=a.next()).done)&&(c.push(f.value),!e||c.length!==e);d=!0);}catch(i){h=!0,g=i}finally{try{d||null==a.return||a.return()}finally{if(h)throw g}}return c}}(b,c)||ax(b,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e=d[0],h=d[1],f=Array.from(h.values()).reduce(function(a,b){return b.active?a+1:a},0);return{field:e,activeFiltersCount:f,badgeTitle:"".concat(f," x ").concat(a.props.measurementsFieldsMap.get(e).title)}})}),a}return a=d,b=[{key:"getStyles",value:function(){return{base:{width:K.HB,marginBottom:0,fontSize:14}}}},{key:"getFilterTitle",value:function(a){return this.props.colorings&&this.props.colorings[a]&&this.props.colorings[a].title||a}},{key:"render",value:function(){var g=this,h=this.makeOptions(),c=(0,J.debounce)(function(b,a){return a(h)},200),d=this.getStyles(),a=this.summariseFilters(),b=this.summariseMeasurementsFilters(),f=String(Object.keys(this.props.totalStateCounts).join(","));return(0,e.jsxs)("div",{style:d.base,children:[(0,e.jsx)(I,{name:"filterQueryBox",placeholder:"Type filter query here...",value:null,defaultOptions:!0,loadOptions:c,filterOption:function(b,a){return a.toLowerCase().split(" ").every(function(a){return b.label.toLowerCase().includes(a)})},isClearable:!1,isSearchable:!0,isMulti:!1,components:{DropdownIndicator:null,MenuList:ap},onChange:this.selectionMade,styles:P.X}),a.length?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Q.om,{spaceAbove:!0,children:"Currently selected filter categories:"}),a.map(function(a){return(0,e.jsx)("div",{style:{display:"inline-block",margin:"2px"},children:(0,e.jsx)(O.ZK,{active:a.anyFiltersActive(),canMakeInactive:!0,id:a.displayName,remove:a.remove,activate:a.activate,inactivate:a.inactivate,onHoverMessage:"Data is currently filtered by ".concat(a.displayName),children:a.displayName})},a.displayName)})]}):null,b.length?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Q.om,{spaceAbove:!0,children:"Currently selected measurements filters:"}),b.map(function(b){var d=b.field,c=b.activeFiltersCount,a=b.badgeTitle;return(0,e.jsx)("div",{style:{display:"inline-block",margin:"2px"},children:(0,e.jsx)(O.ZK,{active:c>0,canMakeInactive:!0,id:a,remove:function(){return g.props.dispatch((0,N.EW)(d))},activate:function(){return g.props.dispatch((0,N.RD)(d,!0))},inactivate:function(){return g.props.dispatch((0,N.RD)(d,!1))},onHoverMessage:"Measurements are currently filtered by ".concat(a),children:a})},a)})]}):null]},f)}}],as(a.prototype,b),c&&as(a,c),d}(f.Component))||c)||c)||c)||c,ay=(0,e.jsxs)(e.Fragment,{children:["Use this box to filter the displayed data based upon filtering criteria.\n    For instance, start typing a country's name to filter the data accordingly.",(0,e.jsx)("br",{}),"Data is filtered by forming a union of selected values within each category, and then taking the intersection between categories (if more than one category is selected).",(0,e.jsx)("br",{}),"Scroll to the bottom of the main page (under the data visualisation) to see an expanded display of filters and available values.",(0,e.jsx)("br",{}),'Filter options prefixed with "(M)" are filters specific to the Measurements panel. They will have no effect on the phylogeny tree or other panels.']}),az=x;function aA(a,b){return b===K.Ac?"".concat(a," x samples"):b===K.vD?"".concat(a," x genotypes"):"".concat(a," x  ").concat(b)}},45261:function(d,c,b){"use strict";b.d(c,{on:function(){return e}});var a=b(28354);b(60822);var e=(0,a.jsxs)(a.Fragment,{children:["This panel displays the evolutionary relationships among samples, illustrating their genetic relatedness and inferred ancestry.",(0,a.jsx)("br",{}),"The exact options available depend on the dataset and specific analysis performed.",(0,a.jsx)("br",{}),"If ",(0,a.jsx)("em",{children:"Branch Length"})," is available, you can choose to display the tree branches in terms of (nucleotide) divergence or (inferred) time. It is often helpful to toggle on ",(0,a.jsx)("em",{children:"confidence intervals"})," to gauge the uncertainty in the reconstruction of internal node dates."]});a.Fragment,a.Fragment,a.Fragment,a.Fragment,a.Fragment,a.Fragment,a.Fragment,a.Fragment},65898:function(l,c,b){"use strict";var m=b(28354);b(60822);var n=b(83505),a=b(37536),d=b(6290);function o(b,a){return a||(a=b.slice(0)),Object.freeze(Object.defineProperties(b,{raw:{value:Object.freeze(a)}}))}function e(){var a=o(["\n  // Same as ToggleBackground, necessary for panel toggles.\n  height: 21px;\n  position: relative;\n"]);return e=function(){return a},a}function f(){var a=o(["\n  position: relative;\n  display: inline-block;\n  width: 35px;\n  height: 21px;\n  input {\n    display: none;\n  }\n\n  input:checked {\n    background-color: ",";\n  }\n"]);return f=function(){return a},a}function g(){var a=o(["\n  margin-left: 40px;\n  margin-top: 4px;\n  width: 200px;\n"]);return g=function(){return a},a}function h(){var a=o(["\n  color: ",";\n  font-size: 10px;\n  position: absolute;\n  left: -12px;\n  top: 6px;\n"]);return h=function(){return a},a}function i(){var a=o(["\n  & {\n    position: absolute;\n    cursor: pointer;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: ",';\n    -webkit-transition: .4s;\n    transition: .4s;\n    border-radius: 12px;\n  }\n  &:before {\n    position: absolute;\n    content: "";\n    height: 15px;\n    width: 15px;\n    left: 4px;\n    bottom: 3px;\n    background-color: #FFF;\n    -webkit-transition: .4s;\n    transition: .4s;\n    border-radius: 50%;\n  }\n  input:checked + &:before {\n    -webkit-transform: translateX(13px);\n    -ms-transform: translateX(13px);\n    transform: translateX(13px);\n  }\n']);return i=function(){return a},a}function j(){var a=o(['\n  & {\n    margin-left: "40px"\n  }\n  &:checked + '," {\n    background-color: ",";\n  }\n  &:focus {\n    box-shadow: 0 0 1px #2196F3;\n  }\n"]);return j=function(){return a},a}var p=a.ZP.div.withConfig({componentId:"sc-6339541f-0"})(e()),q=a.ZP.label.withConfig({componentId:"sc-6339541f-1"})(f(),function(a){return a.theme.unselectedColor}),r=(0,a.ZP)(d.om).withConfig({componentId:"sc-6339541f-2"})(g()),s=a.ZP.span.withConfig({componentId:"sc-6339541f-3"})(h(),function(a){return a.theme.color}),k=a.ZP.div.withConfig({componentId:"sc-6339541f-4"})(i(),function(a){return a.theme.alternateBackground}),t=a.ZP.input.withConfig({componentId:"sc-6339541f-5"})(j(),k,function(a){return a.theme.selectedColor});c.Z=function(a){var e=a.display,b=a.isExperimental,f=a.on,g=a.callback,c=a.label,d=a.style;return e?(0,m.jsxs)(p,{style:void 0===d?{}:d,children:[void 0!==b&&b&&(0,m.jsx)(s,{children:(0,m.jsx)(n.ooh,{})}),(0,m.jsxs)(q,{children:[(0,m.jsx)(t,{type:"checkbox",checked:f,onChange:g}),(0,m.jsx)(k,{}),""===c?null:(0,m.jsx)(r,{children:c})]})]}):null}},62009:function(s,g,a){"use strict";a.d(g,{Z:function(){return aX}});var f,c,t=a(28354),h=a(60822),i=a(69515),d=a.n(i),j=a(46641),u=a(82250),k=a(31884),v=a(8594),w=a(54735),x=a(31382),y=a(89702),z=a(69480),A=a(17587),B=a(82633),C=a(64881),D=Array.prototype.slice;function E(a){return a}function F(a){return"translate("+(a+.5)+",0)"}function G(a){return"translate(0,"+(a+.5)+")"}function H(a){return function(b){return+a(b)}}function I(a){var b=Math.max(0,a.bandwidth()-1)/2;return a.round()&&(b=Math.round(b)),function(c){return+a(c)+b}}function J(){return!this.__axis}function K(b,c){var d=[],e=null,f=null,g=6,h=6,i=3,j=1===b||4===b?-1:1,k=4===b||2===b?"x":"y",l=1===b||3===b?F:G;function a(a){var x=null==e?c.ticks?c.ticks.apply(c,d):c.domain():e,y=null==f?c.tickFormat?c.tickFormat.apply(c,d):E:f,w=Math.max(g,0)+i,u=c.range(),r=+u[0]+.5,s=+u[u.length-1]+.5,z=(c.bandwidth?I:H)(c.copy()),o=a.selection?a.selection():a,n=o.selectAll(".domain").data([null]),m=o.selectAll(".tick").data(x,c).order(),v=m.exit(),t=m.enter().append("g").attr("class","tick"),p=m.select("line"),q=m.select("text");n=n.merge(n.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),m=m.merge(t),p=p.merge(t.append("line").attr("stroke","currentColor").attr(k+"2",j*g)),q=q.merge(t.append("text").attr("fill","currentColor").attr(k,j*w).attr("dy",1===b?"0em":3===b?"0.71em":"0.32em")),a!==o&&(n=n.transition(a),m=m.transition(a),p=p.transition(a),q=q.transition(a),v=v.transition(a).attr("opacity",1e-6).attr("transform",function(a){return isFinite(a=z(a))?l(a):this.getAttribute("transform")}),t.attr("opacity",1e-6).attr("transform",function(b){var a=this.parentNode.__axis;return l(a&&isFinite(a=a(b))?a:z(b))})),v.remove(),n.attr("d",4===b||2==b?h?"M"+j*h+","+r+"H0.5V"+s+"H"+j*h:"M0.5,"+r+"V"+s:h?"M"+r+","+j*h+"V0.5H"+s+"V"+j*h:"M"+r+",0.5H"+s),m.attr("opacity",1).attr("transform",function(a){return l(z(a))}),p.attr(k+"2",j*g),q.attr(k,j*w).text(y),o.filter(J).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===b?"start":4===b?"end":"middle"),o.each(function(){this.__axis=z})}return a.scale=function(b){return arguments.length?(c=b,a):c},a.ticks=function(){return d=D.call(arguments),a},a.tickArguments=function(b){return arguments.length?(d=null==b?[]:D.call(b),a):d.slice()},a.tickValues=function(b){return arguments.length?(e=null==b?null:D.call(b),a):e&&e.slice()},a.tickFormat=function(b){return arguments.length?(f=b,a):f},a.tickSize=function(b){return arguments.length?(g=h=+b,a):g},a.tickSizeInner=function(b){return arguments.length?(g=+b,a):g},a.tickSizeOuter=function(b){return arguments.length?(h=+b,a):h},a.tickPadding=function(b){return arguments.length?(i=+b,a):i},a}function L(a){return K(3,a)}var M=a(29105),N=a(38668);function O(){B.B.preventDefault(),B.B.stopImmediatePropagation()}function P(b){var a=b.document.documentElement,c=(0,u.Z)(b).on("dragstart.drag",O,!0);"onselectstart"in a?c.on("selectstart.drag",O,!0):(a.__noselect=a.style.MozUserSelect,a.style.MozUserSelect="none")}function Q(b,d){var a=b.document.documentElement,c=(0,u.Z)(b).on("dragstart.drag",null);d&&(c.on("click.drag",O,!0),setTimeout(function(){c.on("click.drag",null)},0)),"onselectstart"in a?c.on("selectstart.drag",null):(a.style.MozUserSelect=a.__noselect,delete a.__noselect)}var R=Math.SQRT2;function S(a){return((a=Math.exp(a))+1/a)/2}function T(e,f){var c,g,m=e[0],n=e[1],a=e[2],o=f[0],p=f[1],b=f[2],j=o-m,k=p-n,d=j*j+k*k;if(d<1e-12)g=Math.log(b/a)/R,c=function(b){return[m+b*j,n+b*k,a*Math.exp(R*b*g)]};else{var l=Math.sqrt(d),h=(b*b-a*a+4*d)/(2*a*2*l),i=(b*b-a*a-4*d)/(2*b*2*l),q=Math.log(Math.sqrt(h*h+1)-h);g=(Math.log(Math.sqrt(i*i+1)-i)-q)/R,c=function(h){var b,c,d=h*g,e=S(q),f=a/(2*l)*(e*(((b=Math.exp(2*(b=R*d+q)))-1)/(b+1))-((c=Math.exp(c=q))-1/c)/2);return[m+f*j,n+f*k,a*e/S(R*d+q)]}}return c.duration=1e3*g,c}function U(){for(var b,a=B.B;b=a.sourceEvent;)a=b;return a}function V(a,c){var d=a.ownerSVGElement||a;if(d.createSVGPoint){var b=d.createSVGPoint();return b.x=c.clientX,b.y=c.clientY,[(b=b.matrixTransform(a.getScreenCTM().inverse())).x,b.y]}var e=a.getBoundingClientRect();return[c.clientX-e.left-a.clientLeft,c.clientY-e.top-a.clientTop]}function W(b){var a=U();return a.changedTouches&&(a=a.changedTouches[0]),V(b,a)}function X(e,a,c){arguments.length<3&&(c=a,a=U().changedTouches);for(var d,b=0,f=a?a.length:0;b<f;++b)if((d=a[b]).identifier===c)return V(e,d);return null}function Y(a){return function(){return a}}function Z(a,b,c){this.target=a,this.type=b,this.transform=c}function e(a,b,c){this.k=a,this.x=b,this.y=c}e.prototype={constructor:e,scale:function(a){return 1===a?this:new e(this.k*a,this.x,this.y)},translate:function(a,b){return 0===a&0===b?this:new e(this.k,this.x+this.k*a,this.y+this.k*b)},apply:function(a){return[a[0]*this.k+this.x,a[1]*this.k+this.y]},applyX:function(a){return a*this.k+this.x},applyY:function(a){return a*this.k+this.y},invert:function(a){return[(a[0]-this.x)/this.k,(a[1]-this.y)/this.k]},invertX:function(a){return(a-this.x)/this.k},invertY:function(a){return(a-this.y)/this.k},rescaleX:function(a){return a.copy().domain(a.range().map(this.invertX,this).map(a.invert,a))},rescaleY:function(a){return a.copy().domain(a.range().map(this.invertY,this).map(a.invert,a))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var $=new e(1,0,0);function _(){B.B.stopImmediatePropagation()}function aa(){B.B.preventDefault(),B.B.stopImmediatePropagation()}function ab(){return!B.B.ctrlKey&&!B.B.button}function ac(){var a=this;return a instanceof SVGElement?(a=a.ownerSVGElement||a).hasAttribute("viewBox")?[[(a=a.viewBox.baseVal).x,a.y],[a.x+a.width,a.y+a.height]]:[[0,0],[a.width.baseVal.value,a.height.baseVal.value]]:[[0,0],[a.clientWidth,a.clientHeight]]}function ad(){return this.__zoom||$}function ae(){return-B.B.deltaY*(1===B.B.deltaMode?.05:B.B.deltaMode?1:.002)}function af(){return navigator.maxTouchPoints||"ontouchstart"in this}function ag(a,b,c){var d=a.invertX(b[0][0])-c[0][0],e=a.invertX(b[1][0])-c[1][0],f=a.invertY(b[0][1])-c[0][1],g=a.invertY(b[1][1])-c[1][1];return a.translate(e>d?(d+e)/2:Math.min(0,d)||Math.max(0,e),g>f?(f+g)/2:Math.min(0,f)||Math.max(0,g))}(function(a){for(;!a.__zoom;)if(!(a=a.parentNode))return $;return a.__zoom}).prototype=e.prototype;var ah=a(60205);function ai(a){return function(){return a}}function aj(a,b,c){this.target=a,this.type=b,this.selection=c}function ak(){B.B.stopImmediatePropagation()}function al(){B.B.preventDefault(),B.B.stopImmediatePropagation()}var am={name:"drag"},an={name:"space"},ao={name:"handle"},ap={name:"center"};function aq(a){return[+a[0],+a[1]]}function ar(a){return[aq(a[0]),aq(a[1])]}var as={name:"x",handles:["w","e"].map(az),input:function(a,b){return null==a?null:[[+a[0],b[0][1]],[+a[1],b[1][1]]]},output:function(a){return a&&[a[0][0],a[1][0]]}},at={name:"y",handles:["n","s"].map(az),input:function(a,b){return null==a?null:[[b[0][0],+a[0]],[b[1][0],+a[1]]]},output:function(a){return a&&[a[0][1],a[1][1]]}},au=(["n","w","e","s","nw","ne","sw","se"].map(az),{overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"}),av={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},aw={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},ax={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},ay={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function az(a){return{type:a}}function aA(){return!B.B.ctrlKey&&!B.B.button}function aB(){var a=this.ownerSVGElement||this;return a.hasAttribute("viewBox")?[[(a=a.viewBox.baseVal).x,a.y],[a.x+a.width,a.y+a.height]]:[[0,0],[a.width.baseVal.value,a.height.baseVal.value]]}function aC(){return navigator.maxTouchPoints||"ontouchstart"in this}function aD(a){for(;!a.__brush;)if(!(a=a.parentNode))return;return a.__brush}var l=a(1650),aE=a.n(l),aF=a(49817),aG=a(69856),aH=a(68122);function aI(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function aJ(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function aK(d){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{},b=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(b=b.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),b.forEach(function(a){aJ(d,a,c[a])})}return d}function aL(a,b){return function(a){if(Array.isArray(a))return a}(a)||function(b,e){var f,g,a=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=a){var c=[],d=!0,h=!1;try{for(a=a.call(b);!(d=(f=a.next()).done)&&(c.push(f.value),!e||c.length!==e);d=!0);}catch(i){h=!0,g=i}finally{try{d||null==a.return||a.return()}finally{if(h)throw g}}return c}}(a,b)||aN(a,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function aM(a){return function(a){if(Array.isArray(a))return aI(a)}(a)||function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||aN(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function aN(a,c){if(a){if("string"==typeof a)return aI(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return aI(a,c)}}var b=function(a,b,c){this.svg=(0,u.Z)(a),this.genomeMap=b,this.callbacks=c,this.okToDrawBars=!1};function aO(a,b,c){return(b-5)/a.length>c?a:null}b.prototype.render=function(a){this.props=a,this.selectedCds=a.selectedCds,this.selectedPositions=a.selectedPositions,this.aa="nuc"!==this.selectedCds,this.showCounts=a.showCounts,this.bars=a.bars,this._setSelectedNodes(),this.svg.selectAll("*").remove(),this._calcOffsets(a.width,a.height),this._createGroups(),this._setScales(a.maxYVal),this._setZoomBounds(),this._setZoomCoordinates(a.zoomMin,a.zoomMax),this._drawAxes(),this._setUpZoomBrush(),this._drawNavCds(),this._drawMainCds(),this.okToDrawBars=!0,this._drawBars()},b.prototype.update=function(a){var g=a.selectedCds,c=void 0===g?void 0:g,h=a.selectedPositions,b=void 0===h?void 0:h,i=a.newBars,d=void 0===i?void 0:i,j=a.showCounts,k=void 0===j?void 0:j,l=a.zoomMax,e=void 0===l?void 0:l,m=a.zoomMin,f=void 0===m?void 0:m;if(c&&(this.selectedCds=c,this._setUpZoomBrushWrapping(),this.aa="nuc"!==this.selectedCds,this._setZoomBounds()),d|| void 0!==b){var n=this;void 0!==k&&(this.showCounts=k),d&&(this.bars=d[0],this._updateOffsets(),this._updateMainScaleAndAxis(d[1]),this._drawNavCds()),void 0!==b&&(this.selectedPositions=b),(c|| void 0!==b)&&this._setZoomCoordinates(f,e,!!c),this._groups.navBrush.call(this.brush.move,function(){return n.zoomCoordinates.map(n.scales.xNav)}),void 0!==b&&(this._clearSelectedBars(),this._setSelectedNodes(),this._highlightSelectedBars())}else if(void 0!==f|| void 0!==e){var o=this;this._setZoomCoordinates(f,e,!1),this._groups.navBrush.call(this.brush.move,function(){return o.zoomCoordinates.map(o.scales.xNav)})}},b.prototype._setZoomBounds=function(){if(this.aa){var a,b,c=this.selectedCds.segments.map(function(a){return a.rangeGenome}).flat();this.zoomBounds=[(a=Math).min.apply(a,aM(c)),(b=Math).max.apply(b,aM(c))]}else this.zoomBounds=[0,this.genomeMap[0].range[1]]},b.prototype._setZoomCoordinates=function(a,b,j){if(j&&this.zoomCoordinates&&(this.zoomCoordinates=void 0),this.selectedCds===aG.BJ){var c=this.scales.xNav.domain();if(null===(k=this.selectedPositions)|| void 0===k?void 0:k.length){var k,f,g,h=(f=Math).min.apply(f,aM(this.selectedPositions)),i=(g=Math).max.apply(g,aM(this.selectedPositions));if(this.zoomCoordinates&&(this.zoomCoordinates[0]!==c[0]||this.zoomCoordinates[1]!==c[1])&&h>this.zoomCoordinates[0]&&i<this.zoomCoordinates[1])return;var e=Math.floor(.05*c[1]);e>1e3&&(e=1e3),this.zoomCoordinates=[h-e,i+e]}else this.zoomCoordinates=c;(a||b)&&(a&&(this.zoomCoordinates[0]=a),b&&(this.zoomCoordinates[1]=b),this.zoomCoordinates[0]>=this.zoomCoordinates[1]&&(a&&(this.zoomCoordinates=[a,c[1]]),b&&(this.zoomCoordinates=[c[0],b]))),this.zoomCoordinates[0]<c[0]&&(this.zoomCoordinates[0]=c[0]),this.zoomCoordinates[1]>c[1]&&(this.zoomCoordinates[1]=c[1])}else{var d=this.selectedCds.segments;this.selectedCds.isWrapping?("+"===this.selectedCds.strand?this.zoomCoordinates=[d[d.length-1].rangeGenome[1],d[0].rangeGenome[0]]:this.zoomCoordinates=[d[0].rangeGenome[1],d[d.length-1].rangeGenome[0]],a&&a<this.zoomCoordinates[0]&&(this.zoomCoordinates[0]=a),b&&b>this.zoomCoordinates[0]&&(this.zoomCoordinates[1]=b)):(this.zoomCoordinates=aM(this.zoomBounds),a&&a>this.zoomCoordinates[0]&&a<this.zoomCoordinates[1]&&(this.zoomCoordinates[0]=a),b&&b>this.zoomCoordinates[0]&&b<this.zoomCoordinates[1]&&(this.zoomCoordinates[1]=b))}},b.prototype._setSelectedNodes=function(){if(this.selectedNodes=[],this.selectedPositions.length){if(this.aa){var a=!0,g=!1,h=void 0;try{for(var i,b=this.bars[Symbol.iterator]();!(a=(i=b.next()).done);a=!0){var j=i.value,c=!0,k=!1,l=void 0;try{for(var m,d=this.selectedPositions[Symbol.iterator]();!(c=(m=d.next()).done);c=!0){var r=m.value;j.codon===r&&this.selectedNodes.push(j)}}catch(s){k=!0,l=s}finally{try{c||null==d.return||d.return()}finally{if(k)throw l}}}}catch(t){g=!0,h=t}finally{try{a||null==b.return||b.return()}finally{if(g)throw h}}}else{var e=!0,n=!1,o=void 0;try{for(var p,f=this.bars[Symbol.iterator]();!(e=(p=f.next()).done);e=!0){var q=p.value;-1!==this.selectedPositions.indexOf(q.x)&&this.selectedNodes.push(q)}}catch(u){n=!0,o=u}finally{try{e||null==f.return||f.return()}finally{if(n)throw o}}}}},b.prototype._drawMainCds=function(){var e=this;this._groups.mainCds.selectAll("*").remove();var a=aL(this.scales.xMain.domain(),2),c=a[0],d=a[1];if(this.selectedCds!==aG.BJ){var f=this;this._groups.mainCds.selectAll(".cds").data(this._cdsSegments({selected:!0})).enter().append("rect").attr("class","gene").attr("x",function(a){return f.scales.xMain(Math.max(a.rangeLocal[0]-.5,c))}).attr("y",0).attr("width",function(a){return f.scales.xMain(Math.min(a.rangeLocal[1]+.5,d))-f.scales.xMain(Math.max(a.rangeLocal[0]-.5,c))}).attr("height",this.offsets.mainCdsRectHeight).style("fill",this.selectedCds.color).style("stroke","#fff").style("stroke-width",2).style("opacity",1).on("mouseover",function(a){f.callbacks.onHover({d3event:B.B,tooltip:f._cdsTooltip(a)})}).on("mouseout",function(a){f.callbacks.onLeave(a)}),this._groups.mainCds.append("text").attr("x",function(){var a=f.scales.xMain(Math.max(1,c));return a+(f.scales.xMain(Math.min(f.selectedCds.length,d))-a)/2}).attr("y",1).attr("pointer-events","none").attr("text-anchor","middle").attr("dominant-baseline","hanging").style("fill","white").style("font-size","".concat(this.offsets.mainCdsRectHeight-2,"px")).text(function(){return f.selectedCds.name});return}var b=this._cdsSegments({range:[c,d]}).map(function(a){var f=[e.scales.xMain(Math.max(a.rangeGenome[0]-.5,c)),e.scales.xMain(Math.min(a.rangeGenome[1]+.5,d))],b=(a.cds.stackPosition-1)*e.offsets.mainCdsJitter,g="+"===a.cds.strand?e.offsets.mainCdsPositiveDelta-b-e.offsets.mainCdsRectHeight:e.offsets.mainCdsNegativeDelta+b;return aK({rangePx:f,yPx:g},a)});this._groups.mainCds.selectAll(".cds").data(b).enter().append("path").attr("class","gene").attr("d",function(a){return function(b,g){var f=g.mainCdsRectHeight,a=Math.floor(b.rangePx[1]-b.rangePx[0]),d=Math.round(b.rangePx[0]);if(a<20)return"M ".concat(d,",").concat(b.yPx," h ").concat(a," v ").concat(f," h -").concat(a," Z");var c=Math.floor(Math.min(a/4,10));a-=c;var e=f/2;return"+"===b.cds.strand?"M ".concat(d,",").concat(b.yPx," h ").concat(a," l ").concat(c,",").concat(e," l -").concat(c,",").concat(e," h -").concat(a," Z"):(d=Math.round(b.rangePx[1]),"M ".concat(d,",").concat(b.yPx," h -").concat(a," l -").concat(c,",").concat(e," l ").concat(c,",").concat(e," h ").concat(a," Z"))}(a,e.offsets)}).style("fill",function(a){return a.cds.color}).style("opacity",.7).on("mouseover",function(a){e.callbacks.onHover({d3event:B.B,tooltip:e._cdsTooltip(a)})}).on("mouseout",this.callbacks.onLeave).on("click",this.callbacks.onCdsClick).style("cursor","pointer"),this._groups.mainCds.selectAll(".cdsText").data(b).enter().append("text").attr("x",function(a){return a.rangePx[0]+.5*(a.rangePx[1]-a.rangePx[0])}).attr("y",function(a){return a.yPx+1}).attr("pointer-events","none").attr("text-anchor","middle").attr("dominant-baseline","hanging").style("font-size","".concat(this.offsets.mainCdsRectHeight-2,"px")).style("fill","white").text(function(a){return aO(a.cds.name,a.rangePx[1]-a.rangePx[0],10)})},b.prototype._drawNavCds=function(){var b=this;this._groups.navCds.selectAll("*").remove();var a=this._cdsSegments({}).map(function(a){return aK({rangePx:a.rangeGenome.map(b.scales.xNav),yPx:"+"===a.cds.strand?b.offsets.navCdsPositiveStrandSpace-a.cds.stackPosition*b.offsets.navCdsRectHeight:b.offsets.navCdsNegativeY1Delta+(a.cds.stackPosition-1)*b.offsets.navCdsRectHeight},a)});this._groups.navCds.selectAll(".cdsNav").data(a).enter().append("rect").attr("class","gene").attr("x",function(a){return a.rangePx[0]}).attr("y",function(a){return a.yPx}).attr("width",function(a){return a.rangePx[1]-a.rangePx[0]}).attr("height",this.offsets.navCdsRectHeight).style("fill",function(a){return a.cds.color}).style("fill-opacity",function(a){return b.selectedCds===aG.BJ?1:a.cds.name===b.selectedCds.name?1:.3}).style("stroke","#fff").style("stroke-width",1).on("mouseover",function(a){b.callbacks.onHover({d3event:B.B,tooltip:b._cdsTooltip(a)})}).on("mouseout",function(a){b.callbacks.onLeave(a)}).on("click",this.callbacks.onCdsClick).style("cursor","pointer"),this._groups.navCds.selectAll(".cdsNavText").data(a).enter().append("text").attr("x",function(a){return a.rangePx[0]+.5*(a.rangePx[1]-a.rangePx[0])}).attr("y",function(a){return a.yPx+2}).attr("pointer-events","none").attr("text-anchor","middle").attr("dominant-baseline","hanging").style("font-size","".concat(this.offsets.navCdsRectHeight-2,"px")).style("fill","#fff").text(function(a){return aO(a.cds.name,a.rangePx[1]-a.rangePx[0],7.5)})},b.prototype._cdsSegments=function(a){var b=a.range,e=void 0===b?void 0:b,c=a.selected,f=void 0!==c&&c,g=this,d=[];return this.genomeMap[0].genes.forEach(function(a){var b=g;a.cds.forEach(function(c){f&&c.name!==b.selectedCds.name||c.segments.forEach(function(b){if(!e|| !(b.rangeGenome[1]<e[0])&&!(b.rangeGenome[0]>e[1])){var f=aK({},b);f.cds=c,f.gene=a,d.push(f)}})})}),d},b.prototype._clearSelectedBars=function(){var a=!0,c=!1,d=void 0;try{for(var e,b=this.selectedNodes[Symbol.iterator]();!(a=(e=b.next()).done);a=!0){var f=e.value,g=this.aa?"#cds-".concat(this.selectedCds.name,"-").concat(f.codon):"#nt".concat(f.x);(0,u.Z)(g).style("fill",A.I6)}}catch(h){c=!0,d=h}finally{try{a||null==b.return||b.return()}finally{if(c)throw d}}this.selectedNodes=[]},b.prototype._highlightSelectedBars=function(){var a=!0,c=!1,d=void 0;try{for(var e,b=this.selectedNodes[Symbol.iterator]();!(a=(e=b.next()).done);a=!0){var f=e.value,g=this.aa?"#cds-".concat(this.selectedCds.name,"-").concat(f.codon):"#nt".concat(f.x);(0,u.Z)(g).style("fill","red")}}catch(h){c=!0,d=h}finally{try{a||null==b.return||b.return()}finally{if(c)throw d}}},b.prototype._drawBars=function(){var d=this;if(this.okToDrawBars){this._groups.mainBars.selectAll("*").remove();var b=this.scales.xMain.domain()[0],a=this.scales.xMain(b+1)-this.scales.xMain(b);this.aa&&(a*=3),(a*=.9)<1.5&&(a=1.5);var c=this.aa?function(a){return"cds-".concat(d.selectedCds.name,"-").concat(a.codon)}:function(a){return"nt"+a.x},e=a/2;this._groups.mainBars.selectAll(".bar").data(this.bars).enter().append("rect").attr("class","bar").attr("id",c).attr("x",function(a){return d.aa?d.scales.xMain((a.codon-1)*3+2)-e:d.scales.xMain(a.x)-e}).attr("y",function(a){return d.scales.y(a.y)}).attr("width",a).attr("height",function(a){return d.offsets.heightMainBars-d.scales.y(a.y)}).style("fill",A.I6).on("mouseover",function(a){d.callbacks.onHover({d3event:B.B,tooltip:d.aa?d._mainTooltipAa(a):d._mainTooltipNuc(a)})}).on("mouseout",function(a){d.callbacks.onLeave(a)}).on("click",function(a){d.callbacks.onClick(a)}).style("cursor","pointer"),this._highlightSelectedBars()}},b.prototype._setScales=function(c){this.scales={};var a=this.genomeMap[0].range[1],b=this.selectedCds===aG.BJ?a:this.selectedCds.length;this.scales.xMain=(0,C.Z)().domain([0,b]).range([0,this.offsets.widthNarrow]),this.scales.xNav=(0,C.Z)().domain([0,a]).range([0,this.offsets.width]),this.scales.y=(0,C.Z)().domain([0,c]).range([this.offsets.heightMainBars,0]),this.scales.xMainUpperLimit=b},b.prototype._drawAxes=function(){var a,b=this;this.axes={},this.axes.y=K(4,this.scales.y).ticks(4),this.axes.xMain=L(this.scales.xMain).ticks(16).tickFormat(function(a){return b.aa?Math.ceil(a/3):a}),this.axes.xNav=L(this.scales.xNav).ticks(20,",f"),this.scales.xNav.domain()[1]-this.scales.xNav.domain()[0]>1e6&&this.axes.xNav.tickFormat((0,M.WU)(".1e")),this._groups.mainXAxis.append("text").attr("class","axisLabel").attr("y",7).attr("x",-2).attr("pointer-events","none").attr("text-anchor","end").attr("dominant-baseline","hanging").style("fill",A.I6).style("font-size","12px").text("AA pos").style("visibility",this.aa?"visible":"hidden"),this._groups.mainYAxis.call(this.axes.y),this._groups.mainXAxis.call(this.axes.xMain),this._groups.navXAxis.call(this.axes.xNav)},b.prototype._updateMainScaleAndAxis=function(b){var c=this.genomeMap[0].range[1],a=this.selectedCds===aG.BJ?c:this.selectedCds.length;this.scales.xMain.domain()[1]!==a&&(this._groups.mainBars.attr("transform","translate("+this.offsets.x1Narrow+","+this.offsets.mainY1+")"),this._groups.mainCds.attr("transform","translate("+this.offsets.x1Narrow+","+this.offsets.mainCdsY1+")"),this._groups.mainXAxis.attr("transform","translate("+this.offsets.x1Narrow+","+this.offsets.mainAxisY1+")"),this._groups.mainClip.select("#cliprect").attr("width",this.offsets.widthNarrow).attr("height",this.offsets.heightMainBars),this.scales.xMain.domain([0,a]).range([0,this.offsets.widthNarrow]),this.scales.xMainUpperLimit=a,this._groups.mainXAxis.call(this.axes.xMain)),this._groups.mainXAxis.select(".axisLabel").style("visibility",this.aa?"visible":"hidden"),this.scales.y.domain([0,b]).range([this.offsets.heightMainBars,0]),this._groups.mainYAxis.call(this.axes.y)},b.prototype._calcOffsets=function(f,g){var a=this.genomeMap[0].metadata,c=a.strandsObserved.has("+")?13*a.posStrandStackHeight:0,d=a.strandsObserved.has("-")?13*a.negStrandStackHeight:0,b=a.strandsObserved.has("+")?16+(a.posStrandStackHeight-1)*8:0,e=a.strandsObserved.has("-")?16+(a.negStrandStackHeight-1)*8:0;this.offsets={},this.offsets.tinySpace=2,this.offsets.brushHandleHeight=14,this.offsets.navCdsRectHeight=13,this.offsets.navAxisY1=g-0-this.offsets.brushHandleHeight-20-d,this.offsets.navCdsY1=this.offsets.navAxisY1-2-c,this.offsets.navCdsPositiveStrandSpace=c,this.offsets.navCdsNegativeY1Delta=this.offsets.navAxisY1+20-this.offsets.navCdsY1,this.offsets.brushY1=this.offsets.navCdsY1-2,this.offsets.brushHeight=this.offsets.navCdsNegativeY1Delta+d+4,this.offsets.mainAxisY1=this.offsets.brushY1-2-20,this.aa?this.offsets.mainCdsY1=this.offsets.mainAxisY1-2-16:this.offsets.mainCdsY1=this.offsets.mainAxisY1-2-e-2-b,this.offsets.mainCdsNegativeStrandSpace=e,this.offsets.mainCdsPositiveStrandSpace=b,this.offsets.mainCdsPositiveDelta=b,this.offsets.mainCdsNegativeDelta=b+2,this.offsets.mainCdsJitter=8,this.offsets.mainCdsRectHeight=16,this.offsets.mainY1=10,this.offsets.heightMainBars=this.offsets.mainCdsY1-this.offsets.mainY1-2,this.offsets.x1=30,this.offsets.width=f-this.offsets.x1-15,this.offsets.xMainInternalPad=20,this.aa?(this.offsets.x1Narrow=this.offsets.x1+this.offsets.xMainInternalPad,this.offsets.widthNarrow=this.offsets.width-2*this.offsets.xMainInternalPad):(this.offsets.x1Narrow=this.offsets.x1,this.offsets.widthNarrow=this.offsets.width)},b.prototype._updateOffsets=function(){this.aa?(this.offsets.x1Narrow=this.offsets.x1+this.offsets.xMainInternalPad,this.offsets.widthNarrow=this.offsets.width-2*this.offsets.xMainInternalPad,this.offsets.mainCdsY1=this.offsets.mainAxisY1-this.offsets.tinySpace-this.offsets.mainCdsRectHeight):(this.offsets.x1Narrow=this.offsets.x1,this.offsets.widthNarrow=this.offsets.width,this.offsets.mainCdsY1=this.offsets.mainAxisY1-this.offsets.tinySpace-this.offsets.mainCdsNegativeStrandSpace-this.offsets.tinySpace-this.offsets.mainCdsPositiveStrandSpace),this.offsets.heightMainBars=this.offsets.mainCdsY1-this.offsets.mainY1-this.offsets.tinySpace},b.prototype._setUpZoomBrush=function(){var b=this;this.brush=(function(c){var d,e=aB,f=aA,g=aC,h=!0,i=(0,N.Z)("start","brush","end"),j=6;function a(a){var b=a.property("__brush",p).selectAll(".overlay").data([az("overlay")]);b.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",au.overlay).merge(b).each(function(){var a=aD(this).extent;(0,u.Z)(this).attr("x",a[0][0]).attr("y",a[0][1]).attr("width",a[1][0]-a[0][0]).attr("height",a[1][1]-a[0][1])}),a.selectAll(".selection").data([az("selection")]).enter().append("rect").attr("class","selection").attr("cursor",au.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var d=a.selectAll(".handle").data(c.handles,function(a){return a.type});d.exit().remove(),d.enter().append("rect").attr("class",function(a){return"handle handle--"+a.type}).attr("cursor",function(a){return au[a.type]}),a.each(k).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",m).filter(g).on("touchstart.brush",m).on("touchmove.brush",n).on("touchend.brush touchcancel.brush",o).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function k(){var b=(0,u.Z)(this),a=aD(this).selection;a?(b.selectAll(".selection").style("display",null).attr("x",a[0][0]).attr("y",a[0][1]).attr("width",a[1][0]-a[0][0]).attr("height",a[1][1]-a[0][1]),b.selectAll(".handle").style("display",null).attr("x",function(b){return"e"===b.type[b.type.length-1]?a[1][0]-j/2:a[0][0]-j/2}).attr("y",function(b){return"s"===b.type[0]?a[1][1]-j/2:a[0][1]-j/2}).attr("width",function(b){return"n"===b.type||"s"===b.type?a[1][0]-a[0][0]+j:j}).attr("height",function(b){return"e"===b.type||"w"===b.type?a[1][1]-a[0][1]+j:j})):b.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function l(c,e,d){var a=c.__brush.emitter;return!a||d&&a.clean?new b(c,e,d):a}function b(a,b,c){this.that=a,this.args=b,this.state=a.__brush,this.active=0,this.clean=c}function m(){if((!d||B.B.touches)&&f.apply(this,arguments)){var r,g,s,i,t,m,w,n,x,y,J,K,a=this,b=B.B.target.__data__.type,L=(h&&B.B.metaKey?b="overlay":b)==="selection"?am:h&&B.B.altKey?ap:ao,z=c===at?null:ax[b],A=c===as?null:ay[b],o=aD(a),j=o.extent,e=o.selection,C=j[0][0],D=j[0][1],E=j[1][0],F=j[1][1],M=0,N=0,O=z&&A&&h&&B.B.shiftKey,G=B.B.touches?(r=B.B.changedTouches[0].identifier,function(a){return X(a,B.B.touches,r)}):W,p=G(a),R=p,q=l(a,arguments,!0).beforestart();"overlay"===b?(e&&(y=!0),o.selection=e=[[g=c===at?C:p[0],i=c===as?D:p[1]],[m=c===at?E:g,n=c===as?F:i]]):(g=e[0][0],i=e[0][1],m=e[1][0],n=e[1][1]),s=g,t=i,w=m,x=n;var H=(0,u.Z)(a).attr("pointer-events","none"),S=H.selectAll(".overlay").attr("cursor",au[b]);if(B.B.touches)q.moved=T,q.ended=V;else{var I=(0,u.Z)(B.B.view).on("mousemove.brush",T,!0).on("mouseup.brush",V,!0);h&&I.on("keydown.brush",function(){switch(B.B.keyCode){case 16:O=z&&A;break;case 18:L===ao&&(z&&(m=w-M*z,g=s+M*z),A&&(n=x-N*A,i=t+N*A),L=ap,U());break;case 32:(L===ao||L===ap)&&(z<0?m=w-M:z>0&&(g=s-M),A<0?n=x-N:A>0&&(i=t-N),L=an,S.attr("cursor",au.selection),U());break;default:return}al()},!0).on("keyup.brush",function(){switch(B.B.keyCode){case 16:O&&(J=K=O=!1,U());break;case 18:L===ap&&(z<0?m=w:z>0&&(g=s),A<0?n=x:A>0&&(i=t),L=ao,U());break;case 32:L===an&&(B.B.altKey?(z&&(m=w-M*z,g=s+M*z),A&&(n=x-N*A,i=t+N*A),L=ap):(z<0?m=w:z>0&&(g=s),A<0?n=x:A>0&&(i=t),L=ao),S.attr("cursor",au[b]),U());break;default:return}al()},!0),P(B.B.view)}ak(),(0,v.e1)(a),k.call(a),q.start()}function T(){var b=G(a);!O||J||K||(Math.abs(b[0]-R[0])>Math.abs(b[1]-R[1])?K=!0:J=!0),R=b,y=!0,al(),U()}function U(){var c;switch(M=R[0]-p[0],N=R[1]-p[1],L){case an:case am:z&&(M=Math.max(C-g,Math.min(E-m,M)),s=g+M,w=m+M),A&&(N=Math.max(D-i,Math.min(F-n,N)),t=i+N,x=n+N);break;case ao:z<0?(M=Math.max(C-g,Math.min(E-g,M)),s=g+M,w=m):z>0&&(M=Math.max(C-m,Math.min(E-m,M)),s=g,w=m+M),A<0?(N=Math.max(D-i,Math.min(F-i,N)),t=i+N,x=n):A>0&&(N=Math.max(D-n,Math.min(F-n,N)),t=i,x=n+N);break;case ap:z&&(s=Math.max(C,Math.min(E,g-M*z)),w=Math.max(C,Math.min(E,m+M*z))),A&&(t=Math.max(D,Math.min(F,i-N*A)),x=Math.max(D,Math.min(F,n+N*A)))}w<s&&(z*=-1,c=g,g=m,m=c,c=s,s=w,w=c,b in av&&S.attr("cursor",au[b=av[b]])),x<t&&(A*=-1,c=i,i=n,n=c,c=t,t=x,x=c,b in aw&&S.attr("cursor",au[b=aw[b]])),o.selection&&(e=o.selection),J&&(s=e[0][0],w=e[1][0]),K&&(t=e[0][1],x=e[1][1]),(e[0][0]!==s||e[0][1]!==t||e[1][0]!==w||e[1][1]!==x)&&(o.selection=[[s,t],[w,x]],k.call(a),q.brush())}function V(){var b;if(ak(),B.B.touches){if(B.B.touches.length)return;d&&clearTimeout(d),d=setTimeout(function(){d=null},500)}else Q(B.B.view,y),I.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);H.attr("pointer-events","all"),S.attr("cursor",au.overlay),o.selection&&(e=o.selection),((b=e)[0][0]===b[1][0]||b[0][1]===b[1][1])&&(o.selection=null,k.call(a)),q.end()}}function n(){l(this,arguments).moved()}function o(){l(this,arguments).ended()}function p(){var a=this.__brush||{selection:null};return a.extent=ar(e.apply(this,arguments)),a.dim=c,a}return a.move=function(a,b){a.selection?a.on("start.brush",function(){l(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){l(this,arguments).end()}).tween("brush",function(){var a=this,d=a.__brush,h=l(a,arguments),e=d.selection,f=c.input("function"==typeof b?b.apply(this,arguments):b,d.extent),i=(0,ah.Z)(e,f);function g(b){d.selection=1===b&&null===f?null:i(b),k.call(a),h.brush()}return null!==e&&null!==f?g:g(1)}):a.each(function(){var a=this,d=arguments,e=a.__brush,f=c.input("function"==typeof b?b.apply(a,d):b,e.extent),g=l(a,d).beforestart();(0,v.e1)(a),e.selection=null===f?null:f,k.call(a),g.start().brush().end()})},a.clear=function(b){a.move(b,null)},b.prototype={beforestart:function(){return 1== ++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0== --this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(b){(0,B._H)(new aj(a,b,c.output(this.state.selection)),i.apply,i,[b,this.that,this.args])}},a.extent=function(b){return arguments.length?(e="function"==typeof b?b:ai(ar(b)),a):e},a.filter=function(b){return arguments.length?(f="function"==typeof b?b:ai(!!b),a):f},a.touchable=function(b){return arguments.length?(g="function"==typeof b?b:ai(!!b),a):g},a.handleSize=function(b){return arguments.length?(j=+b,a):j},a.keyModifiers=function(b){return arguments.length?(h=!!b,a):h},a.on=function(){var b=i.on.apply(i,arguments);return b===i?a:b},a})(as).extent([[0,0],[this.offsets.width,this.offsets.brushHeight]]).on("brush",function(){b._brushChanged()}).on("end",function(){b._brushChanged(!0),b._dispatchZoomCoordinates()}),this._groups.navBrush.attr("class","brush").attr("stroke-width",0).call(this.brush).call(this.brush.move,function(){return b.zoomCoordinates.map(b.scales.xNav)});var a=this.offsets.brushHandleHeight-4;this.brushHandle=this._groups.navBrush.selectAll(".handle--custom").data([{type:"w"},{type:"e"}]).enter().append("path").attr("class","handle--custom").attr("stroke",A.I6).attr("stroke-width",2).attr("cursor",function(c,a){return b.zoomCoordinates[a]===b.zoomBounds[a]?0===a?"e-resize":"w-resize":"ew-resize"}).attr("d","M0,0 -5,".concat(a," 5,").concat(a," Z")).attr("transform",function(a){return"e"===a.type?"translate(".concat(b.scales.xNav(b.zoomCoordinates[1]),",").concat(b.offsets.brushHeight,")"):"translate(".concat(b.scales.xNav(b.zoomCoordinates[0]),",").concat(b.offsets.brushHeight,")")}),this._setUpZoomBrushWrapping()},b.prototype._setUpZoomBrushWrapping=function(){var a,b=this;null===(a=this._navBrushWrappingSelection)|| void 0===a||a.remove(),this._navBrushWrappingSelection=void 0,this._groups.navBrush.select(".selection").attr("fill-opacity",.3),this.selectedCds!==aG.BJ&& !1!==this.selectedCds.isWrapping&&(this._navBrushWrappingSelection=this._groups.navBrushWrapping.selectAll(".selection-wrapping").data(this.zoomCoordinates).enter().append("rect").attr("class","selection-wrapping").attr("x",function(a,c){return 0===c?0:b.scales.xNav(a)}).attr("y",0).attr("width",function(a,c){return 0===c?b.scales.xNav(a):b.offsets.width-b.scales.xNav(a)}).attr("height",this.offsets.brushHeight).attr("fill","#777").attr("fill-opacity",.3),this._groups.navBrush.select(".selection").attr("fill-opacity",0))},b.prototype._dispatchZoomCoordinates=function(){this.props.dispatch((0,aF.Bm)(this.zoomCoordinates))},b.prototype._brushChanged=function(){var b=arguments.length>0&& void 0!==arguments[0]&&arguments[0],c=(B.B.selection||this.scales.xNav.range()).map(this.scales.xNav.invert,this.scales.xNav);if(this.zoomCoordinates=c.map(Math.round),this.selectedCds===aG.BJ)this.scales.xMain.domain(this.zoomCoordinates);else{var a=aL((0,aH.bM)(this.selectedCds,this.zoomCoordinates),2),d=a[0],e=a[1];if(e)this.scales.xMain.domain(d);else{var f=this;this._setZoomCoordinates(),this._groups.navBrush.call(this.brush.move,function(){return f.zoomCoordinates.map(f.scales.xNav)})}}if(this.axes.xMain=this.axes.xMain.scale(this.scales.xMain),this._groups.mainXAxis.call(this.axes.xMain),this._drawBars(),this._drawMainCds(),this.brushHandle){var g=this;if(this.brushHandle.attr("display",null).attr("transform",function(b,a){return"translate(".concat(g.scales.xNav(g.zoomCoordinates[a]),",").concat(g.offsets.brushHeight,")")}),b){var h=this;this._groups.navBrush.selectAll(".handle--custom").attr("cursor",function(b,a){return h.zoomCoordinates[a]===h.zoomBounds[a]?0===a?"e-resize":"w-resize":"ew-resize"})}}if(this._navBrushWrappingSelection){var i=this;this._navBrushWrappingSelection.attr("x",function(b,a){return 0===a?0:i.scales.xNav(i.zoomCoordinates[1])}).attr("width",function(b,a){return 0===a?i.scales.xNav(i.zoomCoordinates[0]):i.offsets.width-i.scales.xNav(i.zoomCoordinates[1])})}},b.prototype._setUpMousewheelZooming=function(){var c=this,a=[[this.offsets.x1Narrow,this.offsets.mainY1],[this.offsets.widthNarrow,this.offsets.heightMainBars+this.offsets.mainY1]],d=(function(){var c,d,f=ab,g=ac,h=ag,i=ae,j=af,k=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],m=250,n=T,o=(0,N.Z)("start","zoom","end"),p=0;function a(a){a.property("__zoom",ad).on("wheel.zoom",x).on("mousedown.zoom",y).on("dblclick.zoom",z).filter(j).on("touchstart.zoom",A).on("touchmove.zoom",C).on("touchend.zoom touchcancel.zoom",D).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function q(a,b){return(b=Math.max(k[0],Math.min(k[1],b)))===a.k?a:new e(b,a.x,a.y)}function r(a,b,c){var d=b[0]-c[0]*a.k,f=b[1]-c[1]*a.k;return d===a.x&&f===a.y?a:new e(a.k,d,f)}function s(a){return[(+a[0][0]+ +a[1][0])/2,(+a[0][1]+ +a[1][1])/2]}function t(a,b,c){a.on("start.zoom",function(){w(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){w(this,arguments).end()}).tween("zoom",function(){var d=arguments,k=w(this,d),a=g.apply(this,d),f=null==c?s(a):"function"==typeof c?c.apply(this,d):c,h=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),i=this.__zoom,j="function"==typeof b?b.apply(this,d):b,l=n(i.invert(f).concat(h/i.k),j.invert(f).concat(h/j.k));return function(a){if(1===a)a=j;else{var b=l(a),c=h/b[2];a=new e(c,f[0]-b[0]*c,f[1]-b[1]*c)}k.zoom(null,a)}})}function w(a,c,d){return!d&&a.__zooming||new b(a,c)}function b(a,b){this.that=a,this.args=b,this.active=0,this.extent=g.apply(a,b),this.taps=0}function x(){if(f.apply(this,arguments)){var a=w(this,arguments),b=this.__zoom,d=Math.max(k[0],Math.min(k[1],b.k*Math.pow(2,i.apply(this,arguments)))),c=W(this);if(a.wheel)(a.mouse[0][0]!==c[0]||a.mouse[0][1]!==c[1])&&(a.mouse[1]=b.invert(a.mouse[0]=c)),clearTimeout(a.wheel);else{if(b.k===d)return;a.mouse=[c,b.invert(c)],(0,v.e1)(this),a.start()}aa(),a.wheel=setTimeout(function(){a.wheel=null,a.end()},150),a.zoom("mouse",h(r(q(b,d),a.mouse[0],a.mouse[1]),a.extent,l))}}function y(){if(!d&&f.apply(this,arguments)){var a=w(this,arguments,!0),c=(0,u.Z)(B.B.view).on("mousemove.zoom",function(){if(aa(),!a.moved){var b=B.B.clientX-e,c=B.B.clientY-g;a.moved=b*b+c*c>p}a.zoom("mouse",h(r(a.that.__zoom,a.mouse[0]=W(a.that),a.mouse[1]),a.extent,l))},!0).on("mouseup.zoom",function(){c.on("mousemove.zoom mouseup.zoom",null),Q(B.B.view,a.moved),aa(),a.end()},!0),b=W(this),e=B.B.clientX,g=B.B.clientY;P(B.B.view),_(),a.mouse=[b,this.__zoom.invert(b)],(0,v.e1)(this),a.start()}}function z(){if(f.apply(this,arguments)){var b=this.__zoom,c=W(this),e=b.invert(c),i=b.k*(B.B.shiftKey?.5:2),d=h(r(q(b,i),c,e),g.apply(this,arguments),l);aa(),m>0?(0,u.Z)(this).transition().duration(m).call(t,d,c):(0,u.Z)(this).call(a.transform,d)}}function A(){if(f.apply(this,arguments)){var h,d,e,b,g=B.B.touches,i=g.length,a=w(this,arguments,B.B.changedTouches.length===i);for(_(),d=0;d<i;++d)e=g[d],b=[b=X(this,g,e.identifier),this.__zoom.invert(b),e.identifier],a.touch0?a.touch1||a.touch0[2]===b[2]||(a.touch1=b,a.taps=0):(a.touch0=b,h=!0,a.taps=1+ !!c);c&&(c=clearTimeout(c)),h&&(a.taps<2&&(c=setTimeout(function(){c=null},500)),(0,v.e1)(this),a.start())}}function C(){if(this.__zooming){var g,b,d,n,a=w(this,arguments),o=B.B.changedTouches,p=o.length;for(aa(),c&&(c=clearTimeout(c)),a.taps=0,g=0;g<p;++g)b=o[g],d=X(this,o,b.identifier),a.touch0&&a.touch0[2]===b.identifier?a.touch0[0]=d:a.touch1&&a.touch1[2]===b.identifier&&(a.touch1[0]=d);if(b=a.that.__zoom,a.touch1){var i=a.touch0[0],j=a.touch0[1],k=a.touch1[0],m=a.touch1[1],e=(e=k[0]-i[0])*e+(e=k[1]-i[1])*e,f=(f=m[0]-j[0])*f+(f=m[1]-j[1])*f;b=q(b,Math.sqrt(e/f)),d=[(i[0]+k[0])/2,(i[1]+k[1])/2],n=[(j[0]+m[0])/2,(j[1]+m[1])/2]}else{if(!a.touch0)return;d=a.touch0[0],n=a.touch0[1]}a.zoom("touch",h(r(b,d,n),a.extent,l))}}function D(){if(this.__zooming){var b,c,a=w(this,arguments),e=B.B.changedTouches,g=e.length;for(_(),d&&clearTimeout(d),d=setTimeout(function(){d=null},500),b=0;b<g;++b)c=e[b],a.touch0&&a.touch0[2]===c.identifier?delete a.touch0:a.touch1&&a.touch1[2]===c.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),2===a.taps){var f=(0,u.Z)(this).on("dblclick.zoom");f&&f.apply(this,arguments)}}}return a.transform=function(a,c,d){var b=a.selection?a.selection():a;b.property("__zoom",ad),a!==b?t(a,c,d):b.interrupt().each(function(){w(this,arguments).start().zoom(null,"function"==typeof c?c.apply(this,arguments):c).end()})},a.scaleBy=function(b,d,c){a.scaleTo(b,function(){var a=this.__zoom.k,b="function"==typeof d?d.apply(this,arguments):d;return a*b},c)},a.scaleTo=function(b,d,c){a.transform(b,function(){var a=g.apply(this,arguments),b=this.__zoom,e=null==c?s(a):"function"==typeof c?c.apply(this,arguments):c,f=b.invert(e),i="function"==typeof d?d.apply(this,arguments):d;return h(r(q(b,i),e,f),a,l)},c)},a.translateBy=function(b,c,d){a.transform(b,function(){return h(this.__zoom.translate("function"==typeof c?c.apply(this,arguments):c,"function"==typeof d?d.apply(this,arguments):d),g.apply(this,arguments),l)})},a.translateTo=function(b,d,e,c){a.transform(b,function(){var a=g.apply(this,arguments),f=this.__zoom,b=null==c?s(a):"function"==typeof c?c.apply(this,arguments):c;return h($.translate(b[0],b[1]).scale(f.k).translate("function"==typeof d?-d.apply(this,arguments):-d,"function"==typeof e?-e.apply(this,arguments):-e),a,l)},c)},b.prototype={start:function(){return 1== ++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(b,a){return this.mouse&&"mouse"!==b&&(this.mouse[1]=a.invert(this.mouse[0])),this.touch0&&"touch"!==b&&(this.touch0[1]=a.invert(this.touch0[0])),this.touch1&&"touch"!==b&&(this.touch1[1]=a.invert(this.touch1[0])),this.that.__zoom=a,this.emit("zoom"),this},end:function(){return 0== --this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(b){(0,B._H)(new Z(a,b,this.that.__zoom),o.apply,o,[b,this.that,this.args])}},a.wheelDelta=function(b){return arguments.length?(i="function"==typeof b?b:Y(+b),a):i},a.filter=function(b){return arguments.length?(f="function"==typeof b?b:Y(!!b),a):f},a.touchable=function(b){return arguments.length?(j="function"==typeof b?b:Y(!!b),a):j},a.extent=function(b){return arguments.length?(g="function"==typeof b?b:Y([[+b[0][0],+b[0][1]],[+b[1][0],+b[1][1]]]),a):g},a.scaleExtent=function(b){return arguments.length?(k[0]=+b[0],k[1]=+b[1],a):[k[0],k[1]]},a.translateExtent=function(b){return arguments.length?(l[0][0]=+b[0][0],l[1][0]=+b[1][0],l[0][1]=+b[0][1],l[1][1]=+b[1][1],a):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},a.constrain=function(b){return arguments.length?(h=b,a):h},a.duration=function(b){return arguments.length?(m=+b,a):m},a.interpolate=function(b){return arguments.length?(n=b,a):n},a.on=function(){var b=o.on.apply(o,arguments);return b===o?a:b},a.clickDistance=function(b){return arguments.length?(p=(b=+b)*b,a):Math.sqrt(p)},a})().translateExtent(a).extent(a).on("zoom",function(){var f=c,a=B.B.transform,d=c.zoomCoordinates[1]-c.zoomCoordinates[0],e=(d-d/a.k)/2,b=[Math.max(c.zoomCoordinates[0]+e,c.scales.xNav(0)),Math.min(c.zoomCoordinates[1]-e,c.scales.xNav.domain()[1])];b[1]-b[0]<500&&a.k>1||(c.zoomCoordinates=b,a.rescaleX(c.scales.xMain),c._groups.navBrush.call(c.brush.move,function(){return f.zoomCoordinates.map(f.scales.xNav)}))}),b=["option","shift"];aE().bind(b,function(){c._groups.keyPressOverlay=c.svg.append("rect").attr("class","overlay").attr("text","zoom").attr("transform","translate("+c.offsets.x1Narrow+","+c.offsets.mainY1+")").attr("width",c.offsets.widthNarrow).attr("height",c.offsets.navCdsY1-c.offsets.mainY1).call(d).on("wheel",function(){B.B.preventDefault()})},"keydown"),aE().bind(b,function(){c._groups.keyPressOverlay&&c._groups.keyPressOverlay.remove()},"keyup")},b.prototype._createGroups=function(){this._groups={},this._groups.mainBars=this.svg.append("g").attr("id","mainBars").attr("clip-path","url(#clip)").attr("transform","translate("+this.offsets.x1Narrow+","+this.offsets.mainY1+")"),this._groups.navBrush=this.svg.append("g").attr("id","navBrush").attr("transform","translate("+this.offsets.x1+","+this.offsets.brushY1+")"),this._groups.navBrushWrapping=this.svg.append("g").attr("id","navBrushWrapping").attr("transform","translate("+this.offsets.x1+","+this.offsets.brushY1+")"),this._groups.navCds=this.svg.append("g").attr("id","navCds").attr("transform","translate("+this.offsets.x1+","+this.offsets.navCdsY1+")"),this._groups.mainCds=this.svg.append("g").attr("id","mainCds").attr("transform","translate("+this.offsets.x1Narrow+","+this.offsets.mainCdsY1+")"),this._groups.mainYAxis=this.svg.append("g").attr("id","entropyYAxis").attr("transform","translate("+this.offsets.x1+","+this.offsets.mainY1+")"),this._groups.mainXAxis=this.svg.append("g").attr("id","mainXAxis").attr("transform","translate("+this.offsets.x1Narrow+","+this.offsets.mainAxisY1+")"),this._groups.navXAxis=this.svg.append("g").attr("id","navXAxis").attr("transform","translate("+this.offsets.x1+","+this.offsets.navAxisY1+")"),this._groups.mainClip=this.svg.append("g").attr("id","mainClip"),this._groups.mainClip.append("clipPath").attr("class","clipPath").attr("id","clip").append("rect").attr("id","cliprect").attr("x",0).attr("y",0).attr("width",this.offsets.widthNarrow).attr("height",this.offsets.heightMainBars)},b.prototype._mainTooltipAa=function(a){return(function(b){var c=(0,aH.ZR)(this.genomeMap,this.selectedCds.name);if(!c)return console.error("CDS ".concat(this.selectedCds.name," not found in genomeMap (i.e. JSON annotations)")),null;var d=(0,aH.le)(c,a.codon),e=d.frame,f=d.nucCoordinates;return(0,t.jsxs)("div",{className:"tooltip",style:A.fu.tooltip,children:[(0,t.jsx)("div",{children:b("Codon {{codon}} in protein {{protein}}",{codon:a.codon,protein:this.selectedCds.name})}),(0,t.jsx)("p",{}),(0,t.jsx)("div",{children:b("Nuc positions {{positions}}",{positions:f.join(", ")})}),(0,t.jsx)("p",{}),(0,t.jsxs)("div",{children:["-"===c.strand?"Negative strand":"Positive strand".concat("+"!==c.strand?" (assumed)":""),", ".concat(e)]}),(0,t.jsx)("p",{}),(0,t.jsx)("div",{children:this.showCounts?"".concat(b("Num changes observed"),": ").concat(a.y):"".concat(b("Normalised Shannon entropy"),": ").concat(a.y)}),(0,t.jsx)("div",{style:A.fu.comment,children:b("Click to color tree & map by this genotype")})]})}).bind(this)},b.prototype._mainTooltipNuc=function(a){return(function(b){var d,e=a.x,c=(0,aH.Io)(this.genomeMap,e);return d=c?(0,t.jsxs)("div",{children:["Overlaps with ".concat(c.length," CDS segment").concat(c.length>1?"s":"",":"),(0,t.jsx)("p",{}),(0,t.jsx)("table",{className:"entropy-table",children:(0,t.jsxs)("tbody",{children:[(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{style:{minWidth:"60px"},children:"CDS"}),(0,t.jsx)("td",{children:"Nt Pos (in CDS)"}),(0,t.jsx)("td",{children:"AA Pos"})]},"header"),c.map(function(a){return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:a.cds.name}),(0,t.jsx)("td",{children:a.nucLocal}),(0,t.jsx)("td",{children:a.aaLocal})]},a.cds.name+a.nucLocal)})]})})]}):(0,t.jsx)("div",{children:b("No overlapping CDSs")}),(0,t.jsxs)("div",{className:"tooltip",style:A.fu.tooltip,children:[(0,t.jsx)("div",{children:b("Nucleotide {{nuc}}",{nuc:e})}),(0,t.jsx)("p",{}),d,(0,t.jsx)("p",{}),(0,t.jsx)("div",{children:this.showCounts?"".concat(b("Num changes observed"),": ").concat(a.y):"".concat(b("Normalised Shannon entropy"),": ").concat(a.y)}),(0,t.jsx)("div",{style:A.fu.comment,children:b("Click to color tree & map by this genotype")})]})}).bind(this)},b.prototype._cdsTooltip=function(a){return(function(g){var b,e,f,c,d,h=a.cds.segments.length>1;return(0,t.jsxs)("div",{className:"tooltip entropy",style:A.fu.tooltip,children:[(0,t.jsx)("table",{className:"entropy-table",children:(0,t.jsxs)("tbody",{children:[a.cds.displayName&&(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"Name"}),(0,t.jsx)("td",{children:a.cds.displayName})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"CDS name"}),(0,t.jsx)("td",{children:a.cds.name})]}),a.cds.description&&(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"Description"}),(0,t.jsx)("td",{children:a.cds.description})]}),a.cds.name!==a.gene.name&&(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"Gene name"}),(0,t.jsx)("td",{children:a.gene.name})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"CDS length"}),(0,t.jsx)("td",{children:"".concat(a.cds.length/3," amino acids")})]}),h?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"CDS segment"}),(0,t.jsx)("td",{children:"".concat(a.segmentNumber,"/").concat(a.cds.segments.length)})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"Segment length"}),(0,t.jsx)("td",{children:(c=(f=(e=a.rangeLocal)[1]-e[0]+1)%3,d=String(Math.floor(f/3)),c&&(d+=1===c?" \u2153":" \u2154"),d+" amino acids")})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"Segment coords"}),(0,t.jsx)("td",{children:a.rangeGenome.join(" - ")+" (genome coordinates)"})]})]}):(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"CDS coords"}),(0,t.jsx)("td",{children:a.rangeGenome.join(" - ")+" (genome coordinates)"})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"Strand"}),(0,t.jsx)("td",{children:"+"===a.cds.strand?"Positive":"Negative"})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"Frame"}),(0,t.jsx)("td",{children:"".concat(a.frame," (").concat("+"===a.cds.strand?"F":"R").concat(a.frame,")")})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{style:{minWidth:"100px"},children:"Phase"}),(0,t.jsx)("td",{children:a.phase})]})]})}),(null===(b=this.selectedCds)|| void 0===b?void 0:b.name)!==a.cds.name&&(0,t.jsx)("div",{style:A.fu.comment,children:g("Click to view this CDS in isolation")})]})}).bind(this)};var aP=b,aQ=function(c){var d=c.d3event,e=c.width,f=c.height,g=c.children;if(!d)return null;var b={container:{position:"absolute",maxWidth:500,padding:"10px",borderRadius:10,zIndex:1e3,pointerEvents:"none",fontFamily:A.fu.panel.fontFamily,fontSize:14,lineHeight:1,fontWeight:A.fu.panel.fontWeight,color:A.fu.panel.color,backgroundColor:A.fu.panel.backgroundColor,wordWrap:"break-word",wordBreak:"break-word"}},a={x:d.layerX,y:d.layerY};return a.x<.7*e?b.container.left=a.x:b.container.right=e-a.x,a.y<.5*f?b.container.top=a.y:b.container.bottom=f-a.y,(0,t.jsx)("div",{style:b.container,children:g})},aR=a(57605),aS=a(6290);function aT(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function m(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function aU(a){return(aU=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function aV(d){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{},b=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(b=b.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),b.forEach(function(a){m(d,a,c[a])})}return d}function aW(a,b){return(aW=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}a(94037);var n="undefined"!=typeof Reflect&&"function"==typeof Reflect.metadata&&Reflect.metadata("design:paramtypes",[void 0]),o="undefined"!=typeof Reflect&&"function"==typeof Reflect.metadata&&Reflect.metadata("design:type",Function),p=(0,j.$j)(function(a){return{selectedCds:a.entropy.selectedCds,selectedPositions:a.entropy.selectedPositions,bars:a.entropy.bars,genomeMap:a.entropy.genomeMap,maxYVal:a.entropy.maxYVal,showCounts:a.entropy.showCounts,loaded:a.entropy.loaded,colorBy:a.controls.colorBy,zoomMin:a.controls.zoomMin,zoomMax:a.controls.zoomMax,defaultColorBy:a.controls.defaults.colorBy,panelLayout:a.controls.panelLayout,narrativeMode:a.narrative.display,showOnlyPanels:a.controls.showOnlyPanels}}),q=c=p(c=o(c=n((c=(m(f=function(e){"use strict";(function(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&aW(b,a)})(d,e);var f,g,a,b,c,h=(f=d,g=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var b,d,a,c,e=aU(f);if(g){var h=aU(this).constructor;c=Reflect.construct(e,arguments,h)}else c=e.apply(this,arguments);return d=this,(a=c)&&("object"==((b=a)&&"undefined"!=typeof Symbol&&b.constructor===Symbol?"symbol":typeof b)||"function"==typeof a)?a:function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(d)});function d(b){var a;return function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,d),(a=h.call(this,b)).state={hovered:!1,chart:!1},a}return a=d,b=[{key:"onHover",value:function(a){this.setState({hovered:a})}},{key:"onLeave",value:function(){this.setState({hovered:!1})}},{key:"onClick",value:function(a){if(!this.props.narrativeMode){var b=void 0===a.codon?(0,aR.bP)({positions:[a.x]}):(0,aR.bP)({gene:this.props.selectedCds.name,positions:[a.codon]});this.props.dispatch((0,z.j)(b)),this.setState({hovered:!1})}}},{key:"onCdsClick",value:function(a){this.props.dispatch((0,aF.J8)((0,aH.ZR)(this.props.genomeMap,a.cds.name))),this.setState({hovered:!1})}},{key:"resetLayout",value:function(a){var b=this;if(this.props.narrativeMode||!this.state.chart)return null;var c=this.props.selectedCds===aG.BJ;return(0,t.jsx)("div",{style:aV({},A.ug,a.resetLayout),children:(0,t.jsx)("button",{style:A.fp,onClick:function(){c?b.state.chart.update({zoomMin:b.state.chart.zoomBounds[0],zoomMax:b.state.chart.zoomBounds[1]}):b.props.dispatch((0,aF.J8)(aG.BJ))},children:(0,t.jsxs)("span",{style:a.switchTitle,children:[" ","RESET LAYOUT"," "]})},1)})}},{key:"entropyCountSwitch",value:function(a){var c=this,b=this.props.t;return this.props.narrativeMode?null:(0,t.jsxs)("div",{style:aV({},A.ug,a.entropyCountSwitch),children:[(0,t.jsx)("button",{style:this.props.showCounts?A.fp:A.cq,onClick:function(){return c.props.dispatch((0,aF.wC)(!1))},children:(0,t.jsxs)("span",{style:a.switchTitle,children:[" ",b("entropy")," "]})},1),(0,t.jsx)("button",{style:this.props.showCounts?A.cq:A.fp,onClick:function(){return c.props.dispatch((0,aF.wC)(!0))},children:(0,t.jsxs)("span",{style:a.switchTitle,children:[" ",b("events")," "]})},2)]})}},{key:"setUp",value:function(a){var b=new aP(this.d3entropy,a.genomeMap,{onHover:this.onHover.bind(this),onLeave:this.onLeave.bind(this),onClick:this.onClick.bind(this),onCdsClick:this.onCdsClick.bind(this)});b.render(a),a.narrativeMode&&(0,u.Z)(this.d3entropy).selectAll(".handle--custom").style("visibility","hidden"),this.setState({chart:b})}},{key:"componentDidMount",value:function(){this.props.loaded&&this.setUp(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(a){if(a.loaded||this.setState({chart:!1}),!this.state.chart){a.loaded&&this.setUp(a);return}if(this.props.width!==a.width||this.props.height!==a.height)this.state.chart.render(a);else{var b={};(this.props.zoomMax!==a.zoomMax||this.props.zoomMin!==a.zoomMin)&&(b.zoomMax=a.zoomMax,b.zoomMin=a.zoomMin),this.props.bars!==a.bars&&(b.newBars=[a.bars,a.maxYVal]),this.props.selectedCds!==a.selectedCds&&(b.selectedCds=a.selectedCds),this.props.showCounts!==a.showCounts&&(b.showCounts=a.showCounts),(0,x.isEqual)(this.props.selectedPositions,a.selectedPositions)||(b.selectedPositions=a.selectedPositions),Object.keys(b).length&&this.state.chart.update(b)}this.props.narrativeMode!==a.narrativeMode&&(a.narrativeMode?(0,u.Z)(this.d3entropy).selectAll(".handle--custom").style("visibility","hidden"):(0,u.Z)(this.d3entropy).selectAll(".handle--custom").style("visibility","visible"))}},{key:"title",value:function(){return this.props.width<500?"Diversity":this.props.selectedCds===aG.BJ?"Nucleotide diversity of genome":"Amino acid diversity of CDS ".concat(this.props.selectedCds.name)}},{key:"render",value:function(){var b,c=this,a={switchContainer:{position:"absolute",marginTop:-5,paddingLeft:(b=this.props.width)-100},switchContainerWide:{position:"absolute",marginTop:-25,paddingLeft:b-185},switchTitle:{margin:5,position:"relative",top:-1},resetLayout:{position:"absolute",right:190,top:0,zIndex:100},entropyCountSwitch:{position:"absolute",right:50,top:0,zIndex:100},helpIcon:{position:"absolute",right:25,top:3,fontSize:"16px",cursor:"help",color:"#888"}};return(0,t.jsxs)(y.Z,{infocard:this.props.showOnlyPanels,title:this.title(),children:[(0,t.jsx)(aQ,{d3event:this.state.hovered.d3event,width:this.props.width,height:this.props.height,children:this.state.hovered?this.state.hovered.tooltip(this.props.t):null}),(0,t.jsx)("svg",{id:"d3entropyParent",style:{pointerEvents:"auto"},width:this.props.width,height:this.props.height,children:(0,t.jsx)("g",{ref:function(a){c.d3entropy=a},id:"d3entropy"})}),this.resetLayout(a),this.entropyCountSwitch(a),(0,t.jsx)("span",{style:a.helpIcon,"data-tip":!0,"data-for":"entropyHelp",children:(0,t.jsx)(w.DAO,{})}),(0,t.jsx)(aS.mi,{place:"left",type:"dark",effect:"solid",id:"entropyHelp",style:{maxWidth:"50vh"},children:(0,t.jsxs)("div",{children:["This panel displays the observed diversity across the current genome or a selected CDS"," (currently you are viewing ".concat(this.props.selectedCds===aG.BJ?"the genome":"CDS ".concat(this.props.selectedCds.name),"). "),(0,t.jsx)("p",{}),"The lower axis shows the genome with +ve strand CDSs above and -ve strand CDSs below and the grey overlay allows zooming in to a region. The upper axis shows either the zoomed in region of the genome or a selected CDS; in the latter case the coordinates represent amino acids.",(0,t.jsx)("p",{}),"Clicking on a CDS will select it and show it on the upper axis.",' Clicking "Reset Layout" will always return you to viewing the entire genome.']})})]})}},{key:"componentWillUnmount",value:function(){}}],aT(a.prototype,b),c&&aT(a,c),d}(h.Component),"propTypes",{dispatch:d().func.isRequired,loaded:d().bool.isRequired,colorBy:d().string.isRequired,defaultColorBy:d().string.isRequired,selectedCds:d().any.isRequired,selectedPositions:d().array.isRequired}),f))||c)||c)||c)||c,r=(0,k.Zh)()(q),aX=r},89702:function(e,b,a){"use strict";var f=a(28354),c=a(60822),g=a(17587);function h(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function i(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function j(a){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function k(d){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{},b=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(b=b.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),b.forEach(function(a){i(d,a,c[a])})}return d}function l(a,b){return(l=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}var d=function(e){"use strict";!function(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&l(b,a)}(d,e);var i,m,a,b,c,n=(i=d,m=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var b,d,a,c,e=j(i);if(m){var f=j(this).constructor;c=Reflect.construct(e,arguments,f)}else c=e.apply(this,arguments);return d=this,(a=c)&&("object"==((b=a)&&"undefined"!=typeof Symbol&&b.constructor===Symbol?"symbol":typeof b)||"function"==typeof a)?a:function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(d)});function d(){return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,d),n.apply(this,arguments)}return a=d,b=[{key:"getStyles",value:function(){return{base:{backgroundColor:"#FFFFFF",display:"inline-block",marginLeft:14,marginRight:0,marginTop:0,marginBottom:10,paddingLeft:6,paddingRight:6,paddingBottom:6,overflow:"hidden",position:"relative"},title:{fontFamily:g.Cc,color:g.I6,fontSize:16,marginLeft:0,marginTop:0,marginBottom:8,fontWeight:500,backgroundColor:"#FFFFFF",borderTop:"thin solid #BBB",minHeight:"15px"}}}},{key:"getStylesInfoCard",value:function(){return{base:{backgroundColor:"#FFFFFF",display:"inline-block",marginLeft:14,marginRight:0,marginTop:0,marginBottom:10,paddingLeft:6,paddingRight:6,paddingBottom:6,overflow:"hidden",position:"relative"},title:{fontFamily:g.Cc,color:"#fff",fontSize:16,marginLeft:0,marginTop:0,marginBottom:8,fontWeight:500,backgroundColor:"#FFFFFF"}}}},{key:"render",value:function(){var a=this.props.infocard?this.getStylesInfoCard():this.getStyles();return(0,f.jsxs)("div",{id:"".concat(this.props.title,"Card"),style:k({},a.base,this.props.style),children:[(0,f.jsx)("div",{id:"CardTitle",style:k({},a.title,this.props.titleStyles),children:this.props.title}),(0,f.jsx)("div",{id:"CardContentContainer",style:{display:"flex",justifyContent:this.props.center?"center":"flex-start"},children:this.props.children})]})}}],h(a.prototype,b),c&&h(a,c),d}(c.Component);b.Z=d},26250:function(m,d,b){"use strict";b.d(d,{ZK:function(){return v},u:function(){return u}});var n=b(28354);b(60822);var a=b(37536),o=b(54735),e=b(57510);function p(b,a){return a||(a=b.slice(0)),Object.freeze(Object.defineProperties(b,{raw:{value:Object.freeze(a)}}))}function f(){var a=p(["\n  color: #5097BA;\n  cursor: pointer;\n  font-weight: 300;\n  padding: 0px 2px 0px 2px;\n"]);return f=function(){return a},a}function g(){var a=p(["\n  display: inline-block;\n  cursor: help;\n  margin: 0px 0px 0px 2px;\n"]);return g=function(){return a},a}function h(){var a=p(["\n  cursor: pointer;\n  color: #5097BA;\n  /* left vertical border */\n  border-width: 0px 0px 0px 1px;\n  border-style: solid;\n  border-color: #BDD8E5; */\n  min-width: 20px;\n  padding: 0px 1px 0px 5px;\n  display: inline-block;\n  text-align: center;\n  &:hover, &:focus {\n    & > svg {\n      color: #0071e6;\n    }\n  }\n  & > svg {\n    transform: translate(-2px, 2px);\n  }\n"]);return h=function(){return a},a}function i(){var a=p(["\n  margin: 1px 2px 1px 2px;\n  padding: 0px 2px 0px 2px;\n  &:hover {\n    text-decoration: underline; \n  }\n"]);return i=function(){return a},a}function j(){var a=p(["\n  background-color: #E9F2F6;\n  border-radius: 2px;\n  border: 1px solid #BDD8E5;\n  border-width: 1;\n  border-radius: 2px;\n  margin: 0px 2px 0px 0px;\n  &:hover {\n    text-decoration: none;\n  }\n"]);return j=function(){return a},a}function k(){var a=p(["\n  background-color: #E9F2F6;\n  ",";\n  display: inline-block;\n  font-size: 14px;\n  border-radius: 2px;\n  border-width: 1px;\n  border-style: solid;\n  border-color: #BDD8E5;\n"]);return k=function(){return a},a}function l(){var a=p(["\n  max-width: 30vh;\n  font-weight: 400;\n  white-space: normal;\n  line-height: 1.2;\n  padding: 4px !important; /* override ReactTooltip's internal styling */\n  & > br {\n    margin-bottom: 10px;\n  }\n"]);return l=function(){return a},a}var c=a.ZP.div.withConfig({componentId:"sc-b817976f-0"})(f()),q=(0,a.ZP)(c).withConfig({componentId:"sc-b817976f-1"})(g()),r=a.ZP.div.withConfig({componentId:"sc-b817976f-2"})(h()),s=((0,a.ZP)(c).withConfig({componentId:"sc-b817976f-3"})(i()),(0,a.ZP)(c).withConfig({componentId:"sc-b817976f-4"})(j()),a.ZP.div.withConfig({componentId:"sc-b817976f-5"})(k(),function(a){return a.striped?"background: repeating-linear-gradient(135deg, #E9F2F6, #E9F2F6 5px, #FFFFFF 5px, #FFFFFF 10px);":""})),t=(0,a.ZP)(e.Z).withConfig({componentId:"sc-b817976f-6"})(l()),u=function(a){var b=a.id,c=a.children;return(0,n.jsx)(t,{place:"bottom",type:"dark",effect:"solid",delayShow:300,id:b,children:c})},v=function(a){var f=a.remove,d=a.canMakeInactive,b=a.active,g=a.activate,h=a.inactivate,i=a.children,c=a.id,e=a.onHoverMessage;return(0,n.jsxs)(s,{striped:d&&!b,children:[(0,n.jsx)(q,{active:!d||b,"data-tip":!0,"data-for":c,children:i}),(0,n.jsx)(u,{id:c,children:d&&!b?"This filter is currently inactive":void 0===e?"The visible data is being filtered by this":e}),d&&(0,n.jsxs)(r,{onClick:b?h:g,role:"button",tabIndex:0,"data-tip":!0,"data-for":c+"active",children:[b?(0,n.jsx)(o.z5B,{}):(0,n.jsx)(o.tjB,{}),(0,n.jsx)(u,{id:c+"active",children:b?"Inactivate this filter":"Re-activate this filter"})]}),(0,n.jsxs)(r,{onClick:f,role:"button",tabIndex:0,children:[(0,n.jsx)(o.Xm5,{"data-tip":!0,"data-for":c+"remove"}),(0,n.jsx)(u,{id:c+"remove",children:"Remove this filter"})]})]})}},71975:function(m,d,a){"use strict";a.d(d,{Z:function(){return I}});var b,c=a(28354),e=a(60822),f=a(46641),g=a(31884),n=a(59894),o=a(82379),p=a(69856),q=a(26250),r=a(44163),s=a(62525),t={country:"countries",authors:"authors"},u=function(a){var c="number"==typeof a?(0,r.hT)(a):a,b=c.split("-");return 3===b.length?"".concat(p.e7[b[1]]," ").concat(b[0]):c};function v(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function w(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function x(a){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function y(a,b){return(y=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}function z(a,b){return function(a){if(Array.isArray(a))return a}(a)||function(b,e){var f,g,a=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=a){var c=[],d=!0,h=!1;try{for(a=a.call(b);!(d=(f=a.next()).done)&&(c.push(f.value),!e||c.length!==e);d=!0);}catch(i){h=!0,g=i}finally{try{d||null==a.return||a.return()}finally{if(h)throw g}}return c}}(a,b)||B(a,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(a){return function(a){if(Array.isArray(a))return v(a)}(a)||function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||B(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(a,c){if(a){if("string"==typeof a)return v(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return v(a,c)}}var C=function(b){var a=b.id;return(0,c.jsxs)("span",{style:{fontSize:"2rem",fontWeight:300,padding:"0px 4px 0px 2px",cursor:"help"},"data-tip":!0,"data-for":a,children:["\u2229",(0,c.jsx)(q.u,{id:a,children:"Groups of filters are combined by intersection"})]})},D=function(){return(0,c.jsx)("span",{style:{fontSize:"1.5rem",padding:"0px 3px 0px 2px"},children:"\u222A"})},E=(0,c.jsx)("span",{style:{fontSize:"2rem",fontWeight:300,padding:"0px 0px 0px 2px"},children:"{"}),F=(0,c.jsx)("span",{style:{fontSize:"2rem",fontWeight:300,padding:"0px 2px"},children:"}"}),G=(0,c.jsx)("span",{style:{fontSize:"1.8rem",fontWeight:300,padding:"0px 2px"},children:"{"}),H=(0,c.jsx)("span",{style:{fontSize:"1.8rem",fontWeight:300,padding:"0px 2px"},children:"}"}),h="undefined"!=typeof Reflect&&"function"==typeof Reflect.metadata&&Reflect.metadata("design:paramtypes",[void 0]),i="undefined"!=typeof Reflect&&"function"==typeof Reflect.metadata&&Reflect.metadata("design:type",Function),j=(0,f.$j)(function(a){var b;return{browserDimensions:a.browserDimensions.browserDimensions,filters:a.controls.filters,animationPlayPauseButton:a.controls.animationPlayPauseButton,metadata:a.metadata,nodes:a.tree.nodes,totalStateCounts:a.tree.totalStateCounts,totalStateCountsSecondTree:null===(b=a.treeToo)|| void 0===b?void 0:b.totalStateCounts,visibility:a.tree.visibility,selectedClade:a.tree.selectedClade,dateMin:a.controls.dateMin,dateMax:a.controls.dateMax,absoluteDateMin:a.controls.absoluteDateMin,absoluteDateMax:a.controls.absoluteDateMax,branchLengthsToDisplay:a.controls.branchLengthsToDisplay,measurementsFilters:a.controls.measurementsFilters,measurementsFields:a.measurements.collectionToDisplay.fields}}),k=b=j(b=i(b=h((b=function(f){"use strict";!function(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&y(b,a)}(e,f);var g,h,a,b,d,i=(g=e,h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var b,d,a,c,e=x(g);if(h){var f=x(this).constructor;c=Reflect.construct(e,arguments,f)}else c=e.apply(this,arguments);return d=this,(a=c)&&("object"==((b=a)&&"undefined"!=typeof Symbol&&b.constructor===Symbol?"symbol":typeof b)||"function"==typeof a)?a:function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(d)});function e(a){return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,e),i.call(this,a)}return a=e,b=[{key:"createIndividualBadge",value:function(a){var f=a.filterName,b=a.item,d=a.label,e=a.onHoverMessage,g=this;return(0,c.jsx)(q.ZK,{id:String(b.value),remove:function(){g.props.dispatch((0,n.Rb)("remove",f,[b.value]))},canMakeInactive:!0,onHoverMessage:e,active:b.active,activate:function(){g.props.dispatch((0,n.Rb)("add",f,[b.value]))},inactivate:function(){g.props.dispatch((0,n.Rb)("inactivate",f,[b.value]))},children:d},b.value)}},{key:"createFilterBadgesForTime",value:function(){var a=this;return[(0,c.jsx)(q.ZK,{id:"timefilter",onHoverMessage:"Filtering to data sampled in this date range",remove:function(){return a.props.dispatch((0,n.ms)({newMin:a.props.absoluteDateMin,newMax:a.props.absoluteDateMax}))},children:"".concat(u(this.props.dateMin)," to ").concat(u(this.props.dateMax))},"timefilter")]}},{key:"createFilterBadges",value:function(b){var a,e=this,c=b===p.Ac?"sample":b,d=this.props.filters[b].length,f=1===d?"Filtering data to this ".concat(c):"Filtering data to these ".concat(d," ").concat(((a=c)in t&&(a=t[a]),"s"!==a.slice(-1).toLowerCase()&&(a+="s"),a=a.replace(/_/g," ")));return this.props.filters[b].sort(function(a,b){return a.value<b.value?-1:a.value>b.value?1:0}).map(function(a){var c="".concat(a.value);if(b!==p.Ac){var h=null!==(k=null===(j=e.props.totalStateCounts[b])|| void 0===j?void 0:j.get(a.value))&& void 0!==k?k:0;if(e.props.totalStateCountsSecondTree&&Reflect.ownKeys(e.props.totalStateCountsSecondTree).length){var j,k,d,g,i=null!==(g=null===(d=e.props.totalStateCountsSecondTree[b])|| void 0===d?void 0:d.get(a.value))&& void 0!==g?g:0;c+=" (L: ".concat(h,", R: ").concat(i,")")}else c+=" (".concat(h,")")}return e.createIndividualBadge({filterName:b,item:a,label:c,onHoverMessage:f})})}},{key:"createFilterBadgesForGenotype",value:function(){var b=this,a=this.props.filters[p.vD],c=new Set(a.filter(function(a){return a.active}).map(function(a){return a.value}));return(0,s.Vv)(a.map(function(a){return a.value})).map(function(a){var l=b,f="nuc"===a[0];if(1===a[2].size){var d=A(a[2])[0],k=f?"Filtering to sequences with nucleotide ".concat(d," at base ").concat(a[1]):"Filtering to sequences with ".concat((0,p.Wv)(d)," at codon ").concat(a[1]," in ").concat(a[0]),g="".concat(a[0]," ").concat(a[1]).concat(d),h={active:c.has(g),value:g};return b.createIndividualBadge({filterName:p.vD,item:h,label:h.value,onHoverMessage:k})}var e=A(a[2]),m=e.map(function(b){return"".concat(a[0]," ").concat(a[1]).concat(b)}),i=e.filter(function(b,a){return c.has(m[a])}),j=function(a){return a.length>1?"".concat(a.slice(0,-1).join(", ")," or ").concat(a[a.length-1]):a[0]},n=f?"Filtering to sequences with nucleotides ".concat(j(i)," at position ").concat(a[1]):"Filtering to sequences with ".concat(j(i.map(function(a){return(0,p.Wv)(a)}))," at codon ").concat(a[1]," in ").concat(a[0]);return e.map(function(e){var b="".concat(a[0]," ").concat(a[1]).concat(e),d={active:c.has(b),value:b};return l.createIndividualBadge({filterName:p.vD,item:d,label:d.value,onHoverMessage:n})})})}},{key:"render",value:function(){var d=this,b=this.props.t,a=[];return(Reflect.ownKeys(this.props.filters).filter(function(a){return d.props.filters[a].length>0}).forEach(function(b){b===p.Ac?a.push({name:"sample",badges:d.createFilterBadges(p.Ac)}):b===p.vD?a.push({name:"genotype",badges:d.createFilterBadgesForGenotype()}):a.push({name:b,badges:d.createFilterBadges(b)})}),this.props.dateMin===this.props.absoluteDateMin&&this.props.dateMax===this.props.absoluteDateMax||a.push({name:"temporal",badges:this.createFilterBadgesForTime()}),a.length||Object.keys(this.props.measurementsFilters).length)?(0,c.jsxs)(c.Fragment,{children:[a.length>0&&(0,c.jsxs)(c.Fragment,{children:[b("Filtered to")+" ",a.map(function(a,b){var d=a.badges.length>1,e=0!==b;return(0,c.jsxs)("span",{style:{fontSize:"2rem",padding:"0px 2px"},children:[e&&(0,c.jsx)(C,{id:"intersect"+b}),d&&E," ",a.badges.map(function(b,d){return Array.isArray(b)?(0,c.jsxs)("span",{children:[G,b.map(function(a,d){return(0,c.jsxs)("span",{children:[a,d!==b.length-1&&(0,c.jsx)(D,{})]},a.props.id)}),H,d!==a.badges.length-1&&", "]},b.map(function(a){return a.props.id}).join("")):(0,c.jsxs)("span",{children:[b,d!==a.badges.length-1&&", "]},b.props.id)}),d&&F]},a.name)}),". "]}),Object.keys(this.props.measurementsFilters).length>0&& void 0!==this.props.measurementsFields&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("br",{}),b("Measurements filtered to")+" ",Object.entries(this.props.measurementsFilters).map(function(e,f){var a=z(e,2),b=a[0],g=a[1],i=d,h=d.props.measurementsFields.get(b).title;return(0,c.jsxs)("span",{children:[E,"".concat(h,": "),A(g).map(function(e,f){var d=z(e,2),a=d[0],j=d[1].active,k=i;return(0,c.jsxs)("span",{style:{fontSize:"2rem",padding:"0px 2px"},children:[(0,c.jsx)(q.ZK,{active:j,canMakeInactive:!0,id:String(a),remove:function(){return k.props.dispatch((0,o.GT)(b,a))},activate:function(){return k.props.dispatch((0,o.kq)(b,a,!0))},inactivate:function(){return k.props.dispatch((0,o.kq)(b,a,!1))},onHoverMessage:"Filtering measurements to this ".concat(h),children:a}),f<g.size-1&&","]},a)}),F,f<Object.keys(d.props.measurementsFilters).length-1&&(0,c.jsx)(C,{})]},b)})]})]}):null}}],w(a.prototype,b),d&&w(a,d),e}(e.Component))||b)||b)||b)||b,l=(0,g.Zh)()(k),I=l},10485:function(A,h,b){"use strict";b.d(h,{Z:function(){return bX}});var d,g=b(46641),c=b(28354),f=b(60822),i=b(31884),B=b(54735),C=b(59894),D=b(89702),E=b(56535),F=b(17587),G=function(a){var j=a.dispatch,g=a.transform,d=a.clipId,b=a.legendRectSize,e=a.legendSpacing,h=a.rectStroke,i=a.rectFill,f=a.label,k=a.value;return(0,c.jsxs)("g",{transform:g,onMouseEnter:function(){j((0,C.VB)({selectedLegendItem:k}))},onMouseLeave:function(){j((0,C.VB)())},children:[(0,c.jsx)("rect",{style:{strokeWidth:2},width:b,height:b,fill:i,stroke:h}),(0,c.jsxs)("text",{x:b+e+5,y:b-e,style:{fontSize:12,fill:F.I6,fontFamily:F.kU},clipPath:d?"url(#".concat(d,")"):void 0,children:[(0,c.jsx)("title",{children:f}),f]})]})},j=b(69856),H=b(57455),I=b(44163),J=b(5859);function K(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function L(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function M(a){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function N(a,b){return(N=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}var k="undefined"!=typeof Reflect&&"function"==typeof Reflect.metadata&&Reflect.metadata("design:paramtypes",[void 0]),l="undefined"!=typeof Reflect&&"function"==typeof Reflect.metadata&&Reflect.metadata("design:type",Function),m=(0,g.$j)(function(a){return{colorBy:a.controls.colorBy,colorings:a.metadata.colorings,colorScale:a.controls.colorScale,legendOpen:a.controls.legendOpen}}),n=d=m(d=l(d=k((d=function(f){"use strict";!function(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&N(b,a)}(e,f);var g,h,a,b,d,i=(g=e,h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var b,d,a,c,e=M(g);if(h){var f=M(this).constructor;c=Reflect.construct(e,arguments,f)}else c=e.apply(this,arguments);return d=this,(a=c)&&("object"==((b=a)&&"undefined"!=typeof Symbol&&b.constructor===Symbol?"symbol":typeof b)||"function"==typeof a)?a:function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(d)});function e(a){return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,e),i.call(this,a)}return a=e,b=[{key:"showLegend",value:function(){return void 0!==this.props.legendOpen?this.props.legendOpen:!(this.props.width<600)&&!(this.props.colorScale.visibleLegendValues.length>32)}},{key:"getSVGHeight",value:function(){return this.showLegend()?19*Math.ceil(this.props.colorScale.visibleLegendValues.length/2)+4+20||100:18}},{key:"getSVGWidth",value:function(){return this.showLegend()?290:this.getTitleWidth()+20}},{key:"getTransformationForLegendItem",value:function(a,b){return"translate(".concat(145*Math.floor(b/a)+10,",").concat(b%a*19,")")}},{key:"getTitleWidth",value:function(){return 15+5.3*(0,H.Jp)(this.props.colorings,this.props.colorBy).length}},{key:"toggleLegend",value:function(){this.props.dispatch({type:J.Nn,value:!this.props.legendOpen})}},{key:"legendTitle",value:function(){return(0,c.jsxs)("g",{id:"Title",children:[(0,c.jsx)("rect",{width:this.getTitleWidth(),height:"12",fill:"rgba(255,255,255,.85)"}),(0,c.jsx)("text",{x:this.getTitleOffset(),y:10,style:{fontSize:12,fill:F.I6,fontFamily:F.Cc,backgroundColor:"#fff"},children:(0,H.Jp)(this.props.colorings,this.props.colorBy)})]})}},{key:"legendChevron",value:function(){var a=this.showLegend()?-180:0,b=this.getArrowOffset();return(0,c.jsx)("g",{id:"Chevron",transform:"translate(".concat(b,",0)"),children:(0,c.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 1792 1792",children:[(0,c.jsx)("rect",{width:"1792",height:"1792",fill:"rgba(255,255,255,.85)"}),(0,c.jsx)("path",{fill:F.I6,style:{transform:"rotate(".concat(a,"deg)"),transformOrigin:"50% 50%",transition:"".concat(j.SM,"ms ease-in-out")},d:"M1683 808l-742 741q-19 19-45 19t-45-19l-742-741q-19-19-19-45.5t19-45.5l166-165q19-19 45-19t45 19l531 531 531-531q19-19 45-19t45 19l166 165q19 19 19 45.5t-19 45.5z"})]})})}},{key:"styleLabelText",value:function(a){if(this.props.colorScale.legendLabels&&this.props.colorScale.legendLabels.has(a))return this.props.colorScale.legendLabels.get(a);if("num_date"===this.props.colorBy||"temporal"===this.props.colorScale.scaleType){var b=this.props.colorScale.visibleLegendValues;if(b[b.length-1]-b[0]>10&&b[b.length-1]-parseInt(a,10)>=10)return parseInt(a,10);var c,d,e=(c=(0,I.hT)(a).split("-"),d=3,function(a){if(Array.isArray(a))return a}(c)||function(b,e){var f,g,a=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=a){var c=[],d=!0,h=!1;try{for(a=a.call(b);!(d=(f=a.next()).done)&&(c.push(f.value),!e||c.length!==e);d=!0);}catch(i){h=!0,g=i}finally{try{d||null==a.return||a.return()}finally{if(h)throw g}}return c}}(c,d)||function(a,c){if(a){if("string"==typeof a)return K(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return K(a,c)}}(c,d)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=e[0],g=e[1];return e[2],"".concat(j.e7[g]," ").concat(f)}return a}},{key:"legendItems",value:function(){var d=this,a=this.props.colorScale.visibleLegendValues,e=Math.ceil(a.length/2),b=a.filter(function(a){return void 0!==a}).map(function(a,b){return(0,c.jsx)(G,{dispatch:d.props.dispatch,legendRectSize:15,legendSpacing:4,rectFill:(0,H.m6)(d.props.colorScale.scale(a)),rectStroke:(0,E.B8)(d.props.colorScale.scale(a)).toString(),transform:d.getTransformationForLegendItem(e,b),value:a,label:d.styleLabelText(a),index:b,clipId:b<e?"legendFirstColumnClip":void 0},d.props.colorScale.colorBy+a+b)});return(0,c.jsxs)("g",{id:"ItemsContainer",children:[(0,c.jsx)("rect",{width:this.getSVGWidth(),height:this.getSVGHeight(),fill:"rgba(255,255,255,.85)"}),(0,c.jsx)("clipPath",{id:"legendFirstColumnClip",children:(0,c.jsx)("rect",{x:"0",y:"0",width:140,height:this.getSVGHeight(),fill:"rgb(150, 154, 223)"})}),(0,c.jsx)("g",{id:"Items",transform:"translate(0,20)",children:b})]})}},{key:"getContainerStyles",value:function(){var a={position:"absolute",top:26,borderRadius:4,zIndex:1e3,userSelect:"none"};return a[this.props.right?"right":"left"]=5,a}},{key:"getArrowOffset",value:function(){return this.props.right?this.getSVGWidth()-20:this.getTitleWidth()}},{key:"getTitleOffset",value:function(){return this.props.right?this.getSVGWidth()-this.getTitleWidth()-15:5}},{key:"render",value:function(){var a=this;return this.props.colorScale?(0,c.jsxs)("svg",{id:"TreeLegendContainer",width:this.getSVGWidth(),height:this.getSVGHeight(),style:this.getContainerStyles(),children:[this.legendItems(),(0,c.jsxs)("g",{id:"TitleAndChevron",onClick:function(){return a.toggleLegend()},style:{cursor:"pointer",textAlign:"right"},children:[this.legendTitle(),this.legendChevron()]})]}):null}}],L(a.prototype,b),d&&L(a,d),e}(f.Component))||d)||d)||d)||d,O=n,P=b(38658),Q=b(96313),o=function(a){return 1===a["stroke-width"]?0:a["stroke-width"]>6?a["stroke-width"]+6:2*a["stroke-width"]};function R(a,e){let b=0;if(void 0===e)for(let c of a)(c=+c)&&(b+=c);else{let f=-1;for(let d of a)(d=+e(d,++f,a))&&(b+=d)}return b}function S(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function T(a,b){return function(a){if(Array.isArray(a))return a}(a)||function(b,e){var f,g,a=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=a){var c=[],d=!0,h=!1;try{for(a=a.call(b);!(d=(f=a.next()).done)&&(c.push(f.value),!e||c.length!==e);d=!0);}catch(i){h=!0,g=i}finally{try{d||null==a.return||a.return()}finally{if(h)throw g}}return c}}(a,b)||U(a,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(a,c){if(a){if("string"==typeof a)return S(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return S(a,c)}}var p=function(a){var b=a.n.node_attrs&&a.n.node_attrs.hidden;return b&&("always"===b||"timetree"===b&&"num_date"===a.that.distance||"divtree"===b&&"div"===a.that.distance)?"hidden":"visible"},V=function(a,b){return a.branchStroke},W=function(a,e,b){if(a){var c=a.that.svg.select("#"+(0,Q.yQ)("branchT",a.n.name));c.empty()||c.style("stroke",b);var d=a.that.svg.select("#"+(0,Q.yQ)("branchS",a.n.name));d.empty()||d.style("stroke",b)}},X=function(a){a&&W(a,a.n.parent.shell.branchStroke,a.branchStroke)},Y=function(a){a&&W(a,(0,H.ii)(a.n.parent.shell.branchStroke),(0,H.ii)(a.branchStroke))},Z=b(65074),$=b(26061),_=function(a){return"aa"===a?"10px":"14px"},aa=function(a){return"aa"===a?"500":"700"},ab=function(a,b,c,d){return function(c){if(b)return"visible";if(c.visibility!==j.m7)return"hidden";var e=.03;return c.n.tipCount>e*d?"visible":"aa"!==a&&(c.n.name===c.n.parent.name||"__ROOT"===c.n.parent.name)?"visible":"hidden"}},ac=function(a){return"num_date"===a?function(a){return(0,I.ti)("DAY",(0,I.vA)((0,$.rs)(a.n,"num_date")))}:function(b){return(0,$.rs)(b.n,a)}};function ad(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function ae(a){return function(a){if(Array.isArray(a))return ad(a)}(a)||function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||af(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function af(a,c){if(a){if("string"==typeof a)return ad(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return ad(a,c)}}var ag=function(a,b){a.forEach(function(a,e){for(var c in a.update=!1,b){var d=b[c][e];d!==a[c]&&(a[c]=d,a.update=!0)}})},ah={attrs:{".tip":{r:function(a){return a.r},cx:function(a){return a.xTip},cy:function(a){return a.yTip}},".branch":{},".vaccineCross":{d:function(a){return a.vaccineCross}},".conf":{d:function(a){return a.confLine}}},styles:{".tip":{fill:function(a){return a.fill},stroke:function(a){return a.tipStroke},visibility:function(a){return a.visibility===j.m7?"visible":"hidden"}},".conf":{stroke:function(a){return a.branchStroke},"stroke-width":o},".branch":{"stroke-width":function(a){return a["stroke-width"]+"px"},stroke:function(a){return V(a)},cursor:function(a){return a.visibility===j.m7?"pointer":"default"},visibility:p}}},ai=function(a,b){return function(c){ah.attrs[a]&&ae(b).filter(function(b){return ah.attrs[a][b]}).forEach(function(b){c.attr(b,ah.attrs[a][b])}),ah.styles[a]&&ae(b).filter(function(b){return ah.styles[a][b]}).forEach(function(b){c.style(b,ah.styles[a][b])})}},aj=function(b,c,d,a){b.selectAll(c).filter(function(a){return a.update}).transition().duration(a).call(d),a||(0,P.R8)()},ak=b(92498),al=b(80386),am=b(64881),an=b(32545),ao=b(40978);function ap(){var c,d,b=function(){var b=e().length,l=g[1]<g[0],a=g[l-0],m=g[1-l];c=(m-a)/Math.max(1,b-i+2*j),h&&(c=Math.floor(c)),a+=(m-a-c*(b-i))*k,d=c*(1-i),h&&(a=Math.round(a),d=Math.round(d));var n=(0,an.w6)(b).map(function(b){return a+c*b});return f(l?n.reverse():n)},a=(0,ao.Z)().unknown(void 0),e=a.domain,f=a.range,g=[0,1],h=!1,i=0,j=0,k=.5;return delete a.unknown,a.domain=function(a){return arguments.length?(e(a),b()):e()},a.range=function(a){return arguments.length?(g=[+a[0],+a[1]],b()):g.slice()},a.rangeRound=function(a){return g=[+a[0],+a[1]],h=!0,b()},a.bandwidth=function(){return d},a.step=function(){return c},a.round=function(a){return arguments.length?(h=!!a,b()):h},a.padding=function(a){return arguments.length?(i=j=Math.max(0,Math.min(1,a)),b()):i},a.paddingInner=function(a){return arguments.length?(i=Math.max(0,Math.min(1,a)),b()):i},a.paddingOuter=function(a){return arguments.length?(j=Math.max(0,Math.min(1,a)),b()):j},a.align=function(a){return arguments.length?(k=Math.max(0,Math.min(1,a)),b()):k},a.copy=function(){return ap().domain(e()).range(g).round(h).paddingInner(i).paddingOuter(j).align(k)},b()}function aq(a){var b=a.copy;return a.padding=a.paddingOuter,delete a.paddingInner,delete a.paddingOuter,a.copy=function(){return aq(b())},a}function ar(){return aq(ap().paddingInner(1))}function as(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function at(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function au(a,b){return function(a){if(Array.isArray(a))return a}(a)||function(b,e){var f,g,a=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=a){var c=[],d=!0,h=!1;try{for(a=a.call(b);!(d=(f=a.next()).done)&&(c.push(f.value),!e||c.length!==e);d=!0);}catch(i){h=!0,g=i}finally{try{d||null==a.return||a.return()}finally{if(h)throw g}}return c}}(a,b)||av(a,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function av(a,c){if(a){if("string"==typeof a)return as(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return as(a,c)}}var aw=function(a,d){var e=a.depth-a.pDepth;a.x=a.px+e*Math.cos(a.tau+.5*a.w),a.y=a.py+e*Math.sin(a.tau+.5*a.w);var f=a.tau;if(a.n.hasChildren)for(var c=0;c<a.n.children.length;c++){var b=a.n.children[c].shell;b.w=2*Math.PI*az(b.n)/d,b.tau=f,f+=b.w,b.px=a.x,b.py=a.y,aw(b,d)}};function ax(b,a){return a.step()>50?a.padding(.5):b.length<=4?a.padding(.4):b.length<=6?a.padding(.3):b.length<=10?a.padding(.2):a.padding(.1)}function ay(b,c,e){var f=c.step();if(!(50>=c.step())){for(var d=[],g=100;g--;)d.push((Math.random()-.5)*f*.5);var a=["".concat(b,"Base"),"".concat(b,"Tip"),d.length],h=a[0],i=a[1],j=a[2],k=0;l(e[0])}function l(a){if(a[h]=(0,Q.Fw)(a.n).shell[i],a[i]+=d[k++],k>=j&&(k=0),a.n.hasChildren){var b=!0,e=!1,f=void 0;try{for(var g,c=a.n.children[Symbol.iterator]();!(b=(g=c.next()).done);b=!0){var m=g.value;l(m.shell)}}catch(n){e=!0,f=n}finally{try{b||null==c.return||c.return()}finally{if(e)throw f}}}}}function az(a){return a.tipCount+.15*(a.fullTipCount-a.tipCount)}var q=b(8594);function aA(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function aB(a){return function(a){if(Array.isArray(a))return aA(a)}(a)||function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||aC(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function aC(a,c){if(a){if("string"==typeof a)return aA(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return aA(a,c)}}var aD=function(a,b){"temporalWindow"in a||(a.temporalWindow=b.append("g").attr("id","temporalWindow"),a.temporalWindowStart=a.temporalWindow.append("rect").attr("class","temporalWindowStart"),a.temporalWindowEnd=a.temporalWindow.append("rect").attr("class","temporalWindowEnd")),"majorGrid"in a||(a.majorGrid=b.append("g").attr("id","majorGrid").attr("clip-path","url(#treeClip)")),"minorGrid"in a||(a.minorGrid=b.append("g").attr("id","minorGrid").attr("clip-path","url(#treeClip)")),"gridText"in a||(a.gridText=b.append("g").attr("id","gridText")),"axisText"in a||(a.axisText=b.append("g").attr("id","axisText"))},aE=function(b,d){var a=Math.pow(10,Math.floor(Math.log10(b)));b/a<2?a/=5:b/a<5&&(a/=2);var c=d;return(5===a||10===a)&&(c=5),{majorStep:a,minorStep:a/c}},aF=function(e,d,o,p,i){for(var j=[],k=[],l=aE(d-e,p),a=l.majorStep,f=l.minorStep,g=Math.floor(e/a)*a,m="radial"===o?e:g,n=d,h=0;h<=(d-g)/a+3;h++){var b=g+a*h;j.push({position:b,name:b.toFixed(Math.max(0,-Math.floor(Math.log10(a)))),visibility:b<m||b>n?"hidden":"visible",axis:i});for(var c=b+f;c<b+a&&c<d;c+=f)k.push({position:c,visibility:c<m||c>n+f?"hidden":"visible",axis:i})}return{majorGridPoints:j,minorGridPoints:k}},aG=function(h,g){var a={unit:"DAY",n:1},d={unit:"DAY",n:0},f=h/Math.floor(g/(g<1e3?130:180)),b={CENTURY:{t:100,max:void 0},DECADE:{t:10,max:5},FIVEYEAR:{t:5,max:1},YEAR:{t:1,max:3},MONTH:{t:1/12,max:6},WEEK:{t:1/52,max:1},DAY:{t:1/365,max:3}},c=Object.keys(b);a.unit="DAY";for(var e=0;e<c.length-1;e++)if(f>b[c[e]].t){a.unit=c[e];break}a.n=Math.floor(f/b[a.unit].t)||1,b[a.unit].max&&a.n>b[a.unit].max&&(a.unit=c[c.indexOf(a.unit)-1],a.n=Math.floor(f/b[a.unit].t)||1),a.n>1||"DAY"===a.unit?d.unit=a.unit:d.unit=c[c.indexOf(a.unit)+1];var i=a.n*b[a.unit].t;return d.n=Math.ceil(b[d.unit].t/i),{majorStep:a,minorStep:d}},aH=function(d,e,h,i){for(var c=[],j=[],f=aG(e-d,Math.abs(h)),b=f.majorStep,k=f.minorStep,l=(0,I.OO)(b.unit,(0,I.vA)(e)),a=(0,I.c8)(b.unit,(0,I.vA)(d));a<l;){c.push({date:a,position:(0,I.O$)((0,I.UW)(a)),name:(0,I.ti)(b.unit,a),visibility:"visible",axis:i});for(var g=0;g<b.n;g++)a=(0,I.OO)(b.unit,a)}return k.n&&c.forEach(function(f,b){a=(0,I.OO)(k.unit,f.date);for(var d=0;d<k.n-1;d++)a=(0,I.OO)(k.unit,a);for(var g=b===c.length-1?l:c[b+1].date;a<g;){j.push({position:(0,I.O$)((0,I.UW)(a)),visibility:"visible",axis:i});for(var e=0;e<k.n;e++)a=(0,I.OO)(k.unit,a)}}),{majorGridPoints:c,minorGridPoints:j}};(0,q.eR)("temporalWindowTransition").duration(j.VC).ease(function(a){return+a});var a=function(a,b,c){var d=this;this.grid=!1,this.attributes=["r","cx","cy","id","class","d"],this.params={regressionStroke:F.I6,regressionWidth:6,majorGridStroke:"#DDD",majorGridWidth:2,minorGridStroke:"#EEE",minorGridWidth:1,tickLabelSize:12,tickLabelFill:F.I6,minorTicks:4,orientation:[1,1],showGrid:!0,fillSelected:"#A73",radiusSelected:5,branchStroke:"#AAA",branchStrokeWidth:2,tipStroke:"#AAA",tipFill:"#CCC",tipStrokeWidth:1,tipRadius:4,fontFamily:F.kU,branchLabelKey:!1,branchLabelFont:F.kU,branchLabelFill:"#777",branchLabelFontWeight:500,branchLabelPadX:8,branchLabelPadY:5,tipLabels:!0,tipLabelFont:F.kU,tipLabelFill:"#555",tipLabelPadX:8,tipLabelPadY:2,mapToScreenDebounceTime:500,tipLabelFontSizeL1:8,tipLabelFontSizeL2:10,tipLabelFontSizeL3:12,tipLabelBreakL1:75,tipLabelBreakL2:50,tipLabelBreakL3:25},this.groups={},this.id=b,this.nodes=a.map(function(a){var b={that:d,n:a,x:0,y:0,inView:void 0===a.inView||a.inView};return a.shell=b,b}),this.zoomNode=this.nodes[c],this.strainToNode={},this.nodes.forEach(function(a){d.strainToNode[a.n.name]=a})};a.prototype.change=function(a){var p=a.changeColorBy,q=void 0!==p&&p,r=a.changeVisibility,k=void 0!==r&&r,s=a.changeTipRadii,t=a.changeBranchThickness,u=a.showConfidences,l=void 0!==u&&u,v=a.removeConfidences,w=a.zoomIntoClade,e=void 0!==w&&w,x=a.svgHasChangedDimensions,m=void 0!==x&&x,y=a.animationInProgress,z=a.changeNodeOrder,g=void 0!==z&&z,A=a.newDistance,f=void 0===A?void 0:A,B=a.newLayout,h=void 0===B?void 0:B,C=a.updateLayout,i=void 0===C?void 0:C,D=a.newBranchLabellingKey,E=a.showAllBranchLabels,F=void 0===E?void 0:E,G=a.newTipLabelKey,n=void 0===G?void 0:G,H=a.branchStroke,I=a.tipStroke,J=a.fill,K=a.visibility,L=a.tipRadii,M=a.branchThickness,N=a.focus,O=void 0===N?void 0:N,P=a.scatterVariables,b=new Set,d={},c=new Set,o=500;Date.now()-this.timeLastRenderRequested<1e3&&(o=0),q&&(b.add(".branch").add(".tip").add(".conf"),c.add("stroke").add("fill"),d.branchStroke=void 0===H?void 0:H,d.tipStroke=void 0===I?void 0:I,d.fill=void 0===J?void 0:J),k&&(b.add(".tip").add(".tipLabel").add(".branchLabel"),c.add("visibility").add("cursor"),d.visibility=void 0===K?void 0:K),void 0!==s&&s&&(b.add(".tip"),c.add("r"),d.r=void 0===L?void 0:L),void 0!==t&&t&&(b.add(".branch").add(".conf"),c.add("stroke-width"),d["stroke-width"]=void 0===M?void 0:M),(f||h||i||e||m||g)&&(b.add(".tip").add(".branch.S").add(".branch.T").add(".branch"),b.add(".vaccineCross").add(".vaccineDottedLine").add(".conf"),b.add(".branchLabel").add(".tipLabel"),b.add(".grid").add(".regression"),c.add("cx").add("cy").add("d").add("opacity").add("visibility")),g&&((0,Q.Td)({nodes:this.nodes,focus:O}),this.setDistance()),ag(this.nodes,d),q&&this.updateColorBy(),k&&this.regression&&(b.add(".regression"),this.calculateRegression()),e&&(this.nodes.forEach(function(a){a.inView=!1,a.update=!0}),this.zoomNode=e.n.hasChildren?e:e.n.parent.shell,(0,Q.Yo)(this.zoomNode,function(a){a.inView=!0})),(m||g)&&this.nodes.forEach(function(a){a.update=!0}),(f||i)&&this.setDistance(f),i&&(0,Q.Td)({nodes:this.nodes,focus:O}),(f||h||i||g)&&this.setLayout(h||this.layout,void 0===P?void 0:P),l&&(this.params.confidence=!0),void 0!==F&&(this.params.showAllBranchLabels=F,b.add(".branchLabel")),(c.has(["stroke-width"])||f||h||g||i||e||m||l)&&this.mapToScreen(),n&&(this.callbacks.tipLabel=ac(n),b.add(".tipLabel"));var j={removeConfidences:void 0!==v&&v,showConfidences:l,newBranchLabellingKey:void 0===D?void 0:D};j.timeSliceHasPotentiallyChanged=k||f,j.hideTipLabels=void 0!==y&&y||"none"===n,h?this.modifySVGInStages(b,c,o,1e3,j):this.modifySVG(b,c,o,j),this.timeLastRenderRequested=Date.now()},a.prototype.modifySVG=function(a,f,d,b){var e,h=this,c=[".tip",".vaccineDottedLine",".vaccineCross",".branch"];if(a.has(".branch.S")||a.has(".branch.T")){var i=this,g=a.has(".branch");g&&c.splice(c.indexOf(".branch"),1),[".S",".T"].forEach(function(b,c){a.has(".branch".concat(b))&&(e=g?function(a){ai(".branch",f)(a),a.attr("d",function(a){return a.branch[c]})}:function(a){a.attr("d",function(a){return a.branch[c]})},aj(i.svg,".branch".concat(b),e,d))})}c.forEach(function(b){a.has(b)&&(e=ai(b,f),aj(h.svg,b,e,d))}),b.hideTipLabels?this.removeTipLabels():a.has(".tipLabel")&&this.updateTipLabels(),a.has(".grid")&&(this.grid&&"unrooted"!==this.layout?this.addGrid():this.hideGrid()),a.has(".regression")&&(this.removeRegression(),this.regression&&this.drawRegression()),b.removeConfidences&&this.confidencesInSVG?this.removeConfidence():b.showConfidences&&!this.confidencesInSVG?this.drawConfidence():a.has(".conf")&&this.confidencesInSVG&&((0,Z.xi)(!0,this.distance,this.layout)?(e=ai(".conf",f),aj(this.svg,".conf",e,d)):this.removeConfidence()),b.timeSliceHasPotentiallyChanged&&this.showTemporalSlice(),b.newBranchLabellingKey?(this.removeBranchLabels(),"none"!==b.newBranchLabellingKey&&this.drawBranchLabels(b.newBranchLabellingKey)):a.has(".branchLabel")&&this.updateBranchLabels(d)},a.prototype.modifySVGInStages=function(a,c,b,d,e){var f=this;a.delete(".tip"),this.hideGrid();var g=0,h=function(){f.drawBranches(),f.params.showGrid&&f.addGrid(),f.svg.selectAll(".tip").remove(),f.updateTipLabels(),f.drawTips(),f.vaccines&&f.drawVaccines(),f.showTemporalSlice(),f.regression&&f.drawRegression(),a.has(".branchLabel")&&f.drawBranchLabels(e.newBranchLabellingKey||f.params.branchLabelKey)};this.confidencesInSVG=!1,this.svg.selectAll(ae(a).join(", ")).transition().duration(b).style("opacity",0).remove().on("start",function(){return g++}).on("end",function(){if(!--g){f.setClipMask();var a=ai(".tip",c);aj(f.svg,".tip",a,d),setTimeout(h,d)}}),this.hideTemporalSlice(),b||(0,P.R8)()},a.prototype.render=function(b,c,d,e,f,g,k,l,h,a,m,n,o,p,i,j){var q=this;this.svg=b,this.params=Object.assign(this.params,f),this.callbacks=g,this.vaccines=a?a.map(function(a){return a.shell}):void 0,this.dateRange=i,this.nodes.forEach(function(a,b){a.branchStroke=m[b],a.tipStroke=n[b],a.fill=o[b],a.visibility=l[b],a["stroke-width"]=k[b],a.r=p?p[b]:q.params.tipRadius}),(0,Q.Td)({nodes:this.nodes,focus:e}),this.setDistance(d),this.setLayout(c,j),this.mapToScreen(),this.setClipMask(),this.params.showGrid&&(this.addGrid(),this.showTemporalSlice()),this.drawBranches(),this.updateTipLabels(),this.drawTips(),this.params.branchLabelKey&&this.drawBranchLabels(this.params.branchLabelKey),this.vaccines&&this.drawVaccines(),this.regression&&this.drawRegression(),this.confidencesInSVG=!1,h&&this.drawConfidence(),this.timeLastRenderRequested=Date.now()},a.prototype.clearSVG=function(){this.svg.selectAll("*").remove()},a.prototype.setClipMask=function(){var c,d=T(this.yScale.range(),2),e=d[0],k=d[1],f=T(this.xScale.range(),2),a=f[0],b=f[1];parseInt(a,10)>parseInt(b,10)&&(a=(c=[b,a])[0],b=c[1]);var g=a-5,h=b-a+20,i=e-15,j=k-e+20;this.groups.clipPath?this.groups.clipPath.select("rect").attr("x",g).attr("y",i).attr("width",h).attr("height",j):(this.groups.clipPath=this.svg.append("g").attr("id","clipGroup"),this.groups.clipPath.append("clipPath").attr("id","treeClip").append("rect").attr("x",g).attr("y",i).attr("width",h).attr("height",j))},a.prototype.drawTips=function(){var a=this.params;"tips"in this.groups||(this.groups.tips=this.svg.append("g").attr("id","tips").attr("clip-path","url(#treeClip)")),this.groups.tips.selectAll(".tip").data(this.nodes.filter(function(a){return!a.n.hasChildren})).enter().append("circle").attr("class","tip").attr("id",function(a){return(0,Q.yQ)("tip",a.n.name)}).attr("cx",function(a){return a.xTip}).attr("cy",function(a){return a.yTip}).attr("r",function(a){return a.r}).on("mouseover",this.callbacks.onTipHover).on("mouseout",this.callbacks.onTipLeave).on("click",this.callbacks.onTipClick).style("pointer-events","auto").style("visibility",function(a){return a.visibility===j.m7?"visible":"hidden"}).style("fill",function(b){return b.fill||a.tipFill}).style("stroke",function(b){return b.tipStroke||a.tipStroke}).style("stroke-width",function(){return a.tipStrokeWidth}).style("cursor","pointer")},a.prototype.drawBranches=function(){var a=this.params;"branchTee"in this.groups||(this.groups.branchTee=this.svg.append("g").attr("id","branchTee").attr("clip-path","url(#treeClip)")),"clock"===this.layout||"scatter"===this.layout||"unrooted"===this.layout?this.groups.branchTee.selectAll("*").remove():this.groups.branchTee.selectAll(".branch").data(this.nodes.filter(function(a){return a.n.hasChildren&& void 0!==a.displayOrder})).enter().append("path").attr("class","branch T").attr("id",function(a){return(0,Q.yQ)("branchT",a.n.name)}).attr("d",function(a){return a.branch[1]}).style("stroke",function(b){return b.branchStroke||a.branchStroke}).style("stroke-width",function(b){return b["stroke-width"]||a.branchStrokeWidth}).style("visibility",p).style("fill","none").style("pointer-events","auto").on("mouseover",this.callbacks.onBranchHover).on("mouseout",this.callbacks.onBranchLeave).on("click",this.callbacks.onBranchClick),this.groups.branchGradientDefs||(this.groups.branchGradientDefs=this.svg.append("defs")),this.groups.branchGradientDefs.selectAll("*").remove(),this.updateColorBy(),"branchStem"in this.groups||(this.groups.branchStem=this.svg.append("g").attr("id","branchStem").attr("clip-path","url(#treeClip)")),this.groups.branchStem.selectAll(".branch").data(this.nodes.filter(function(a){return void 0!==a.displayOrder})).enter().append("path").attr("class","branch S").attr("id",function(a){return(0,Q.yQ)("branchS",a.n.name)}).attr("d",function(a){return a.branch[0]}).style("stroke",function(b){return b.branchStroke?V(b,"S"):a.branchStroke}).style("stroke-linecap","round").style("stroke-width",function(b){return b["stroke-width"]||a.branchStrokeWidth}).style("visibility",p).style("cursor",function(a){return a.visibility===j.m7?"pointer":"default"}).style("pointer-events","auto").on("mouseover",this.callbacks.onBranchHover).on("mouseout",this.callbacks.onBranchLeave).on("click",this.callbacks.onBranchClick)},a.prototype.drawVaccines=function(){this.vaccines&&this.vaccines.length&&("vaccines"in this.groups||(this.groups.vaccines=this.svg.append("g").attr("id","vaccines")),this.groups.vaccines.selectAll(".vaccineCross").data(this.vaccines).enter().append("path").attr("class","vaccineCross").attr("d",function(a){return a.vaccineCross}).style("stroke","#333").style("stroke-width",2*this.params.branchStrokeWidth).style("fill","none").style("cursor","pointer").style("pointer-events","auto").on("mouseover",this.callbacks.onTipHover).on("mouseout",this.callbacks.onTipLeave).on("click",this.callbacks.onTipClick))},a.prototype.drawRegression=function(){if(void 0!==this.regression.slope){var a,b,c,d=this.yScale(this.regression.intercept+this.xScale.domain()[0]*this.regression.slope),e=this.yScale(this.regression.intercept+this.xScale.domain()[1]*this.regression.slope),f="M "+this.xScale.range()[0].toString()+" "+d.toString()+" L "+this.xScale.range()[1].toString()+" "+e.toString();"regression"in this.groups||(this.groups.regression=this.svg.append("g").attr("id","regression").attr("clip-path","url(#treeClip)")),this.groups.regression.append("path").attr("d",f).attr("class","regression").style("fill","none").style("visibility","visible").style("stroke",this.params.regressionStroke).style("stroke-width",this.params.regressionWidth),this.groups.regression.append("text").text((a=this.regression,b=this.layout,c=this.yScale,"clock"===b?(0,Q.jP)(c)?"rate estimate: ".concat(a.slope.toExponential(2)," subs per site per year"):"rate estimate: ".concat((0,Q.dX)(a.slope)," subs per year"):"intercept = ".concat(a.intercept.toPrecision(3),", slope = ").concat(a.slope.toPrecision(3),", R^2 = ").concat(a.r2.toPrecision(3)))).attr("class","regression").attr("x",this.xScale.range()[1]/2-75).attr("y",this.yScale.range()[0]+50).style("fill",this.params.regressionStroke).style("font-size",this.params.tickLabelSize+8).style("font-weight",400).style("font-family",this.params.fontFamily)}},a.prototype.removeRegression=function(){"regression"in this.groups&&this.groups.regression.selectAll("*").remove()},a.prototype.updateColorBy=function(){},a.prototype.setDistance=function(a){this.nodes.forEach(function(a){a.update=!0}),a&&(this.distance=a),["div","num_date"].includes(this.distance)||(console.error("Tree distance measure not set or invalid. Using `div`."),this.distance="div"),"div"===this.distance?this.nodes.forEach(function(a){a.depth=(0,$.KT)(a.n),a.pDepth=(0,$.KT)((0,Q.Fw)(a.n)),a.conf=[a.depth,a.depth]}):this.nodes.forEach(function(a){a.depth=(0,$.rs)(a.n,"num_date"),a.pDepth=(0,$.rs)((0,Q.Fw)(a.n),"num_date"),a.conf=(0,$.rs)(a.n,"num_date",{confidence:!0})||[a.depth,a.depth]}),this.vaccines&&this.vaccines.forEach(function(a){a.crossDepth=a.depth})},a.prototype.setLayout=function(a,b){(void 0===a||a!==this.layout)&&this.nodes.forEach(function(a){a.update=!0}),void 0===a?this.layout="rect":this.layout=a,this.regression=void 0,b&&(this.scatterVariables=function(d){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{},b=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(b=b.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),b.forEach(function(a){at(d,a,c[a])})}return d}({},b)),"clock"===this.layout&&(this.scatterVariables.x="num_date",this.scatterVariables.y="div"),"rect"===this.layout?this.rectangularLayout():"clock"===this.layout||"scatter"===this.layout?this.scatterplotLayout():"radial"===this.layout?this.radialLayout():"unrooted"===this.layout&&this.unrootedLayout()},a.prototype.rectangularLayout=function(){this.nodes.forEach(function(a){a.y=a.displayOrder,a.x=a.depth,a.px=a.pDepth,a.py=a.y}),this.vaccines&&this.vaccines.forEach(function(a){a.xCross=a.crossDepth,a.yCross=a.y})},a.prototype.scatterplotLayout=function(){var a=this;if(!this.scatterVariables){console.error("Scatterplot called without variables");return}var b="displayOrder"===this.scatterVariables.x||"displayOrder"===this.scatterVariables.y?(0,Q.rG)(this.nodes):void 0;this.nodes.forEach(function(c){var d,e,f,g;"div"===a.scatterVariables.x?(c.x=(0,$.KT)(c.n),c.px=(0,$.KT)((0,Q.Fw)(c.n))):"gt"===a.scatterVariables.x?(c.x=c.n.currentGt,c.px=(0,Q.Fw)(c.n).currentGt):"displayOrder"===a.scatterVariables.x?(d=au(b(c),2),c.x=d[0],c.px=d[1]):(c.x=(0,$.rs)(c.n,a.scatterVariables.x),c.px=(0,$.rs)((0,Q.Fw)(c.n),a.scatterVariables.x),a.scatterVariables.xTemporal&&(e=[(0,H.X6)(c.x,!0),(0,H.X6)(c.px,!0)],c.x=e[0],c.px=e[1])),"div"===a.scatterVariables.y?(c.y=(0,$.KT)(c.n),c.py=(0,$.KT)((0,Q.Fw)(c.n))):"gt"===a.scatterVariables.y?(c.y=c.n.currentGt,c.py=(0,Q.Fw)(c.n).currentGt):"displayOrder"===a.scatterVariables.y?(f=au(b(c),2),c.y=f[0],c.py=f[1]):(c.y=(0,$.rs)(c.n,a.scatterVariables.y),c.py=(0,$.rs)((0,Q.Fw)(c.n),a.scatterVariables.y),a.scatterVariables.yTemporal&&(g=[(0,H.X6)(c.y,!0),(0,H.X6)(c.py,!0)],c.y=g[0],c.py=g[1]))}),this.vaccines&&this.vaccines.forEach(function(a){a.xCross=a.x,a.yCross=a.y}),this.scatterVariables.showRegression&&this.calculateRegression()},a.prototype.unrootedLayout=function(){var d=az(this.nodes[0].n),b=1.5*Math.PI,e=this.nodes[0].n.children;this.nodes.forEach(function(a){a.x=void 0,a.y=void 0,a.px=void 0,a.py=void 0});for(var c=0;c<e.length;c++){var a=e[c].shell;if(a.w=2*Math.PI*az(a.n)/d,a.w>0){var f=a.depth-this.nodes[0].depth;a.px=f*Math.cos(b+.5*a.w),a.py=f*Math.sin(b+.5*a.w),a.tau=b,aw(a,d),b+=a.w}}this.vaccines&&this.vaccines.forEach(function(a){var b=a.crossDepth-a.depth;a.xCross=a.px+b*Math.cos(a.tau+.5*a.w),a.yCross=a.py+b*Math.sin(a.tau+.5*a.w)}),this.nodes.forEach(function(a){delete a.tau,delete a.w})},a.prototype.radialLayout=function(){var a,b,c=(b=Math).max.apply(b,function(a){if(Array.isArray(a))return as(a)}(a=this.nodes.map(function(a){return a.displayOrder}).filter(function(a){return a}))||function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||av(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=this.nodes[0].depth;if(this.nodes.forEach(function(a){var b=1.9*Math.PI*a.displayOrderRange[0]/c,e=1.9*Math.PI*a.displayOrderRange[1]/c;a.angle=1.9*Math.PI*a.displayOrder/c,a.y=(a.depth-d)*Math.cos(a.angle),a.x=(a.depth-d)*Math.sin(a.angle),a.py=a.y*(a.pDepth-d)/(a.depth-d+1e-15),a.px=a.x*(a.pDepth-d)/(a.depth-d+1e-15),a.yCBarStart=(a.depth-d)*Math.cos(b),a.xCBarStart=(a.depth-d)*Math.sin(b),a.yCBarEnd=(a.depth-d)*Math.cos(e),a.xCBarEnd=(a.depth-d)*Math.sin(e),a.smallBigArc=Math.abs(e-b)>1*Math.PI}),this.vaccines){var e=this;this.vaccines.forEach(function(a){"div"===e.distance?(a.xCross=a.x,a.yCross=a.y):(a.xCross=(a.crossDepth-d)*Math.sin(a.angle),a.yCross=(a.crossDepth-d)*Math.cos(a.angle))})}},a.prototype.setScales=function(){"scatter"!==this.layout||this.scatterVariables.xContinuous?this.xScale=(0,am.Z)():this.xScale=ar().round(!1).align(.5).padding(.5),"scatter"!==this.layout||this.scatterVariables.yContinuous?this.yScale=(0,am.Z)():this.yScale=ar().round(!1).align(.5).padding(.5);var a=parseInt(this.svg.attr("width"),10),b=parseInt(this.svg.attr("height"),10);if("radial"===this.layout||"unrooted"===this.layout){var c=a-this.margins.left-this.margins.right,d=b-this.margins.bottom-this.margins.top,e=(0,ak.Z)([c,d]),f=c-e,g=d-e;this.xScale.range([.5*f+this.margins.left,a-.5*f-this.margins.right]),this.yScale.range([.5*g+this.margins.top,b-.5*g-this.margins.bottom])}else this.params.orientation[0]>0?this.xScale.range([this.margins.left,a-this.margins.right]):this.xScale.range([a-this.margins.right,this.margins.left]),this.params.orientation[1]>0?this.yScale.range([this.margins.top,b-this.margins.bottom]):this.yScale.range([b-this.margins.bottom,this.margins.top])},a.prototype.mapToScreen=function(){var d,a,b,e,r=this,k=this.nodes.filter(function(a){return!a.n.hasChildren}).filter(function(a){return a.inView});this.margins={left:"scatter"===this.layout||"clock"===this.layout?40:5,right:5+function(a,b){var d=0;if(b.length<a.tipLabelBreakL1){var c=a.tipLabelFontSizeL1;b.length<a.tipLabelBreakL2&&(c=a.tipLabelFontSizeL2),b.length<a.tipLabelBreakL3&&(c=a.tipLabelFontSizeL3),b.forEach(function(a){d<a.n.name.length&&(d=.65*a.n.name.length*c)})}return d}(this.params,k),top:"radial"===this.layout?10:15,bottom:35},this.setScales(),this.setClipMask();var f=this.nodes.filter(function(a){return a.inView&& void 0!==a.y&& void 0!==a.x});if("scatter"===this.layout&& !1===this.scatterVariables.showBranches&&(f=f.filter(function(a){return!a.n.hasChildren})),"scatter"!==this.layout||this.scatterVariables.xContinuous){var l=[1e6,-1e5],c=l[0],g=l[1];f.forEach(function(a){a.x<c&&(c=a.x),a.x>g&&(g=a.x)}),c===g&&(c-=.005,g+=.005);var j=1e-8;(b=g-c)<j&&(g=j-c,b=j),"rect"===this.layout&&0!==this.zoomNode.n.arrayIdx&&(c-=(g-c)/20),d=[c,g]}else{var s=new Set(f.map(function(a){return a.x}));ax(d=this.scatterVariables.xDomain.filter(function(a){return s.has(a)}),this.xScale)}if("scatter"!==this.layout||this.scatterVariables.yContinuous){var m=[1e6,-1e5],h=m[0],i=m[1];if(f.forEach(function(a){a.y<h&&(h=a.y),a.y>i&&(i=a.y)}),k.length<30){var n=.05*(i-h);h-=n,i+=n}e=i-h,a=[h,i]}else{var t=new Set(f.map(function(a){return a.y}));ax(a=this.scatterVariables.yDomain.filter(function(a){return t.has(a)}),this.yScale)}if("radial"===this.layout||"unrooted"===this.layout){var o=(0,al.Z)([e,b]),p=b>e?(b-e)*.5:0,q=b<e?(e-b)*.5:0;d=[d[0]-q,d[0]+o-q],a=[a[0]-p,a[0]+o-p]}("clock"===this.layout||"scatter"===this.layout)&&a.reverse(),this.xScale.domain(d),this.yScale.domain(a);var u=this.yScale.range()[1]+100,v=this.xScale.range()[0]-100;if(this.nodes.forEach(function(a){a.xTip=r.xScale(a.x),a.yTip=r.yScale(a.y),a.xBase=r.xScale(a.px),a.yBase=r.yScale(a.py),a.rot=180*Math.atan2(a.yTip-a.yBase,a.xTip-a.xBase)/Math.PI}),"scatter"===this.layout&&(this.scatterVariables.yContinuous||ay("y",this.yScale,this.nodes),this.scatterVariables.xContinuous||ay("x",this.xScale,this.nodes),this.nodes.forEach(function(a){isNaN(a.xTip)&&(a.xTip=v),isNaN(a.yTip)&&(a.yTip=u),isNaN(a.xBase)&&(a.xBase=v),isNaN(a.yBase)&&(a.yBase=u)})),this.vaccines){var w=this;this.vaccines.forEach(function(d){var a=6,b=w.xScale(d.xCross),c=w.yScale(d.yCross);d.vaccineCross=" M ".concat(b-a,",").concat(c-a," L ").concat(b+a,",").concat(c+a," M ").concat(b-a,",").concat(c+a," L ").concat(b+a,",").concat(c-a)})}if("unrooted"===this.layout)this.nodes.forEach(function(a){a.branch=[" M "+a.xBase.toString()+","+a.yBase.toString()+" L "+a.xTip.toString()+","+a.yTip.toString(),""]});else if("clock"===this.layout||"scatter"===this.layout)this.scatterVariables.showBranches?this.nodes.forEach(function(a){a.branch=a.xBase===v||a.xTip===v||a.yBase===u||a.yTip===u?[""]:[" M "+a.xBase.toString()+","+a.yBase.toString()+" L "+a.xTip.toString()+","+a.yTip.toString(),""]}):this.nodes.forEach(function(a){a.branch=[]});else if("rect"===this.layout){var x=this;this.nodes.forEach(function(a){var c=.5*((0,Q.Fw)(a.n).shell["stroke-width"]-a["stroke-width"])||0,b=[x.yScale(a.displayOrderRange[0]),x.yScale(a.displayOrderRange[1])];a.branch=[[" M ".concat(a.xBase-c,",").concat(a.yBase," L ").concat(a.xTip,",").concat(a.yTip+.01)],[" M ".concat(a.xTip,",").concat(b[0]," L ").concat(a.xTip,",").concat(b[1])]],x.params.confidence&&(a.confLine=" M ".concat(x.xScale(a.conf[0]),",").concat(a.yBase," L ").concat(x.xScale(a.conf[1]),",").concat(a.yTip))})}else if("radial"===this.layout){var y=this,z=this.nodes[0].depth,A=this.nodes.map(function(a){return .5*((0,Q.Fw)(a.n).shell["stroke-width"]-a["stroke-width"])||0});this.nodes.forEach(function(a,b){a.branch=[" M "+(a.xBase-A[b]*Math.sin(a.angle)).toString()+" "+(a.yBase-A[b]*Math.cos(a.angle)).toString()+" L "+a.xTip.toString()+" "+a.yTip.toString(),""],a.n.hasChildren&&(a.branch[1]=[" M "+y.xScale(a.xCBarStart).toString()+" "+y.yScale(a.yCBarStart).toString()+" A "+(y.xScale(a.depth)-y.xScale(z)).toString()+" "+(y.yScale(a.depth)-y.yScale(z)).toString()+" 0 "+(a.smallBigArc?"1 ":"0 ")+" 1  "+y.xScale(a.xCBarEnd).toString()+","+y.yScale(a.yCBarEnd).toString()])})}},a.prototype.calculateRegression=function(){"clock"===this.layout?this.regression=function(c){var a=c.filter(function(a){return!a.n.hasChildren&&a.visibility===j.m7}),b=a.length;if(0===b)return{slope:void 0,intercept:void 0,r2:void 0};var e=c[0].x,f=R(a.map(function(a){return a.y*(a.x-e)}))/b,g=R(a.map(function(a){return(a.x-e)*(a.x-e)}))/b,d=f/g;return{slope:d,intercept:-e*d,r2:void 0}}(this.nodes):this.regression=function(d){var a=d.filter(function(a){return!a.n.hasChildren&& void 0!==a.x&& void 0!==a.y&&a.visibility===j.m7}),b=a.length;if(0===b)return{slope:void 0,intercept:void 0,r2:void 0};var e=R(a.map(function(a){return a.x}))/b,f=R(a.map(function(a){return a.y}))/b,c=R(a.map(function(a){return(a.x-e)*(a.y-f)}))/R(a.map(function(a){return Math.pow(a.x-e,2)})),g=f-c*e;return{slope:c,intercept:g,r2:1-R(a.map(function(a){return Math.pow(a.y-(g+c*a.x),2)}))/R(a.map(function(a){return Math.pow(a.y-f,2)}))}}(this.nodes)},a.prototype.removeConfidence=function(a){this.confidencesInSVG=!1,"confidenceIntervals"in this.groups&&(a?this.groups.confidenceIntervals.selectAll("*").transition().duration(a).style("opacity",0).remove():this.groups.confidenceIntervals.selectAll("*").remove())},a.prototype.drawConfidence=function(a){if(this.confidencesInSVG=!0,"confidenceIntervals"in this.groups||(this.groups.confidenceIntervals=this.svg.append("g").attr("id","confidenceIntervals")),a){var b=this;this.groups.confidenceIntervals.selectAll(".conf").data(this.nodes).enter().call(function(a){return b.drawSingleCI(a,0)}),this.groups.confidenceIntervals.transition().duration(a).style("opacity",.5)}else{var c=this;this.groups.confidenceIntervals.selectAll(".conf").data(this.nodes).enter().call(function(a){return c.drawSingleCI(a,.5)})}},a.prototype.drawSingleCI=function(a,b){a.append("path").attr("class","conf").attr("id",function(a){return(0,Q.yQ)("conf",a.n.name)}).attr("d",function(a){return a.confLine}).style("stroke",function(a){return a.branchStroke||"#888"}).style("opacity",b).style("fill","none").style("stroke-width",o).style("pointer-events","none")},a.prototype.drawBranchLabels=function(a){var e=this;this.params.branchLabelKey=a;var b=_(a),c=aa(a),d=ab(a,this.params.showAllBranchLabels,this.layout,this.zoomNode.n.tipCount);"branchLabels"in this.groups||(this.groups.branchLabels=this.svg.append("g").attr("id","branchLabels").attr("clip-path","url(#treeClip)")),this.groups.branchLabels.selectAll(".branchLabel").data(this.nodes.filter(function(b){return b.n.branch_attrs&&b.n.branch_attrs.labels&&b.n.branch_attrs.labels[a]})).enter().append("text").attr("class","branchLabel").attr("x",function(a){return a.xTip+(e.params.orientation[0]>0?-5:5)}).attr("y",function(a){return a.yTip-e.params.branchLabelPadY}).style("text-anchor",this.params.orientation[0]>0?"end":"start").style("visibility",d).style("fill",this.params.branchLabelFill).style("font-family",this.params.branchLabelFont).style("font-weight",c).style("font-size",b).style("pointer-events","none").text(function(b){return b.n.branch_attrs.labels[a]})},a.prototype.removeBranchLabels=function(){this.params.branchLabelKey=void 0,"branchLabels"in this.groups&&this.groups.branchLabels.selectAll("*").remove()},a.prototype.updateBranchLabels=function(a){var e=this;if(this.groups.branchLabels){var b=ab(this.params.branchLabelKey,this.params.showAllBranchLabels,this.layout,this.zoomNode.n.tipCount),c=_(this.params.branchLabelKey),d=aa(this.params.branchLabelKey);this.groups.branchLabels.selectAll(".branchLabel").transition().duration(a).attr("x",function(a){return a.xTip-5}).attr("y",function(a){return a.yTip-e.params.branchLabelPadY}).style("visibility",b).style("font-weight",d).style("font-size",c),a||(0,P.R8)()}},a.prototype.updateTipLabels=function(c){"tipLabels"in this.groups?this.groups.tipLabels.selectAll("*").remove():this.groups.tipLabels=this.svg.append("g").attr("id","tipLabels");var e=this.callbacks.tipLabel,f=this.params.tipLabelPadX,g=this.params.tipLabelPadY,a=this.nodes.filter(function(a){return!a.n.hasChildren}).filter(function(a){return a.inView}),d=a.filter(function(a){return a.visibility===j.m7});if(d.length<this.params.tipLabelBreakL1){var h=this,b=this.params.tipLabelFontSizeL1;a.length<this.params.tipLabelBreakL3?b=this.params.tipLabelFontSizeL3:a.length<this.params.tipLabelBreakL2&&(b=this.params.tipLabelFontSizeL2),window.setTimeout(function(){h.groups.tipLabels.selectAll(".tipLabel").data(d).enter().append("text").attr("x",function(a){return a.xTip+f}).attr("y",function(a){return a.yTip+g}).text(function(a){return e(a)}).attr("class","tipLabel").style("font-size",b.toString()+"px").style("pointer-events","none").style("visibility",function(a){return a.visibility===j.m7?"visible":"hidden"})},c)}},a.prototype.removeTipLabels=function(){"tipLabels"in this.groups&&this.groups.tipLabels.selectAll("*").remove()},a.prototype.hideGrid=function(){"majorGrid"in this.groups&&this.groups.majorGrid.selectAll("*").style("visibility","hidden"),"minorGrid"in this.groups&&this.groups.minorGrid.selectAll("*").style("visibility","hidden"),"gridText"in this.groups&&this.groups.gridText.selectAll("*").style("visibility","hidden"),"axisText"in this.groups&&this.groups.axisText.selectAll("*").style("visibility","hidden")},a.prototype.addGrid=function(){var c,b,a=this.layout;if(aD(this.groups,this.svg),"unrooted"!==a){var f=(0,ak.Z)(this.yScale.domain()),g=(0,al.Z)(this.yScale.domain()),e="radial"===a?this.nodes[0].depth:this.xScale.domain()[0],h="radial"===a?e+(0,al.Z)([this.xScale.domain()[1],this.yScale.domain()[1],-this.xScale.domain()[0],-this.yScale.domain()[0]]):this.xScale.domain()[1],m=this.xScale.range()[1]-this.xScale.range()[0],d=(t="scatter"===this.layout&&"num_date"===this.scatterVariables.x||"clock"===this.layout||"scatter"!==this.layout&&"num_date"===this.distance?aH(e,h,m,"x"):"scatter"!==this.layout||this.scatterVariables.xContinuous?aF(e,h,a,this.params.minorTicks,"x"):{majorGridPoints:this.xScale.domain().map(function(a){return{name:a,visibility:"visible",axis:"x",position:a}}),minorGridPoints:[]}).majorGridPoints,n=t.minorGridPoints,i=function(a,b,c){return function(d){var f="";if("x"===d.axis){if("rect"===c||"clock"===c||"scatter"===c){var i=a(d.position);f="M"+i.toString()+" "+b.range()[1].toString()+" L "+i.toString()+" "+b.range()[0].toString()}else if("radial"===c){var g=a(Math.max(d.position-e,0));f="M "+g.toString()+"  "+b(0).toString()+" A "+(g-a(0)).toString()+" "+(b(d.position)-b(e)).toString()+" 0 1 0 "+g.toString()+" "+(b(0)+.001).toString()}}else if("y"===d.axis){var j=b(d.position);f="M".concat(a(e)+20," ").concat(j," L ").concat(a(h)," ").concat(j)}return f}},o=function(a,b){return function(c){return"x"===c.axis?"radial"===b?a(0):a(c.position):a.range()[0]-15}},p=function(a,b){return function(c){if("x"===c.axis){var d=c.position-e;return"radial"===b?a(Math.max(d,0))-5:a.range()[1]+18}return a(c.position)}},q=function(a){return function(b){return"x"===b.axis?"radial"===a?"end":"middle":"start"}};if("clock"===this.layout||"scatter"===this.layout){if("scatter"===this.layout&&"num_date"===this.scatterVariables.y){var t,j,r=aH(f,g,this.yScale.range()[1]-this.yScale.range()[0],"y");(j=d).push.apply(j,aB(r.majorGridPoints))}else if("scatter"!==this.layout||this.scatterVariables.yContinuous){var k,l,s=aF(f,g,a,1,"y");(l=d).push.apply(l,aB(s.majorGridPoints))}else(k=d).push.apply(k,aB(this.yScale.domain().map(function(a){return{name:a,visibility:"visible",axis:"y",position:a}})))}this.groups.majorGrid.selectAll("*").remove(),this.groups.majorGrid.selectAll(".majorGrid").data(d).enter().append("path").attr("d",i(this.xScale,this.yScale,a)).attr("class","majorGrid").style("fill","none").style("visibility",function(a){return a.visibility}).style("stroke",this.params.majorGridStroke).style("stroke-width",this.params.majorGridWidth),this.groups.minorGrid.selectAll("*").remove(),this.svg.selectAll(".minorGrid").remove(),this.groups.minorGrid.selectAll(".minorGrid").data(n).enter().append("path").attr("d",i(this.xScale,this.yScale,a)).attr("class","minorGrid").style("fill","none").style("visibility",function(a){return a.visibility}).style("stroke",this.params.minorGridStroke).style("stroke-width",this.params.minorGridWidth),this.groups.gridText.selectAll("*").remove(),this.svg.selectAll(".gridText").remove(),this.groups.gridText.selectAll(".gridText").data(d).enter().append("text").text(function(a){return a.name}).attr("class","gridText").style("font-size",this.params.tickLabelSize).style("font-family",this.params.fontFamily).style("fill",this.params.tickLabelFill).style("text-anchor",q(a)).style("visibility",function(a){return a.visibility}).attr("x",o(this.xScale,a)).attr("y",p(this.yScale,a)),this.groups.axisText.selectAll("*").remove(),this.svg.selectAll(".axisText").remove(),"clock"===a?(b="Date",c=(0,Q.jP)(this.yScale)?"Divergence":"Mutations"):"scatter"===a?("div"===(b=this.scatterVariables.xLabel)&&(b=(0,Q.jP)(this.xScale)?"Divergence":"Mutations"),"div"===(c=this.scatterVariables.yLabel)&&(c=(0,Q.jP)(this.yScale)?"Divergence":"Mutations")):"rect"===a&&(b="num_date"===this.distance?"Date":(0,Q.jP)(this.xScale)?"Divergence":"Mutations"),b&&this.groups.axisText.append("text").text(b).attr("class","gridText").style("font-size",this.params.tickLabelSize).style("font-family",this.params.fontFamily).style("fill",this.params.tickLabelFill).style("text-anchor","middle").attr("x",Math.abs(this.xScale.range()[1]-this.xScale.range()[0])/2).attr("y",parseInt(this.svg.attr("height"),10)-1),c&&this.groups.axisText.append("text").text(c).attr("class","gridText").style("font-size",this.params.tickLabelSize).style("font-family",this.params.fontFamily).style("fill",this.params.tickLabelFill).style("text-anchor","middle").attr("transform","translate(10,"+this.yScale.range()[1]/2+") rotate(-90)"),this.grid=!0}},a.prototype.showTemporalSlice=function(){if("rect"!==this.layout||"num_date"!==this.distance){this.hideTemporalSlice();return}var a=[this.xScale(this.dateRange[0]),this.xScale(this.dateRange[1])],f=this.yScale.range()[1],g="#EEE",d=-1===this.params.orientation[0],k=this.xScale(this.nodes[0].x),b=d?this.xScale.range()[0]:this.xScale.range()[1];if(b+=this.margins.left+this.margins.right,Math.abs(a[0]-k)>30){var e=a[0],h=0;d&&(e=b-a[0],h=a[0]);var l="1"===this.groups.temporalWindowStart.attr("opacity");this.groups.temporalWindowStart.attr("opacity",1).attr("height",f).attr("transform","translate(".concat(h,",0)")).attr("fill",g),l?this.groups.temporalWindowStart.transition("temporalWindowTransition").attr("width",e):this.groups.temporalWindowStart.attr("width",e)}else this.groups.temporalWindowStart.attr("opacity",0);var i=a[1],c=b-this.margins.right-a[1],j="translate(".concat(b-this.margins.right,",0) scale(-1,1)");if(d&&(i=this.margins.right,c=a[1]-this.margins.right,j="translate(".concat(i,",0)")),c>30){var m="1"===this.groups.temporalWindowEnd.attr("opacity");this.groups.temporalWindowEnd.attr("opacity",1).attr("height",f).attr("fill",g).attr("transform",j),m?this.groups.temporalWindowEnd.transition("temporalWindowTransition").attr("width",c):this.groups.temporalWindowEnd.attr("width",c)}else this.groups.temporalWindowEnd.attr("opacity",0)},a.prototype.hideTemporalSlice=function(){this.groups.temporalWindowStart.attr("opacity",0),this.groups.temporalWindowEnd.attr("opacity",0)};var aI=a,aJ=b(57605),e=b(37536),aK=b(6290);function aL(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function aM(b,a){return a||(a=b.slice(0)),Object.freeze(Object.defineProperties(b,{raw:{value:Object.freeze(a)}}))}function r(){var a=aM(["\n  border: 0px;\n  background-color: inherit;\n  cursor: pointer;\n  outline: 0;\n  text-decoration: underline;\n  font-size: 16px;\n  padding: 0px 0px;\n"]);return r=function(){return a},a}function s(){var a=aM(["\n  margin-top: 12px;\n  margin-bottom: 4px;\n"]);return s=function(){return a},a}function t(){var a=aM(["\n  padding-right: 8px;\n"]);return t=function(){return a},a}function u(){var a=aM(["\n"]);return u=function(){return a},a}function v(){var a=aM(["\n  margin: 0px 0px 4px 0px;\n  font-weight: 300;\n  font-size: 16px;\n"]);return v=function(){return a},a}function w(){var a=aM(["\n  font-weight: 500;\n  white-space: nowrap;\n  vertical-align: baseline;\n"]);return w=function(){return a},a}function x(){var a=aM(["\n  padding-left: 10px;\n  cursor: help;\n  color: #888;\n"]);return x=function(){return a},a}var aN=e.ZP.button.withConfig({componentId:"sc-96dbdfea-0"})(r()),aO=function(b,c){var a=[parseInt(b.slice(1,-1),10),parseInt(c.slice(1,-1),10)],d=a[0],e=a[1];return d<e?-1:1},aP=function(a){var b=[];return a.sort(aO).forEach(function(c,d){var a=parseInt(c.slice(1,-1),10);0===d||a!==b[b.length-1].end+1?b.push({start:a,end:a,count:1,char:c.slice(-1)}):(b[b.length-1].end=a,b[b.length-1].count+=1)}),b},aQ=e.ZP.p.withConfig({componentId:"sc-96dbdfea-1"})(s()),aR=e.ZP.span.withConfig({componentId:"sc-96dbdfea-2"})(t()),aS=e.ZP.span.withConfig({componentId:"sc-96dbdfea-3"})(u()),aT=e.ZP.p.withConfig({componentId:"sc-96dbdfea-4"})(v()),aU=e.ZP.td.withConfig({componentId:"sc-96dbdfea-5"})(w()),aV=function(a){var d,e,f=a.name,b=a.muts,h=a.displayAsIntervals,i=a.isNuc;if(h){var g=aP(b);e="".concat(f," (").concat(g.length," regions, ").concat(b.length).concat(i?"bp":" codons","):"),d=g.map(function(a){return 1===a.count?"".concat(a.start):"".concat(a.start,"..").concat(a.end," (").concat(a.count," ").concat(i?"bp":"codons",")")}).join(", ")}else e="".concat(f," (").concat(b.length,"):"),d=b.sort(aO).join(", ");return(0,c.jsxs)(aT,{children:[(0,c.jsx)(aR,{children:e},f),(0,c.jsx)(aS,{children:d})]})},aW={unique:"Unique",changes:"Changes",homoplasies:"Homoplasies",reversionsToRoot:"Reversions to root",undeletions:"Undeletions",gaps:"Gaps",ns:"Ns "},aX=e.ZP.span.withConfig({componentId:"sc-96dbdfea-6"})(x()),aY=(0,c.jsxs)("div",{children:["A summary of mutations inferred to have occurred on this branch. Mutations are grouped into one of the following (mutually exclusive) categories, with the first matching category used:",(0,c.jsxs)("ol",{children:[(0,c.jsx)("li",{children:"Undeletions: a change from a '-' character to a base; beware that these are often bioinformatics artifacts"}),(0,c.jsx)("li",{children:"Gaps: A change to a '-' character, indicating a missing base; these can indicate deletions but sometimes areas of no coverage are filled with gaps"}),(0,c.jsx)("li",{children:"Ns: Typically due to lack of sequence coverage or ambiguity at this position (Nucleotides only)"}),(0,c.jsx)("li",{children:"Homoplasies: a mutation that has also been observed elsewhere on the tree"}),(0,c.jsx)("li",{children:"Unique: Mutations which are only observed on this branch"})]}),"Reversions to Root is an additional category which highlights those mutations which return the state to that of the root. Mutations in this category will also appear one of the five categories listed above.",(0,c.jsx)("p",{}),"Gaps and Ns are grouped into intervals, as they frequently occur in succession. Click below to copy all changes to clipboard to see the full list."]}),aZ=(0,c.jsxs)("div",{children:["A summary of sequence changes between the root and the selected tip. Changes are grouped into one of the following (mutually exclusive) categories, with the first matching category used:",(0,c.jsxs)("ol",{children:[(0,c.jsx)("li",{children:"Gaps: A change to a '-' character, indicating a missing base; these can indicate deletions but sometimes areas of no coverage are filled with gaps"}),(0,c.jsx)("li",{children:"Ns: Typically due to lack of sequence coverage or ambiguity at this position (Nucleotides only)"}),(0,c.jsx)("li",{children:"Reversions to root: The tip state is the same as the root state, however this has changed and been reverted along the way"}),(0,c.jsx)("li",{children:"Changes: The tip state differs from the root state"})]}),"Gaps and Ns are grouped into intervals, as they frequently occur in succession. Click below to copy all changes to clipboard to see the full list."]}),a$=function(b){var d=b.node,f=b.geneSortFn,a=b.isTip,g=b.observedMutations,e=a?(0,$.Wf)(d):(0,$.MS)(d,g);return 0===Object.keys(e).length?(0,c.jsx)(aQ,{children:a?"No sequence changes observed":"No mutations observed on branch"}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(aQ,{children:[a?"Sequence changes observed (from root)":"Mutations observed on branch",(0,c.jsx)(aX,{"data-tip":!0,"data-for":"seqChangesInfo",children:(0,c.jsx)(B.DAO,{})})]}),(0,c.jsx)(aK.mi,{place:"bottom",type:"light",effect:"solid",id:"seqChangesInfo",children:a?aZ:aY}),(0,c.jsx)("table",{children:(0,c.jsxs)("tbody",{children:[Object.keys(e).sort(f).map(function(b){var a,d;return a=b,d=e[b],0===Object.values(d).filter(function(a){return a.length}).length?null:(0,c.jsxs)("tr",{children:[(0,c.jsx)(aU,{children:"nuc"===a?"Nt":a}),(0,c.jsx)("td",{children:Object.entries(aW).map(function(i){var e,f,g=(f=2,function(a){if(Array.isArray(a))return a}(e=i)||function(b,e){var f,g,a=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=a){var c=[],d=!0,h=!1;try{for(a=a.call(b);!(d=(f=a.next()).done)&&(c.push(f.value),!e||c.length!==e);d=!0);}catch(i){h=!0,g=i}finally{try{d||null==a.return||a.return()}finally{if(h)throw g}}return c}}(e,f)||function(a,c){if(a){if("string"==typeof a)return aL(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return aL(a,c)}}(e,f)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),b=g[0],h=g[1];return b in d&&d[b].length?(0,c.jsx)(aV,{name:h,muts:d[b],displayAsIntervals:"gaps"===b||"ns"===b||"undeletions"===b,isNuc:"nuc"===a},h):null})})]},a)}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{}),(0,c.jsx)("td",{children:(0,c.jsx)(aN,{onClick:function(){var a,b;navigator.clipboard.writeText((a=e,b=f,Object.keys(a).sort(b).map(function(b){return Object.keys(aW).filter(function(c){return c in a[b]&&a[b][c].length}).map(function(c){return"".concat(b,"	").concat(c,"	").concat(a[b][c].sort(aO).join(", "))})}).flat().join("\n")))},children:"Click to copy all ".concat(a?"changes":"mutations"," to clipboard as TSV")})})]})]})})]})};function a_(b,c,d,e){var a=(0,$.rs)(c,d);"num_date"===d&&a&&(a=(0,I.hT)(a));var f=!c.hasChildren;return e?f?a?b("Branch leading to {{tipLabel}}",{tipLabel:a}):b("Terminal branch"):b("Internal branch"):a}function a0(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function a1(a,b){return function(a){if(Array.isArray(a))return a}(a)||function(b,e){var f,g,a=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=a){var c=[],d=!0,h=!1;try{for(a=a.call(b);!(d=(f=a.next()).done)&&(c.push(f.value),!e||c.length!==e);d=!0);}catch(i){h=!0,g=i}finally{try{d||null==a.return||a.return()}finally{if(h)throw g}}return c}}(a,b)||a2(a,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a2(a,c){if(a){if("string"==typeof a)return a0(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return a0(a,c)}}var a3=function(b){var d=b.name,a=b.value,e=b.padBelow;return(0,c.jsxs)("div",{style:{paddingBottom:void 0!==e&&e?"15px":"10px"},children:[(0,c.jsx)("span",{style:{fontWeight:"500"},children:d+" "}),a||0===a?Array.isArray(a)?a.map(function(a){return(0,c.jsx)("div",{style:{fontWeight:"300",marginLeft:"0em"},children:a},a)}):(0,c.jsx)("span",{style:{fontWeight:"300"},children:a}):null]},d)},a4=function(g){var f=g.node,d=g.t,a=[],h=(0,$.KT)(f),i=(0,$.rs)(f,"num_date");if(h&&a.push((0,c.jsx)(a3,{name:d("Divergence")+":",value:(0,Q.dX)(h)},"div")),void 0!==i){var j=(0,I.hT)(i),b=(0,$.rs)(f,"num_date",{confidence:!0});if(b&&b[0]!==b[1]){a.push((0,c.jsx)(a3,{name:d("Inferred Date")+":",value:j},"inferredDate"));var e=[(0,I.hT)(b[0]),(0,I.hT)(b[1])];e[0]!==e[1]&&a.push((0,c.jsx)(a3,{name:d("Date Confidence Interval")+":",value:"(".concat(e[0],", ").concat(e[1],")")},"dateConf"))}else a.push((0,c.jsx)(a3,{name:d("Date")+":",value:j},"date"))}return a},a5=function(b){var d=b.node,a=b.colorBy,o=b.colorByConfidence,i=b.colorScale,f=b.colorings;if("num_date"===a)return null;if((0,aJ.O$)(a)){var g=(0,aJ.kW)(a),p=g.aa?"Amino Acid at ".concat(g.gene," site ").concat(g.positions.join(", "),":"):"Nucleotide at pos ".concat(g.positions.join(", "),":");return(0,c.jsx)(a3,{name:p,value:(0,H.BG)(d,i)})}if("author"===a){var e=(0,$.ZZ)(d);return e?(0,c.jsxs)(c.Fragment,{children:[e.title?(0,c.jsx)(a3,{name:"Title:",value:e.title}):null,e.journal?(0,c.jsx)(a3,{name:"Journal:",value:e.journal}):null]}):null}var k=f&&f[a]&&f[a].title?f[a].title:a,l=(0,$.rs)(d,a);if("temporal"===i.scaleType&&"number"==typeof l)return(0,c.jsx)(a3,{name:"".concat(k,":"),value:(0,I.hT)(l)});var m=function(){return(0,j.mg)(l)?(0,c.jsx)(a3,{name:"".concat(k,":"),value:l}):null};if(!0===o){var h=(0,$.rs)(d,a,{confidence:!0});if(!h)return console.error("couldn't find confidence vals for ",a),null;if(!d.hasChildren&&1===Object.keys(h).length&&Object.values(h)[0]>.99)return m();var n=Object.keys(h).filter(function(a){return(0,j.mg)(a)}).sort(function(a,b){return h[a]>h[b]?-1:1}).slice(0,4).map(function(a){return"".concat(a," (").concat((100*h[a]).toFixed(0),"%)")});return n.length?(0,c.jsx)(a3,{name:"".concat(k," (confidence):"),value:n}):null}return m()},a6=function(d){var i=d.node,e=d.t,f=(0,$.Wf)(i);if(!f.nuc)return null;var a={changes:0,gaps:0,reversionsToRoot:0,ns:0},b={changes:0,gaps:0,reversionsToRoot:0};Object.keys(f).forEach(function(c){Object.entries(f[c]).forEach(function(g){var d=a1(g,2),e=d[0],f=d[1];"nuc"===c?a[e]+=f.length:b[e]+=f.length})});var g="".concat(a.changes).concat(a.reversionsToRoot?" + ".concat(a.reversionsToRoot," reversions to root"):"");g+="".concat(a.gaps?" + ".concat(a.gaps," gaps"):"").concat(a.nt?" + ".concat(a.nt," Ns"):"");var h="".concat(b.changes).concat(b.reversionsToRoot?" + ".concat(b.reversionsToRoot," reversions to root"):"");return h+="".concat(b.gaps?" + ".concat(b.gaps," gaps"):""),[(0,c.jsx)(a3,{name:e("Nucleotide changes")+":",value:g},"nuc"),(0,c.jsx)(a3,{name:e("Amino Acid changes")+":",value:h},"aa")]},a7=function(d){var e=d.node,s=d.geneSortFn,t=d.observedMutations,g=d.t;if(!e.branch_attrs||!e.branch_attrs.mutations)return null;var b=[],f=e.branch_attrs.mutations,a=(0,$.MS)(e,t),j=function(a,b){return a.slice(0,Math.min(b,a.length)).join(", ")+(a.length>b?" + ".concat(a.length-b," more"):"")};if(a.nuc){var k=5;if(a.nuc.unique.length&&b.push((0,c.jsx)(a3,{name:"Unique Nucleotide mutations:",value:j(a.nuc.unique,k)},"nuc_unique")),a.nuc.homoplasies.length&&b.push((0,c.jsx)(a3,{name:"Homoplasic mutations:",value:j(a.nuc.homoplasies,k)},"nuc_homoplasies")),a.nuc.reversionsToRoot.length&&b.push((0,c.jsx)(a3,{name:"Reversions to Root:",value:a.nuc.reversionsToRoot.length},"nuc_rtr")),a.nuc.gaps.length){var u="".concat(aP(a.nuc.gaps).length," regions, ").concat(a.nuc.gaps.length,"bp.");b.push((0,c.jsx)(a3,{name:"Gaps:",value:u},"nuc_gaps"))}if(a.nuc.undeletions.length){var v="".concat(aP(a.nuc.undeletions).length," regions, ").concat(a.nuc.undeletions.length,"bp.");b.push((0,c.jsx)(a3,{name:"Undeletions:",value:v},"nuc_undeletions"))}if(a.nuc.ns.length){var w="".concat(aP(a.nuc.ns).length," regions, ").concat(a.nuc.ns.length,"bp.");b.push((0,c.jsx)(a3,{name:"Ns:",value:w},"nuc_ns"))}}else b.push((0,c.jsx)(a3,{name:g("No nucleotide mutations"),value:""},"nuc"));var x=Object.keys(f).sort(s).filter(function(a){return"nuc"!==a}),l={},m=!1,h=!0,n=!1,o=void 0;try{for(var p,i=x[Symbol.iterator]();!(h=(p=i.next()).done);h=!0){var q=p.value,r=f[q].filter(function(a){return!a.endsWith("X")});r.length&&(l[q]=r,m=!0)}}catch(y){n=!0,o=y}finally{try{h||null==i.return||i.return()}finally{if(n)throw o}}if(m){var A=3,B=7,z=[];Object.keys(l).forEach(function(a,b){if(b<B){var c=a+":\xa0\xa0"+l[a].slice(0,Math.min(A,l[a].length)).join(", ");l[a].length>A&&(c+=" + "+g("{{x}} more",{x:l[a].length-A})),z.push(c)}else b===B&&z.push("(".concat(g("protein mutations truncated"),")"))}),b.push((0,c.jsx)(a3,{name:g("AA mutations")+":",value:z},"aa"))}else f.nuc&&f.nuc.length&&b.push((0,c.jsx)(a3,{name:g("No amino acid mutations")},"aa"));return b},a8=function(a){var b=a.node,d=a.t,f=a.tipLabelKey,e=a1(1===b.fullTipCount?[a_(d,b,f,!0),""]:[d("Number of descendants")+":",b.fullTipCount],2),g=e[0],h=e[1];return(0,c.jsx)(a3,{name:g,value:h,padBelow:!0})},a9=function(e){var f=e.node,d=e.t,a=(0,$.nt)(f);if(!a)return null;var b=[];return a.selection_date&&b.push((0,c.jsx)(a3,{name:d("Vaccine selected")+":",value:a.selection_date},"seldate")),a.start_date&&b.push((0,c.jsx)(a3,{name:d("Vaccine start date")+":",value:a.start_date},"startdate")),a.end_date&&b.push((0,c.jsx)(a3,{name:d("Vaccine end date")+":",value:a.end_date},"enddate")),a.serum&&b.push((0,c.jsx)(a3,{name:d("Serum strain")},"serum")),b},ba=function(f){var b=f.node,a=[],d=(0,$.ZZ)(b);d&&a.push((0,c.jsx)(a3,{name:"Author:",value:d.value},"author"));var e=(0,$.rs)(b,"gisaid_epi_isl");if((0,j.mg)(e)){var g=e.split("_")[2];a.push((0,c.jsx)(a3,{name:"GISAID EPI ISL:",value:g},"gisaid_epi_isl"))}return a},bb=function(e){var d=e.node,a=e.panelDims,i=e.children,h=200;h=a.width<420?200:a.width<460?220:a.width<500?240:a.width<540?260:280;var f=-1===d.shell.that.params.orientation[0]?a.width/2+a.spaceBetweenTrees+d.shell.xTip:d.shell.xTip,g=d.shell.yTip,b={container:{position:"absolute",width:h,padding:"10px",borderRadius:10,zIndex:1e3,pointerEvents:"none",fontFamily:F.fu.panel.fontFamily,fontSize:14,lineHeight:1,fontWeight:F.fu.panel.fontWeight,color:F.fu.panel.color,backgroundColor:F.fu.panel.backgroundColor,wordWrap:"break-word",wordBreak:"break-word"}};return f<.5*a.width?b.container.left=f+10:b.container.right=a.width-f+10,g<.55*a.height?b.container.top=g+40:b.container.bottom=a.height-g+10,(0,c.jsx)("div",{style:b.container,children:(0,c.jsx)("div",{className:"tooltip",style:F.fu.tooltip,children:i})})},bc=function(a){var b=a.children;return(0,c.jsx)("div",{style:F.fu.comment,children:b})},bd=function(b){var e=b.selectedNode,g=b.colorBy,h=b.colorByConfidence,i=b.colorScale,l=b.panelDims,k=b.colorings,m=b.geneSortFn,n=b.observedMutations,f=b.tipLabelKey,d=b.t;if(!e)return null;var a=e.node.n,o=(0,Q.uN)(a);return(0,c.jsx)(bb,{node:a,panelDims:l,children:!1===e.isBranch?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:F.fu.tooltipHeading,children:a_(d,a,f,!1)}),f!==j.Ac&&(0,c.jsx)(a3,{name:"Node name:",value:a.name}),(0,c.jsx)(a9,{node:a,t:d}),(0,c.jsx)(a6,{node:a,t:d}),(0,c.jsx)(a4,{node:a,t:d}),(0,c.jsx)(a5,{node:a,colorBy:g,colorByConfidence:h,colorScale:i,colorings:k}),(0,c.jsx)(ba,{node:a}),(0,c.jsx)(bc,{children:d("Click on tip to display more info")})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(a8,{node:a,t:d,tipLabelKey:f}),(0,c.jsx)(a7,{node:a,geneSortFn:m,observedMutations:n,t:d}),(0,c.jsx)(a4,{node:a,t:d}),(0,c.jsx)(a5,{node:a,colorBy:g,colorByConfidence:h,colorScale:i,colorings:k}),(0,c.jsx)(bc,{children:d(o===a.arrayIdx?"Click to zoom out to parent clade":"Click to zoom into clade")}),(0,c.jsx)(bc,{children:d("Shift + Click to display more info")})]})})};function be(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var bf=function(a){a||(a=window.event),a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()},bg=function(a,b,d){return(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{style:F.fu.item,children:a}),(0,c.jsx)("td",{style:F.fu.item,children:d?(0,c.jsx)("a",{href:d,target:"_blank",rel:"noopener noreferrer",children:b}):b})]},a)},bh=function(a){var b=a.url,d=a.title,e=a.value;return(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{style:F.fu.item,children:d}),(0,c.jsx)("td",{style:F.fu.item,children:(0,c.jsx)("a",{href:b,target:"_blank",rel:"noopener noreferrer",children:e})})]})},bi=function(l){var g=l.node,a=(0,$.rs)(g,"gisaid_epi_isl"),b=(0,$.rs)(g,"genbank_accession"),d=null,h=null;if((0,j.mg)(a)){if(new RegExp("EPI_ISL_[0-9]{5,}").test(a)){var i=a.split("_")[2];d="https://www.epicov.org/acknowledgement/"+i.slice(-4,-2)+"/"+i.slice(-2)+"/"+a+".json"}else d="https://gisaid.org"}if((0,j.mg)(b)&&(h="https://www.ncbi.nlm.nih.gov/nuccore/"+b),(0,j.mg)(a)&&(0,j.mg)(b))return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(bh,{title:"GISAID EPI ISL",value:a,url:d}),(0,c.jsx)(bh,{title:"Genbank accession",value:b,url:h})]});if((0,j.mg)(a))return(0,c.jsx)(bh,{title:"GISAID EPI ISL",value:a,url:d});if((0,j.mg)(b))return(0,c.jsx)(bh,{title:"Genbank accession",value:b,url:h});var k=(0,$.Bu)(g),e=k.accession,f=k.url;return e&&f?(0,c.jsx)(bh,{url:f,value:e,title:"Accession"}):e?bg("Accession",e):f?(0,c.jsx)(bh,{title:"Strain URL",url:f,value:"click here"}):null},bj=function(e){var f=e.node,d=e.t,a=(0,$.nt)(f);if(!a)return null;var b=[];return a.selection_date&&b.push((0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:d("Vaccine selected")}),(0,c.jsx)("td",{children:a.selection_date})]},"seldate")),a.start_date&&b.push((0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:d("Vaccine start date")}),(0,c.jsx)("td",{children:a.start_date})]},"startdate")),a.end_date&&b.push((0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:d("Vaccine end date")}),(0,c.jsx)("td",{children:a.end_date})]},"enddate")),a.serum&&b.push((0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:d("Serum strain")}),(0,c.jsx)("td",{})]},"serum")),b},bk=function(d){var e=d.node,c=d.t,a=(0,$.ZZ)(e);if(!a)return null;var b=[];return b.push(bg(c("Authors"),a.value)),a.title&&"?"!==a.title&&(a.paper_url&&"?"!==a.paper_url?b.push(bg(c("Title"),a.title,a.paper_url)):b.push(bg(c("Title"),a.title))),a.journal&&"?"!==a.journal&&b.push(bg(c("Journal"),a.journal)),1===b.length?b[0]:b},bl=function(a){var b=a.children;return(0,c.jsx)("p",{style:F.fu.modalHeading,children:b})},bm=function(d){var f=d.isTerminal,g=d.node,e=d.t,b=(0,$.rs)(g,"num_date");if(!b)return null;var a=(0,$.rs)(g,"num_date",{confidence:!0});return b&&a&&a[0]!==a[1]?(0,c.jsxs)(c.Fragment,{children:[bg(e(f?"Inferred collection date":"Inferred date"),(0,I.hT)(b)),bg(e("Date Confidence Interval"),"(".concat((0,I.hT)(a[0]),", ").concat((0,I.hT)(a[1]),")"))]}):bg(e(f?"Collection date":"Inferred date"),(0,I.hT)(b))},bn=function(a){if(!a.node_attrs)return[];var b=["author","div","num_date","gisaid_epi_isl","genbank_accession","accession","url"];return Object.keys(a.node_attrs).filter(function(a){return!b.includes(a)})},bo=function(e){var g,h=e.node,b=e.trait,d=e.colorings,m=e.isTerminal,a=(0,$.rs)(h,b),f=(0,$.rs)(h,b,{confidence:!0}),k=(null===(g=d[b])|| void 0===g?void 0:g.type)==="temporal";if("number"!=typeof a||k||Number.isInteger(a)||(a=Number.parseFloat(a).toPrecision(3)),!(0,j.mg)(a))return null;f&&a in f&&(!m||f[a]<.99)&&(a="".concat(a," (").concat((100*f[a]).toFixed(0),"%)"));var i=d&&d[b]&&d[b].title?d[b].title:b;if(k&&"number"==typeof a)return bg(i,(0,I.hT)(a));var l=(0,$.eD)(h,b);return l?(0,c.jsx)(bh,{title:i,url:l,value:a}):bg(i,a)},bp=function(b){var g,f=b.selectedNode,l=b.nodesLhsTree,m=b.nodesRhsTree,q=b.clearSelectedNode,r=b.colorings,n=b.observedMutations,o=b.geneSortFn,i=b.tipLabelKey,d=b.t;if(!f)return null;var a=null===(g=f.treeId===bW?l:m)|| void 0===g?void 0:g[f.idx];if(!a)return console.error("Internal error retrieving selected node"),null;var k=function(d){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{},b=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(b=b.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),b.forEach(function(a){be(d,a,c[a])})}return d}({},F.fu.panel);k.maxHeight="70%";var h=!a.hasChildren,e=!f.isBranch,p=i!==j.Ac||!h;return(0,c.jsx)("div",{style:F.fu.modalContainer,onClick:function(){return q(f)},children:(0,c.jsxs)("div",{className:"panel",style:k,onClick:function(a){return bf(a)},children:[(0,c.jsx)(bl,{children:a_(d,a,i,!e)}),(0,c.jsx)("table",{children:(0,c.jsxs)("tbody",{children:[!h&&bg(d("Number of terminal tips"),a.fullTipCount),p&&bg(d("Node name"),a.name),e&&(0,c.jsx)(bj,{node:a,t:d}),(0,c.jsx)(bm,{isTerminal:h,node:a,t:d}),e&&(0,c.jsx)(bk,{node:a,t:d}),bn(a).map(function(b){return(0,c.jsx)(bo,{node:a,trait:b,colorings:r,isTerminal:h},b)}),e&&(0,c.jsx)(bi,{node:a}),bg("","")]})}),(0,c.jsx)(a$,{node:a,geneSortFn:o,isTip:e,observedMutations:n}),(0,c.jsx)("p",{style:F.fu.comment,children:d("Click outside this box to go back to the tree")})]})})},bq=function(f,g,c,a){var b={},h={},e=f?c.tree:c.treeToo,d=f?a.tree:a.treeToo,i=e.idxOfInViewRootNode!==d.idxOfInViewRootNode,k=c.dateMinNumeric!==a.dateMinNumeric||c.dateMaxNumeric!==a.dateMaxNumeric,l=c.filters!==a.filters;if(g.dateRange=[a.dateMinNumeric,a.dateMaxNumeric],d.nodeColorsVersion&&(e.nodeColorsVersion!==d.nodeColorsVersion||a.colorByConfidence!==c.colorByConfidence)&&(b.changeColorBy=!0,b.branchStroke=(0,H.qL)(d,!0,a.colorByConfidence,a.colorBy),b.tipStroke=(0,H.qL)(d,!1,a.colorByConfidence,a.colorBy),b.fill=b.tipStroke.map(H.m6)),d.visibilityVersion&&e.visibilityVersion!==d.visibilityVersion&&(b.changeVisibility=!0,b.visibility=d.visibility),d.tipRadiiVersion&&e.tipRadiiVersion!==d.tipRadiiVersion&&(b.changeTipRadii=!0,b.tipRadii=d.tipRadii),e.branchThicknessVersion!==d.branchThicknessVersion&&(b.changeBranchThickness=!0,b.branchThickness=d.branchThickness),c.distanceMeasure!==a.distanceMeasure&&(b.newDistance=a.distanceMeasure),c.explodeAttr!==a.explodeAttr&&(b.changeNodeOrder=!0,b.focus=a.focus),c.focus!==a.focus?(b.focus=a.focus,b.updateLayout=!0):!0===c.focus&& !0===a.focus&&(i||k||l)&&(b.focus=!0,b.updateLayout=!0),!0===c.canRenderBranchLabels&& !1===a.canRenderBranchLabels?b.newBranchLabellingKey="none":(!1===c.canRenderBranchLabels&& !0===a.canRenderBranchLabels||c.selectedBranchLabel!==a.selectedBranchLabel|| !1===c.scatterVariables.showBranches&& !0===a.scatterVariables.showBranches)&&(b.newBranchLabellingKey=a.selectedBranchLabel),c.showAllBranchLabels!==a.showAllBranchLabels&&(b.showAllBranchLabels=a.showAllBranchLabels),c.tipLabelKey!==a.tipLabelKey&&(b.newTipLabelKey=a.tipLabelKey),!0===c.temporalConfidence.display&& !1===a.temporalConfidence.display|| !0===c.temporalConfidence.on&& !1===a.temporalConfidence.on?b.removeConfidences=!0:!0===a.temporalConfidence.display&& !1===c.temporalConfidence.on&& !0===a.temporalConfidence.on&&(b.showConfidences=!0),("scatter"===a.layout||"clock"===a.layout)&&c.scatterVariables!==a.scatterVariables&&(b.updateLayout=!0,b.scatterVariables=a.scatterVariables),c.layout!==a.layout&&(b.newLayout=a.layout),i){var m=g.nodes[d.idxOfInViewRootNode];b.zoomIntoClade=m,h.selectedNode={},"unrooted"===a.layout&&(b.updateLayout=!0)}(c.width!==a.width||c.height!==a.height)&&(b.svgHasChangedDimensions=!0),f&&c.showTreeToo!==a.showTreeToo&&(b.svgHasChangedDimensions=!0);var j=Object.keys(b).length;return j&&(b.animationInProgress="Pause"===a.animationPlayPauseButton,g.change(b)),[!!Object.keys(h).length&&h,j]},br=function(a){a.visibility===j.m7&&((1===a.that.params.orientation[0]?this.state.tree:this.state.treeToo).svg.select("#"+(0,Q.yQ)("tip",a.n.name)).attr("r",function(a){return a.r+4}),this.setState({hoveredNode:{node:a,isBranch:!1}}))},bs=function(a){a.visibility===j.m7&&(this.props.narrativeMode||(this.props.dispatch({type:J.c7,name:a.n.name,idx:a.n.arrayIdx,isBranch:!1,treeId:a.that.id}),this.props.dispatch((0,C.Rb)("add",j.Ac,[a.n.name]))))},bt=function(a){if(a.visibility===j.m7){if(Y(a),this.props.temporalConfidence.exists&&this.props.temporalConfidence.display&&!this.props.temporalConfidence.on){var b=1===a.that.params.orientation[0]?this.state.tree:this.state.treeToo;"confidenceIntervals"in b.groups||(b.groups.confidenceIntervals=b.svg.append("g").attr("id","confidenceIntervals")),b.groups.confidenceIntervals.selectAll(".conf").data([a]).enter().call(function(a){return b.drawSingleCI(a,.5)})}this.setState({hoveredNode:{node:a,isBranch:!0}})}},bu=function(a){if(a.visibility===j.m7&&!this.props.narrativeMode){if(window.event.shiftKey){this.props.dispatch({type:J.c7,name:a.n.name,idx:a.n.arrayIdx,isBranch:!0,treeId:a.that.id});return}var d,b,c=[void 0,void 0];if(a.n.branch_attrs&& void 0!==a.n.branch_attrs.labels&&(b=Object.keys(a.n.branch_attrs.labels).filter(function(a){return"aa"!==a})),b&&b.length){var h=this.props.tree.availableBranchLabels;b.sort(function(a,b){return h.indexOf(a)-h.indexOf(b)});var e=b[0];d="".concat(e,":").concat(a.n.branch_attrs.labels[e])}var g=1===a.that.params.orientation[0]?this.props.tree.observedMutations:this.props.treeToo.observedMutations,f=(0,Q.uN)(a.n)===a.n.arrayIdx?(0,Q.s7)(a.n,this.props.distanceMeasure,g).arrayIdx:a.n.arrayIdx;1===a.that.params.orientation[0]?c[0]=f:c[1]=f,this.props.dispatch((0,C.ss)({root:c,cladeSelected:d}))}},bv=function(a){X(a),this.props.temporalConfidence.exists&&this.props.temporalConfidence.display&&!this.props.temporalConfidence.on&&(1===a.that.params.orientation[0]?this.state.tree:this.state.treeToo).removeConfidence(),this.setState({hoveredNode:null})},bw=function(a){var b=1===a.that.params.orientation[0]?this.state.tree:this.state.treeToo;this.state.hoveredNode&&b.svg.select("#"+(0,Q.yQ)("tip",a.n.name)).attr("r",function(a){return a.r}),this.setState({hoveredNode:null})},bx=function(a){a.isBranch||(a.existingFilterState?"inactive"===a.existingFilterState&&this.props.dispatch((0,C.Rb)("inactivate",j.Ac,[a.name])):this.props.dispatch((0,C.Rb)("remove",j.Ac,[a.name]))),this.props.dispatch({type:J.q$})},by=b(82250),bz=function(b,d,g,a){var h=d?b.domRefs.mainTree:b.domRefs.secondTree,c=d?a.tree:a.treeToo;if(!c.loaded){console.warn("can't run renderTree (not loaded)");return}var e=a.canRenderBranchLabels;Object.prototype.hasOwnProperty.call(a.scatterVariables,"showBranches")&& !1===a.scatterVariables.showBranches&&(e=!1);var f=(0,H.qL)(c,!1,a.colorByConfidence,a.colorBy);g.render((0,by.Z)(h),a.layout,a.distanceMeasure,a.focus,{grid:!0,confidence:a.temporalConfidence.display,branchLabelKey:e&&a.selectedBranchLabel,showAllBranchLabels:a.showAllBranchLabels,orientation:d?[1,1]:[-1,1],tipLabels:!0,showTipLabels:!0},{onTipHover:br.bind(b),onTipClick:bs.bind(b),onBranchHover:bt.bind(b),onBranchClick:bu.bind(b),onBranchLeave:bv.bind(b),onTipLeave:bw.bind(b),tipLabel:ac(a.tipLabelKey)},c.branchThickness,c.visibility,a.temporalConfidence.on,c.vaccines,(0,H.qL)(c,!0,a.colorByConfidence,a.colorBy),f,f.map(H.m6),c.tipRadii,[a.dateMinNumeric,a.dateMaxNumeric],a.scatterVariables)};function bA(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function bB(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function bC(a){return(bC=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function bD(d){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{},b=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(b=b.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),b.forEach(function(a){bB(d,a,c[a])})}return d}function bE(a,b){return(bE=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}var bF=function(f){"use strict";!function(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&bE(b,a)}(e,f);var g,h,a,b,d,i=(g=e,h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var b,d,a,c,e=bC(g);if(h){var f=bC(this).constructor;c=Reflect.construct(e,arguments,f)}else c=e.apply(this,arguments);return d=this,(a=c)&&("object"==((b=a)&&"undefined"!=typeof Symbol&&b.constructor===Symbol?"symbol":typeof b)||"function"==typeof a)?a:function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(d)});function e(b){var a;return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,e),(a=i.call(this,b)).state={left:0,top:31,lookup:void 0,drawn:!1},a.timeout=!1,a}return a=e,b=[{key:"shouldComponentUpdate",value:function(a){return this.props.width!==a.width||this.props.height!==a.height||this.props.leftTreeName!==a.leftTreeName||this.props.rightTreeName!==a.rightTreeName}},{key:"drawLines",value:function(a){a||(a=this.props);var b,c=a.lookup.length>750?.25:a.lookup.length>100?.5:1;(0,by.Z)(this.d3ref).selectAll("*").remove();var d=(b=a,function(a){var c=b.leftNodes[a[0]].shell,d=b.rightNodes[a[1]].shell;return"M ".concat(c.xTip,",").concat(c.yTip," H ").concat(b.width/2-b.spaceBetweenTrees/2," L ").concat(b.width/2+b.spaceBetweenTrees/2,",").concat(d.yTip," H ").concat(b.width/2+b.spaceBetweenTrees/2+d.xTip)});(0,by.Z)(this.d3ref).selectAll(".tangleLine").data(a.lookup).enter().append("path").attr("class","tangleLine").attr("d",d).attr("stroke-width",c).attr("stroke",function(b){return a.colors[b[0]]}).attr("fill","none")}},{key:"UNSAFE_componentWillReceiveProps",value:function(a){!this.state.drawn&&a.rightNodes[0].shell&&(this.drawLines(a),this.setState({drawn:!0}))}},{key:"componentDidMount",value:function(){!this.state.drawn&&this.props.rightNodes[0].shell&&(this.drawLines(this.props),this.setState({drawn:!0}))}},{key:"componentDidUpdate",value:function(a){(this.props.width!==a.width||this.props.height!==a.height)&&(this.timeout?window.clearTimeout(this.timeout):(0,by.Z)(this.d3ref).selectAll(".tangleLine").remove(),this.timeout=window.setTimeout(this.drawLines.bind(this),1e3))}},{key:"render",value:function(){var d=this,a={position:"absolute",top:5,zIndex:100,fontSize:16,color:"#000",fontWeight:500},b=[this.props.width/2-this.props.spaceBetweenTrees/2,this.props.width/2+this.props.spaceBetweenTrees/2];return(0,c.jsxs)("div",{id:"TangleContainer",children:[(0,c.jsx)("div",{id:"MainTreeTitle",style:bD({},a,{left:b[0],transform:"translateX(-100%)"}),children:this.props.leftTreeName}),(0,c.jsx)("div",{id:"SecondTreeTitle",style:bD({},a,{left:b[1]}),children:this.props.rightTreeName}),(0,c.jsx)("div",{id:"TangleSvgContainer",style:{position:"absolute",left:this.state.left,top:this.state.top,zIndex:100,pointerEvents:"none"},children:(0,c.jsx)("svg",{id:"Tangle",style:{cursor:"default",width:this.props.width,height:this.props.height},ref:function(a){d.d3ref=a}})})]})}}],bA(a.prototype,b),d&&bA(a,d),e}(f.Component);function bG(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function bH(a){return(bH=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function bI(a,b){return(bI=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}var bJ=function(f){"use strict";!function(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&bI(b,a)}(e,f);var g,h,a,d,b,i=(g=e,h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var b,d,a,c,e=bH(g);if(h){var f=bH(this).constructor;c=Reflect.construct(e,arguments,f)}else c=e.apply(this,arguments);return d=this,(a=c)&&("object"==((b=a)&&"undefined"!=typeof Symbol&&b.constructor===Symbol?"symbol":typeof b)||"function"==typeof a)?a:function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(d)});function e(b){var a;return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,e),(a=i.call(this,b)).state={hasError:!1},a}return a=e,b=[{key:"getDerivedStateFromError",value:function(){return{hasError:!0}}}],d=[{key:"componentDidCatch",value:function(a,b){console.error(a),console.error(b)}},{key:"render",value:function(){return this.state.hasError?this.props.showNothing?null:(0,c.jsx)("h1",{children:"Something went wrong."}):this.props.children}}],bG(a.prototype,d),b&&bG(a,b),e}(f.Component),bK=function(k,l){for(var a=0,b=0,c=0,e=0,f=0,g=0,h=0;h<l.nodes.length;h++){var d=l.nodes[h];if(!d.n.children&&k.strainToNode[d.n.name]){var i=k.strainToNode[d.n.name].displayOrder,j=d.displayOrder;a++,b+=i,c+=j,e+=Math.pow(i,2),f+=Math.pow(j,2),g+=i*j}}return b/=a,c/=a,e/=a,f/=a,g/=a,(g-b*c)/Math.sqrt((e-Math.pow(b,2))*(f-Math.pow(c,2)))},bL=function(f,b){for(var g=bK(f,b),d=0;d<b.nodes.length;d++){var e=b.nodes[d],c=e.n;if(c.children){for(var a=c;a.hasChildren;){var j=a.children[0];a.children.forEach(function(a){a.shell.displayOrder<j.shell.displayOrder&&(j=a)}),a=j}var h=a.shell.displayOrder-1;c.children.reverse(),(0,Q.gH)(e,h);var i=bK(f,b);g>i?(c.children.reverse(),(0,Q.gH)(e,h)):g=i}}},bM=function(b,a){bL(b,a),(0,Q.Td)({nodes:a.nodes,focus:!1})};function bN(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function bO(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function bP(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function bQ(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function bR(a){return(bR=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function bS(d){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{},b=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(b=b.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),b.forEach(function(a){bQ(d,a,c[a])})}return d}function bT(a,b){return(bT=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}function bU(a,b){return function(a){if(Array.isArray(a))return a}(a)||function(b,e){var f,g,a=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=a){var c=[],d=!0,h=!1;try{for(a=a.call(b);!(d=(f=a.next()).done)&&(c.push(f.value),!e||c.length!==e);d=!0);}catch(i){h=!0,g=i}finally{try{d||null==a.return||a.return()}finally{if(h)throw g}}return c}}(a,b)||bV(a,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bV(a,c){if(a){if("string"==typeof a)return bN(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return bN(a,c)}}var bW="LEFT",y=function(f){"use strict";!function(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),a&&bT(b,a)}(e,f);var g,h,a,b,d,i=(g=e,h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}(),function(){var b,d,a,c,e=bR(g);if(h){var f=bR(this).constructor;c=Reflect.construct(e,arguments,f)}else c=e.apply(this,arguments);return d=this,(a=c)&&("object"==((b=a)&&"undefined"!=typeof Symbol&&b.constructor===Symbol?"symbol":typeof b)||"function"==typeof a)?a:bO(d)});function e(b){var a;return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,e),bQ(bO(a=i.call(this,b)),"redrawTree",function(){a.props.dispatch((0,C.ss)({root:[0,0]}))}),bQ(bO(a),"handlekeydownEvent",function(b){"Escape"===b.key&&a.props.selectedNode&&a.clearSelectedNode(a.props.selectedNode)}),bQ(bO(a),"getStyles",function(){var d=!!a.props.tree.idxOfFilteredRoot&&a.props.tree.idxOfInViewRootNode!==a.props.tree.idxOfFilteredRoot,e=!!a.props.treeToo.idxOfFilteredRoot&&a.props.treeToo.idxOfInViewRootNode!==a.props.treeToo.idxOfFilteredRoot,c=d||e,b=0!==a.props.tree.idxOfInViewRootNode||0!==a.props.treeToo.idxOfInViewRootNode;return{treeButtonsDiv:{zIndex:100,position:"absolute",right:5,top:0},resetTreeButton:{zIndex:100,display:"inline-block",marginLeft:4,cursor:b?"pointer":"auto",color:b?F.I6:F.CA},zoomToSelectedButton:{zIndex:100,display:"inline-block",cursor:c?"pointer":"auto",color:c?F.I6:F.CA,pointerEvents:c?"auto":"none"},zoomOutButton:{zIndex:100,display:"inline-block",cursor:b?"pointer":"auto",color:b?F.I6:F.CA,pointerEvents:b?"auto":"none",marginRight:"4px"}}}),bQ(bO(a),"zoomToSelected",function(){a.props.dispatch((0,C.ss)({root:[a.props.tree.idxOfFilteredRoot,a.props.treeToo.idxOfFilteredRoot]}))}),bQ(bO(a),"zoomBack",function(){if(0!==a.props.tree.idxOfInViewRootNode){var b,c,d=a.props.tree.nodes[a.props.tree.idxOfInViewRootNode];b=(0,Q.s7)(d,a.props.distanceMeasure,a.props.tree.observedMutations).arrayIdx}if(0!==a.props.treeToo.idxOfInViewRootNode){var e=a.props.treeToo.nodes[a.props.treeToo.idxOfInViewRootNode];c=(0,Q.s7)(e,a.props.distanceMeasure,a.props.treeToo.observedMutations).arrayIdx}a.props.dispatch((0,C.ss)({root:[b,c]}))}),a.domRefs={mainTree:void 0,secondTree:void 0},a.tangleRef=void 0,a.state={hoveredNode:null,tree:null,treeToo:null},a.clearSelectedNode=bx.bind(bO(a)),a}return a=e,b=[{key:"setUpAndRenderTreeToo",value:function(b,a){a.treeToo=new aI(b.treeToo.nodes,"RIGHT",b.treeToo.idxOfInViewRootNode),j.PD&&bM(a.tree,a.treeToo),bz(this,!1,a.treeToo,b)}},{key:"componentDidMount",value:function(){if(document.addEventListener("keyup",this.handlekeydownEvent),this.props.tree.loaded){var a={};a.tree=new aI(this.props.tree.nodes,bW,this.props.tree.idxOfInViewRootNode),bz(this,!0,a.tree,this.props),this.props.showTreeToo&&this.setUpAndRenderTreeToo(this.props,a),a.geneSortFn=(0,$.MG)(this.props.genomeMap),this.setState(a)}}},{key:"componentDidUpdate",value:function(b){var c,a={},d=!1,e=bU(bq(!0,this.state.tree,b,this.props),2),f=e[0],g=e[1];f&&(a=f),b.showTreeToo!==this.props.showTreeToo?this.props.showTreeToo?(this.state.treeToo&&this.state.treeToo.clearSVG(),a.tree=this.state.tree,this.setUpAndRenderTreeToo(this.props,a),this.tangleRef&&this.tangleRef.drawLines()):a.treeToo=null:this.state.treeToo&&((c=bU(bq(!1,this.state.treeToo,b,this.props),2))[0],d=c[1]),this.tangleRef&&(g||d)&&this.tangleRef.drawLines(),Object.keys(a).length&&this.setState(a)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.handlekeydownEvent)}},{key:"renderTreeDiv",value:function(a){var b=a.width,d=a.height,e=a.mainTree,f=this;return(0,c.jsx)("svg",{id:e?"MainTree":"SecondTree",style:{pointerEvents:"auto",cursor:"default",userSelect:"none"},width:b,height:d,ref:function(a){e?f.domRefs.mainTree=a:f.domRefs.secondTree=a}})}},{key:"render",value:function(){var d,f=this,a=this.props.t,b=this.getStyles(),e=this.props.showTreeToo?(this.props.width-100)/2:this.props.width;return(0,c.jsxs)(D.Z,{center:!0,infocard:this.props.showOnlyPanels,title:a("Phylogeny"),children:[(0,c.jsx)(bJ,{children:(0,c.jsx)(O,{width:this.props.width})}),(0,c.jsx)(bd,{selectedNode:this.state.hoveredNode,colorBy:this.props.colorBy,colorByConfidence:this.props.colorByConfidence,colorScale:this.props.colorScale,colorings:this.props.colorings,geneSortFn:this.state.geneSortFn,observedMutations:this.props.tree.observedMutations,panelDims:{width:this.props.width,height:this.props.height,spaceBetweenTrees:100},tipLabelKey:this.props.tipLabelKey,t:a}),(0,c.jsx)(bp,{clearSelectedNode:this.clearSelectedNode,selectedNode:this.props.selectedNode,nodesLhsTree:this.props.tree.nodes,nodesRhsTree:null===(d=this.props.treeToo)|| void 0===d?void 0:d.nodes,observedMutations:this.props.tree.observedMutations,colorings:this.props.colorings,geneSortFn:this.state.geneSortFn,tipLabelKey:this.props.tipLabelKey,t:a}),this.props.showTangle&&this.state.tree&&this.state.treeToo?(0,c.jsx)(bF,{ref:function(a){f.tangleRef=a},width:this.props.width,height:this.props.height,lookup:this.props.treeToo.tangleTipLookup,leftNodes:this.props.tree.nodes,rightNodes:this.props.treeToo.nodes,colors:this.props.tree.nodeColors,cVersion:this.props.tree.nodeColorsVersion,vVersion:this.props.tree.visibilityVersion,metric:this.props.distanceMeasure,spaceBetweenTrees:100,leftTreeName:this.props.tree.name,rightTreeName:this.props.showTreeToo}):null,this.renderTreeDiv({width:e,height:this.props.height,mainTree:!0}),this.props.showTreeToo?(0,c.jsx)("div",{id:"treeSpacer",style:{width:100}}):null,this.props.showTreeToo?this.renderTreeDiv({width:e,height:this.props.height,mainTree:!1}):null,this.props.narrativeMode?null:(0,c.jsxs)("div",{style:bS({},b.treeButtonsDiv),children:[(0,c.jsx)("button",{style:bS({},F.PJ,b.zoomOutButton),onClick:this.zoomBack,children:(0,c.jsx)(B.oN5,{})}),(0,c.jsx)("button",{style:bS({},F.PJ,b.zoomToSelectedButton),onClick:this.zoomToSelected,children:a("Zoom to Selected")}),(0,c.jsx)("button",{style:bS({},F.PJ,b.resetTreeButton),onClick:this.redrawTree,children:a("Reset Layout")})]})]})}}],bP(a.prototype,b),d&&bP(a,d),e}(f.Component),z=(0,i.Zh)()(y),bX=(0,g.$j)(function(a){return{tree:a.tree,treeToo:a.treeToo,selectedNode:a.controls.selectedNode,dateMinNumeric:a.controls.dateMinNumeric,dateMaxNumeric:a.controls.dateMaxNumeric,filters:a.controls.filters,quickdraw:a.controls.quickdraw,colorBy:a.controls.colorBy,colorByConfidence:a.controls.colorByConfidence,layout:a.controls.layout,scatterVariables:a.controls.scatterVariables,temporalConfidence:a.controls.temporalConfidence,distanceMeasure:a.controls.distanceMeasure,explodeAttr:a.controls.explodeAttr,focus:a.controls.focus,colorScale:a.controls.colorScale,colorings:a.metadata.colorings,genomeMap:a.entropy.genomeMap,showTreeToo:a.controls.showTreeToo,showTangle:a.controls.showTangle,panelsToDisplay:a.controls.panelsToDisplay,selectedBranchLabel:a.controls.selectedBranchLabel,canRenderBranchLabels:a.controls.canRenderBranchLabels,showAllBranchLabels:a.controls.showAllBranchLabels,tipLabelKey:a.controls.tipLabelKey,narrativeMode:a.narrative.display,animationPlayPauseButton:a.controls.animationPlayPauseButton,showOnlyPanels:a.controls.showOnlyPanels}})(z)},17587:function(f,d,c){"use strict";c.d(d,{CA:function(){return h},Cc:function(){return g},H2:function(){return i},I6:function(){return b},PJ:function(){return j},cq:function(){return m},fp:function(){return l},fu:function(){return n},kU:function(){return a},ug:function(){return k}});var e=c(69856),g="Lato, Helvetica Neue, Helvetica, sans-serif",a="Lato, Helvetica Neue, Helvetica, sans-serif",b="#333",h="#BBB",i={backgroundColor:"#FFF",fontFamily:a,width:e.HB-13,borderSpacing:0,fontSize:14,paddingLeft:"10px",border:"1px solid #ccc",height:36,appearance:"none",borderRadius:"4px",color:b,fontWeight:400,marginBottom:"3px"},j={borderTop:"1px solid #BBB",borderLeft:"1px solid #CCC",borderRight:"1px solid #CCC",borderBottom:"1px solid #CCC",borderRadius:"0px 0px 3px 3px",paddingTop:3,paddingBottom:3,paddingLeft:6,paddingRight:6,backgroundColor:"#fff",fontWeight:400,color:b,fontFamily:a,fontSize:12,textTransform:"uppercase"},k={borderTop:"1px solid #BBB",borderLeft:"1px solid #CCC",borderRight:"1px solid #CCC",borderBottom:"1px solid #CCC",borderRadius:"0px 0px 3px 3px",paddingTop:3,paddingBottom:3,paddingLeft:6,paddingRight:6,backgroundColor:"#fff"},l={border:"none",backgroundColor:"inherit",padding:0,margin:0,cursor:"pointer",fontFamily:a,color:b,fontWeight:400,textTransform:"uppercase",fontSize:12},m={border:"none",backgroundColor:"inherit",padding:0,margin:0,cursor:"pointer",fontFamily:a,color:"#5097BA",fontWeight:400,textTransform:"uppercase",fontSize:12},n={branchInfoHeading:{fontSize:15,fontWeight:400,verticalAlign:"middle",padding:"5px"},buttonLink:{float:"right",fontFamily:a,fontSize:14,fontWeight:400,textDecoration:"none",pointerEvents:"auto",background:"none",color:"white",cursor:"pointer",textTransform:"uppercase",borderRadius:2,border:"1px solid #CCC",verticalAlign:"middle"},tooltip:{position:"relative",padding:5,color:"white",fontFamily:a,fontSize:14,lineHeight:1,fontWeight:300},modalContainer:{position:"absolute",width:"100%",height:"100%",pointerEvents:"all",top:0,left:0,zIndex:2e3,backgroundColor:"rgba(80, 80, 80, .20)",display:"flex",justifyContent:"center",alignItems:"center",wordWrap:"break-word",wordBreak:"break-word"},panel:{position:"relative",paddingLeft:30,padding:"5% 5%",borderRadius:5,backgroundColor:"rgba(55,55,55,0.9)",color:"white",fontFamily:a,fontSize:18,lineHeight:1,fontWeight:300,maxWidth:"80%",overflowY:"auto"},modalHeading:{fontSize:24,fontWeight:400},modalSubheading:{fontSize:20,fontWeight:400,marginTop:"20px",marginBottom:"20px"},tooltipHeading:{fontSize:18,fontWeight:400,marginBottom:"10px"},comment:{fontStyle:"italic",fontWeight:200,fontSize:14,marginTop:"10px"},topRightMessage:{fontStyle:"italic",fontWeight:200,fontSize:14,textAlign:"right",marginTop:"-20px"},list:{paddingLeft:15,listStyleType:"disc"},item:{paddingTop:4,paddingBottom:4,minWidth:130,verticalAlign:"top"},break:{marginBottom:"10px"}}},15361:function(g,d,a){"use strict";a.d(d,{fs:function(){return l}});var e,h,i,f=a(72607),b=a.n(f),j=a(71614);function k(c,d,e,f,g,h,i){try{var a=c[h](i),b=a.value}catch(j){e(j);return}a.done?d(b):Promise.resolve(b).then(f,g)}function c(a){return function(){var b=this,c=arguments;return new Promise(function(e,f){var g=a.apply(b,c);function d(a){k(g,e,f,d,h,"next",a)}function h(a){k(g,e,f,d,h,"throw",a)}d(void 0)})}}c(b().mark(function c(){return b().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if((0,j.y)("googleAnalyticsKey")){b.next=2;break}return b.abrupt("return");case 2:return i=a.e(495).then(a.bind(a,61495)),b.next=5,i;case 5:h=b.sent.default,b.next=9;break;case 9:h.initialize((0,j.R)("googleAnalyticsKey"));case 10:case"end":return b.stop()}},c)})),c(b().mark(function a(){return b().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!i){a.next=5;break}return a.next=3,i;case 3:a.next=6;break;case 5:return a.abrupt("return");case 6:h.set({page:window.location.pathname}),h.pageview(window.location.pathname);case 8:case"end":return a.stop()}},a)}));var l=(e=c(b().mark(function a(c){return b().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!i){a.next=5;break}return a.next=3,i;case 3:a.next=6;break;case 5:return a.abrupt("return");case 6:h.event({category:"Controls",action:c});case 7:case"end":return a.stop()}},a)})),function(a){return e.apply(this,arguments)})},62905:function(k,f,b){"use strict";var g=b(60822),l=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},m=function(){function a(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),n=Object.assign||function(d){for(var a=1;a<arguments.length;a++){var b=arguments[a];for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d[c]=b[c])}return d},o=function(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(b,a):b.__proto__=a)},p=function(b,a){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&("object"==typeof a||"function"==typeof a)?a:b},q=function(a,b){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a))return function(h,d){var a=[],b=!0,e=!1,f=void 0;try{for(var g,c=h[Symbol.iterator]();!(b=(g=c.next()).done)&&(a.push(g.value),!d||a.length!==d);b=!0);}catch(i){e=!0,f=i}finally{try{!b&&c.return&&c.return()}finally{if(e)throw f}}return a}(a,b);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=void 0;a="undefined"!=typeof window?window:"undefined"!=typeof self?self:b.g;var c=null,d=null,h=a.clearTimeout,r=a.setTimeout,i=a.cancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelAnimationFrame,j=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame;null==i||null==j?(c=h,d=function(a){return r(a,20)}):(c=function(b){var a=q(b,2),c=a[0],d=a[1];i(c),h(d)},d=function(c){var a=j(function(){h(b),c()}),b=r(function(){i(a),c()},20);return[a,b]});var e=function(e){function b(){l(this,b);for(var d,e,a,f,g=arguments.length,h=Array(g),c=0;c<g;c++)h[c]=arguments[c];return f=(e=a=p(this,(d=b.__proto__||Object.getPrototypeOf(b)).call.apply(d,[this].concat(h))),a.state={height:a.props.defaultHeight||0,width:a.props.defaultWidth||0},a._onResize=function(){var c=a.props,j=c.disableHeight,k=c.disableWidth,l=c.onResize;if(a._parentNode){var d=a._parentNode.offsetHeight||0,e=a._parentNode.offsetWidth||0,b=window.getComputedStyle(a._parentNode)||{},f=parseInt(b.paddingLeft,10)||0,g=parseInt(b.paddingRight,10)||0,h=parseInt(b.paddingTop,10)||0,i=parseInt(b.paddingBottom,10)||0,m=d-h-i,n=e-f-g;(j||a.state.height===m)&&(k||a.state.width===n)||(a.setState({height:d-h-i,width:e-f-g}),l({height:d,width:e}))}},a._setRef=function(b){a._autoSizer=b},e),p(a,f)}return o(b,e),m(b,[{key:"componentDidMount",value:function(){var b=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._detectElementResize=function(r){var k=void 0,h=void 0,i=void 0,l=void 0,m=void 0,n=void 0,o=void 0,p="undefined"!=typeof document&&document.attachEvent;if(!p){n=function(e){var c=e.__resizeTriggers__,a=c.firstElementChild,b=c.lastElementChild,d=a.firstElementChild;b.scrollLeft=b.scrollWidth,b.scrollTop=b.scrollHeight,d.style.width=a.offsetWidth+1+"px",d.style.height=a.offsetHeight+1+"px",a.scrollLeft=a.scrollWidth,a.scrollTop=a.scrollHeight},m=function(a){return a.offsetWidth!==a.__resizeLast__.width||a.offsetHeight!==a.__resizeLast__.height},o=function(a){if(!(a.target.className&&"function"==typeof a.target.className.indexOf&&0>a.target.className.indexOf("contract-trigger")&&0>a.target.className.indexOf("expand-trigger"))){var b=this;n(this),this.__resizeRAF__&&c(this.__resizeRAF__),this.__resizeRAF__=d(function(){m(b)&&(b.__resizeLast__.width=b.offsetWidth,b.__resizeLast__.height=b.offsetHeight,b.__resizeListeners__.forEach(function(c){c.call(b,a)}))})}};var e=!1,f="";i="animationstart";var g="Webkit Moz O ms".split(" "),q="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),j=document.createElement("fakeelement");if(void 0!==j.style.animationName&&(e=!0),!1===e){for(var b=0;b<g.length;b++)if(void 0!==j.style[g[b]+"AnimationName"]){f="-"+(0,g[b]).toLowerCase()+"-",i=q[b],e=!0;break}}k="@"+f+"keyframes "+(h="resizeanim")+" { from { opacity: 0; } to { opacity: 0; } } ",l=f+"animation: 1ms "+h+"; "}var s=function(b){if(!b.getElementById("detectElementResize")){var c=(k||"")+".resize-triggers { "+(l||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',d=b.head||b.getElementsByTagName("head")[0],a=b.createElement("style");a.id="detectElementResize",a.type="text/css",null!=r&&a.setAttribute("nonce",r),a.styleSheet?a.styleSheet.cssText=c:a.appendChild(b.createTextNode(c)),d.appendChild(a)}};return{addResizeListener:function(b,e){if(p)b.attachEvent("onresize",e);else{if(!b.__resizeTriggers__){var c=b.ownerDocument,f=a.getComputedStyle(b);f&&"static"===f.position&&(b.style.position="relative"),s(c),b.__resizeLast__={},b.__resizeListeners__=[],(b.__resizeTriggers__=c.createElement("div")).className="resize-triggers";var d=c.createElement("div");d.className="expand-trigger",d.appendChild(c.createElement("div"));var g=c.createElement("div");g.className="contract-trigger",b.__resizeTriggers__.appendChild(d),b.__resizeTriggers__.appendChild(g),b.appendChild(b.__resizeTriggers__),n(b),b.addEventListener("scroll",o,!0),i&&(b.__resizeTriggers__.__animationListener__=function(a){a.animationName===h&&n(b)},b.__resizeTriggers__.addEventListener(i,b.__resizeTriggers__.__animationListener__))}b.__resizeListeners__.push(e)}},removeResizeListener:function(a,b){if(p)a.detachEvent("onresize",b);else if(a.__resizeListeners__.splice(a.__resizeListeners__.indexOf(b),1),!a.__resizeListeners__.length){a.removeEventListener("scroll",o,!0),a.__resizeTriggers__.__animationListener__&&(a.__resizeTriggers__.removeEventListener(i,a.__resizeTriggers__.__animationListener__),a.__resizeTriggers__.__animationListener__=null);try{a.__resizeTriggers__=!a.removeChild(a.__resizeTriggers__)}catch(c){}}}}}(b),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var a=this.props,i=a.children,j=a.className,k=a.disableHeight,l=a.disableWidth,m=a.style,e=this.state,f=e.height,h=e.width,b={overflow:"visible"},c={},d=!1;return k||(0===f&&(d=!0),b.height=0,c.height=f),l||(0===h&&(d=!0),b.width=0,c.width=h),(0,g.createElement)("div",{className:j,ref:this._setRef,style:n({},b,m)},!d&&i(c))}}]),b}(g.PureComponent);e.defaultProps={onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}},f.Z=e},94037:function(){}}])
//# sourceMappingURL=412.e4f4da49282e3c98.js.map